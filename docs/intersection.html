

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>madrona.intersection: The Intersection App &mdash; Madrona Decision Support Tool v3.0dev documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '3.0dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Madrona Decision Support Tool v3.0dev documentation" href="index.html" />
    <link rel="up" title="Core Apps" href="apps.html" />
    <link rel="next" title="madrona.pg_spacing" href="pg_spacing.html" />
    <link rel="prev" title="madrona.heatmap" href="heatmap.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="pg_spacing.html" title="madrona.pg_spacing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="heatmap.html" title="madrona.heatmap"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Madrona Decision Support Tool v3.0dev documentation</a> &raquo;</li>
          <li><a href="apps.html" accesskey="U">Core Apps</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="madrona-intersection-the-intersection-app">
<span id="intersection"></span><h1><cite>madrona.intersection</cite>: The Intersection App<a class="headerlink" href="#madrona-intersection-the-intersection-app" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The basis of habitat reporting in Madrona is knowing how much habitat is captured within each MPA. Habitats can be represented as points, lines, or polygons. These habitat features generally come to us as shapefiles with wildly varying schemas. The intersection app assists in the process of resolving these various schemas into single feature shapefiles.</p>
<p>Once the habitat features are in simple single feature shapefiles, the intersection app lets you import them in into the database as intersection features. The features are then available to do intersections with. However, the more common use case will be to define an organization scheme first. Organization schemes let you define the order in which feature results are reported and let you combine existing features of the same type (two or more polygon features, for instance) into a single result.</p>
<p>Once the feature data is loaded into the intersection application and the organization scheme is defined, intersection results may be obtained either by directly calling a method of the OrganizationScheme object in the intersection app with a polygon or geometry collection as an argument or through an http request that includes a polygon in the URL.</p>
</div>
<div class="section" id="using-the-intersection-app">
<h2>Using the Intersection App<a class="headerlink" href="#using-the-intersection-app" title="Permalink to this headline">¶</a></h2>
<div class="section" id="getting-intersection-features-into-the-intersection-app">
<h3>Getting Intersection Features into the Intersection App<a class="headerlink" href="#getting-intersection-features-into-the-intersection-app" title="Permalink to this headline">¶</a></h3>
<p>In order to find out how much of a particular feature intersects with a given polygon, we first have to get the intersection feature into the database. Having each intersection feature represent a single habitat (as opposed to representing different habitats specified by an attribute) provides the greatest flexibility and constancy. The primary format for habitat data (in our experience so far) are shapefiles. The schemes of these shapefile data sources vary considerably.</p>
</div>
<div class="section" id="the-difference-between-multi-feature-and-single-feature-shapefiles">
<h3>The Difference Between Multi Feature and Single Feature Shapefiles<a class="headerlink" href="#the-difference-between-multi-feature-and-single-feature-shapefiles" title="Permalink to this headline">¶</a></h3>
<p>Sometimes, as is the case with the MLPA linear kelp data sets, the presence of geometry indicates the presence of the habitat. We&#8217;ll refer to this type of shapefile as a Single Feature Shapefile.</p>
<p>In other cases, a shapefile may contain geometries that represent any number of different habitats according to how each individual geometry is attributed. An example of one of these Multi Feature Shapefiles is available <a class="reference external" href="http://code.google.com/p/madrona/source/browse/trunk/madrona/intersection/test_data/test_substrate.zip">here</a>. That example is a portion of the substrate data set used in the South Coast MLPA process. The shapefile consists of polygons with a sub_depth attribute (among others). Some values of this attribute are &#8216;Hard 0 - 30m&#8217;, &#8216;Soft 30 - 50m&#8217;, etc. If we want to know, for instance, how much hard substrate with a depth of 0 - 30 meters is within a given polygon, we want to intersect that polygon with a set of geometries that represent just that habitat type. In other words, we want to intersect with a single feature rather than a multi feature.</p>
</div>
<div class="section" id="turning-a-multi-feature-shapefile-into-single-feature-shapefiles">
<h3>Turning a Multi Feature Shapefile into Single Feature Shapefiles<a class="headerlink" href="#turning-a-multi-feature-shapefile-into-single-feature-shapefiles" title="Permalink to this headline">¶</a></h3>
<p>The intersection app admin can take a zipped multi feature shapefile that has been uploaded and split it into the necessary number of zipped single feature shapefiles. Once the intersection app is installed and running, you may want to follow these steps in order to acquaint yourself with the app:</p>
<ol class="arabic simple">
<li>Download the sample substrate shapefile to your computer.</li>
<li>Log in to the django admin tool for the intersection app.</li>
<li>Click on &#8216;Multi feature shapefiles&#8217; in the intersection admin.</li>
<li>Click the &#8216;Add multi feature shapefile&#8217; button on the top right.</li>
<li>Type &#8216;Substrate&#8217; into the name field.</li>
<li>Click &#8216;Choose File&#8217; and select the sample shapefile (make sure you chose the zipped file) that you downloaded in step 1.</li>
<li>Click the Save button on the bottom right. You will be taken back to the &#8216;Multi feature shapefiles&#8217; list.</li>
<li>Click on the multi feature shapefile you just created (it should be called &#8216;Substrate&#8217;).</li>
<li>Click on the &#8216;Split to Single Feature Shapefiles&#8217; button on the top right.</li>
<li>Chose the shapefile field you want to use to split the multi feature shapefile into single feature shapefiles.</li>
</ol>
<p>When you click the submit button, you will be taken to the list of single feature shapefiles and you will see that one single feature shapefile has been created for each distinct value in the field that you split on.</p>
</div>
<div class="section" id="importing-features-from-single-feature-shapefiles">
<h3>Importing Features from Single Feature Shapefiles<a class="headerlink" href="#importing-features-from-single-feature-shapefiles" title="Permalink to this headline">¶</a></h3>
<p>Once we have a single feature shapefile, whether it was started life as a single feature shapefile and was imported as such or it started as a multi feature shapefile and was split by the admin tool, we can add it to the Intersection Features model and make it available for intersections. The following assumes that you&#8217;ve followed the steps above:</p>
<ol class="arabic simple">
<li>Click on &#8220;Single feature shapefiles&#8221; in the intersection admin.</li>
<li>Select all the substrate shapefiles that were created when you split the multi feature shapefile.</li>
<li>Select &#8220;Load the selected shapefiles to intersection features&#8221; from the &#8220;Action&#8221; drop down near the top of the page and click &#8220;Go&#8221;.</li>
</ol>
<p>This will take you to the list of Intersection Features and you&#8217;ll see that each of those single feature shapefiles have been imported into the database.</p>
</div>
<div class="section" id="running-test-intersections-within-the-intersection-app">
<h3>Running Test Intersections Within the Intersection App<a class="headerlink" href="#running-test-intersections-within-the-intersection-app" title="Permalink to this headline">¶</a></h3>
<p>You may want to play around with the intersection app independently of the other apps in your project. You can do that in a couple of different ways. You can draw polygons and get results for the intersection features you have loaded into the application. You can also create test polygons in the admin tool, save them, and get intersection results on them repeatedly. This helps in evaluating how results are cached.</p>
</div>
<div class="section" id="drawing-a-polygon-and-getting-intersection-results">
<h3>Drawing a Polygon and Getting Intersection Results<a class="headerlink" href="#drawing-a-polygon-and-getting-intersection-results" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Go to <a class="reference external" href="http://YOUR-HOST/intersection/intersect/testdrawing/">http://YOUR-HOST/intersection/intersect/testdrawing/</a></li>
<li>Draw a polygon over some portion of the intersection features you&#8217;ve loaded (if you&#8217;ve been following along, that&#8217;ll be a small portion of the coast just off shore of Point Conception).</li>
<li>Choose the organization scheme and format for your results.</li>
<li>Click the &#8220;Submit&#8221; button.</li>
</ol>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><cite>madrona.intersection</cite>: The Intersection App</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#using-the-intersection-app">Using the Intersection App</a><ul>
<li><a class="reference internal" href="#getting-intersection-features-into-the-intersection-app">Getting Intersection Features into the Intersection App</a></li>
<li><a class="reference internal" href="#the-difference-between-multi-feature-and-single-feature-shapefiles">The Difference Between Multi Feature and Single Feature Shapefiles</a></li>
<li><a class="reference internal" href="#turning-a-multi-feature-shapefile-into-single-feature-shapefiles">Turning a Multi Feature Shapefile into Single Feature Shapefiles</a></li>
<li><a class="reference internal" href="#importing-features-from-single-feature-shapefiles">Importing Features from Single Feature Shapefiles</a></li>
<li><a class="reference internal" href="#running-test-intersections-within-the-intersection-app">Running Test Intersections Within the Intersection App</a></li>
<li><a class="reference internal" href="#drawing-a-polygon-and-getting-intersection-results">Drawing a Polygon and Getting Intersection Results</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="heatmap.html"
                        title="previous chapter"><cite>madrona.heatmap</cite></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pg_spacing.html"
                        title="next chapter"><cite>madrona.pg_spacing</cite></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/intersection.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="pg_spacing.html" title="madrona.pg_spacing"
             >next</a> |</li>
        <li class="right" >
          <a href="heatmap.html" title="madrona.heatmap"
             >previous</a> |</li>
        <li><a href="index.html">Madrona Decision Support Tool v3.0dev documentation</a> &raquo;</li>
          <li><a href="apps.html" >Core Apps</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, MarineMap Consortium, Ecotrust.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>