
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Creating a Madrona project from scratch &mdash; Madrona Decision Support Framework v4.0b1 documentation</title>
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '4.0b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Madrona Decision Support Framework v4.0b1 documentation" href="index.html" />
    <link rel="up" title="Tutorials" href="tutorial.html" />
    <link rel="next" title="madrona.features - Spatial Content Management of Features" href="features.html" />
    <link rel="prev" title="Template Customization" href="template_customization.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="features.html" title="madrona.features - Spatial Content Management of Features"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="template_customization.html" title="Template Customization"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Madrona Decision Support Framework v4.0b1 documentation</a> &raquo;</li>
          <li><a href="tutorial.html" accesskey="U">Tutorials</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="creating-a-madrona-project-from-scratch">
<span id="create-new-project"></span><h1>Creating a Madrona project from scratch<a class="headerlink" href="#creating-a-madrona-project-from-scratch" title="Permalink to this headline">¶</a></h1>
<p>These instructions will walk you through developing a basic implementation of
Madrona. This includes installing from the development repository, setting
up a sample app, testing that everything installed smoothly, then doing some
basic customization. By the end you&#8217;ll have an application that will perform
all the basic functions needed to start drawing MPAs on a map.</p>
<div class="section" id="project-structure">
<h2>Project Structure<a class="headerlink" href="#project-structure" title="Permalink to this headline">¶</a></h2>
<p>It is important to understand how a Madrona application is structured. There are essentially two codebases:</p>
<blockquote>
<div><ul class="simple">
<li>madrona - a python module providing a set of django apps that contain the core functionality common to all Madrona instances.</li>
<li>the project code - a django project which implements and extends the functionality provided by madrona (specific to the particular project&#8217;s needs).</li>
</ul>
</div></blockquote>
<p>By seperating the two codebases, we can more easily maintain multiple Madrona projects while continuing to improve the underlying core functionality.
If you are creating your own project from scratch, you will likely only need to work on the project-specific code; the madrona library can be installed
just like any other python module and you should&#8217;t need to mess with any madrona code.</p>
</div>
<div class="section" id="install-dependencies">
<h2>Install Dependencies<a class="headerlink" href="#install-dependencies" title="Permalink to this headline">¶</a></h2>
<p>You will need to install madrona&#8217;s dependencies and madrona itself. For detailed instructions, please follow the <a class="reference internal" href="installation.html#installation"><em>Installation</em></a> guide.</p>
</div>
<div class="section" id="create-new-django-project">
<h2>Create new django project<a class="headerlink" href="#create-new-django-project" title="Permalink to this headline">¶</a></h2>
<p>In this example, we&#8217;ll set up a new Madrona instance for the state of Oregon. We use django-admin.py to create a standard django project:</p>
<div class="highlight-python"><pre>cd /usr/local/src
mkdir oregon_project
cd oregon_project
django-admin.py startproject oregon
cd oregon</pre>
</div>
<p>You should see the following directory structure:</p>
<div class="highlight-python"><pre>oregon
|-- __init__.py
|-- manage.py
|-- settings.py
`-- urls.py</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Though madrona includes several example projects, you are encouraged to
create your Madrona instance as a seperate python package outside of the
madrona source tree. This will allow for clear seperation between the underlying
libraries (madrona) and your implementation (the &#8220;project&#8221;)</p>
</div>
<p>We now need to configure the settings and urls for our oregon project.</p>
</div>
<div class="section" id="settings">
<h2>Settings<a class="headerlink" href="#settings" title="Permalink to this headline">¶</a></h2>
<p>First, while we appreciate django-admin&#8217;s attempt at an initial settings.py file, it doesn&#8217;t really work for us in this case. Because madrona contains sensible default settings, we only need to worry about settings specific to this project.</p>
<p>Delete everything in settings <em>except</em> for the SECRET_KEY and add the following to the <tt class="docutils literal"><span class="pre">settings.py</span></tt> file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Django settings for oregon project.</span>
<span class="kn">from</span> <span class="nn">madrona.common.default_settings</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">&#39;--&#39;</span> <span class="c"># Keep the one generated by django admin!</span>

<span class="n">BASE_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
<span class="n">TIME_ZONE</span> <span class="o">=</span> <span class="s">&#39;America/Vancouver&#39;</span>
<span class="n">ROOT_URLCONF</span> <span class="o">=</span> <span class="s">&#39;oregon.urls&#39;</span>

<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.contrib.gis.db.backends.postgis&#39;</span><span class="p">,</span>
        <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;oregon&#39;</span><span class="p">,</span>
        <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&#39;postgres&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">INSTALLED_APPS</span> <span class="o">+=</span> <span class="p">(</span> <span class="s">&#39;omm&#39;</span><span class="p">,</span> <span class="p">)</span>

<span class="kn">from</span> <span class="nn">settings_local</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>Notice the final two lines; First we install an app called &#8216;omm&#8217; that will hold the project specific models, views and templates. We haven&#8217;t yet created that app yet (that&#8217;s the next step).</p>
<p>Secondly, we import a file called <tt class="docutils literal"><span class="pre">settings_local.py</span></tt> which we&#8217;ll also need to create. This can be any settings specific to your local machine (such as your Google Earth API Key, database connections, custom paths, log settings, etc). For now we can just create an empty file:</p>
<div class="highlight-python"><pre>touch settings_local.py</pre>
</div>
</div>
<div class="section" id="creating-features-and-featurecollections">
<h2>Creating Features and FeatureCollections<a class="headerlink" href="#creating-features-and-featurecollections" title="Permalink to this headline">¶</a></h2>
<p>Lingcod is designed without any hardcoded feature types (though we do provide plenty of examples!). <cite>Features</cite> are the entities that users can create, edit, share and analyze. Each type of feature can be customized with it&#8217;s own attributes, it&#8217;s own behavior and it&#8217;s own relationships with other features. <cite>FeatureCollections</cite> are a special type of Feature that allows you to organize Features into logical sets or even nested hierarchies; they are analagous to directories in your operating system except that you can define their behavior and their relationships with other features.</p>
<p>Let&#8217;s start with a simple example. Let&#8217;s say we want to develop a collaborative system for creating, sharing and analyzing Marine Protected Areas (MPAs). We also want to be able to put these MPAs into Folders to keep things organized.</p>
<p>First, let&#8217;s create the app to hold our custom features:</p>
<div class="highlight-python"><pre>python manage.py startapp omm</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Don&#8217;t use underscores _ in your app name; Underscores are used as a delimiter for certain internal naming conventions so using them in the app name will lead to errors.</p>
</div>
<p>Here we should see the following directory structure created for us:</p>
<div class="highlight-python"><pre>omm
|-- __init__.py
|-- models.py
|-- tests.py
`-- views.py</pre>
</div>
<p>We can ignore the tests and views for now; for now we&#8217;ll focus on creating the Mpa and Folder models. Open <tt class="docutils literal"><span class="pre">omm/models.py</span></tt> and add:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">madrona.features.models</span> <span class="kn">import</span> <span class="n">PolygonFeature</span><span class="p">,</span> <span class="n">FeatureCollection</span>
<span class="kn">from</span> <span class="nn">madrona.features</span> <span class="kn">import</span> <span class="n">register</span>

<span class="nd">@register</span>
<span class="k">class</span> <span class="nc">Mpa</span><span class="p">(</span><span class="n">PolygonFeature</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Options</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="s">&#39;oregon.omm.forms.MpaForm&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The python convention is to name your model classes using CapsCase. Just don&#8217;t use underscores _ in the feature class name.</p>
</div>
<p>Next create a file to hold the forms called <tt class="docutils literal"><span class="pre">forms.py</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">madrona.features.forms</span> <span class="kn">import</span> <span class="n">FeatureForm</span><span class="p">,</span> <span class="n">SpatialFeatureForm</span>
<span class="kn">from</span> <span class="nn">omm.models</span> <span class="kn">import</span> <span class="n">Mpa</span><span class="p">,</span> <span class="n">Folder</span>

<span class="k">class</span> <span class="nc">MpaForm</span><span class="p">(</span><span class="n">SpatialFeatureForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">SpatialFeatureForm</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Mpa</span>
</pre></div>
</div>
<p>The above is a barebones MPA feature inherited from the <tt class="docutils literal"><span class="pre">PolygonFeature</span></tt> base class. All the basic attributes are included by default. A form for creating and editing Mpas is also provided; again inheriting from a <tt class="docutils literal"><span class="pre">SpatialFeatureForm</span></tt> base class so the default behavior takes only a few lines of code. The only additional information required is the Options class with a form property specifying the full python path to the associated Form (mandatory). Finally the &#64;register decorator at the top of the class is required to register the Mpa feature class with madrona.</p>
<p>Similarly, we could group Mpas into collections; let&#8217;s call them &#8220;Folders&#8221; for now. We can inherit from the base <tt class="docutils literal"><span class="pre">FeatureCollection</span></tt> and specify the mandatory <tt class="docutils literal"><span class="pre">valid_children</span></tt> Option to configure which feature types can be placed in a folder.</p>
<p>So, adding to <tt class="docutils literal"><span class="pre">models.py</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@register</span>
<span class="k">class</span> <span class="nc">Folder</span><span class="p">(</span><span class="n">FeatureCollection</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Options</span><span class="p">:</span>
        <span class="n">form</span> <span class="o">=</span> <span class="s">&#39;oregon.omm.forms.FolderForm&#39;</span>
        <span class="n">valid_children</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s">&#39;oregon.omm.models.Mpa&#39;</span><span class="p">,</span>
            <span class="s">&#39;oregon.omm.models.Folder&#39;</span><span class="p">,</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>and adding to <tt class="docutils literal"><span class="pre">forms.py</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FolderForm</span><span class="p">(</span><span class="n">FeatureForm</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">(</span><span class="n">FeatureForm</span><span class="o">.</span><span class="n">Meta</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Folder</span>
</pre></div>
</div>
<p>This is all that is necessary to begin managing MPA features and organizing them into Folders. With a few lines of code, we&#8217;ve defined the features and aspects of our application&#8217;s behavior. One of our goals is to make the customization and configuration of madrona as easy as possible - and its almost entirely driven by the model configurations you see above. There are few other things you need to do in order to get a fully functional application.</p>
</div>
<div class="section" id="urls">
<h2>Urls<a class="headerlink" href="#urls" title="Permalink to this headline">¶</a></h2>
<p>In order for django to successfully route requests, we need to define URL patterns for the common madrona operations. Lingcod provides a set of default urls so in most cases you&#8217;ll just modify your urls.py to show the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls.defaults</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="c"># Include all madrona app urls. Any urls above will overwrite the common urls below</span>
    <span class="p">(</span><span class="s">r&#39;&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;madrona.common.urls&#39;</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="databases">
<h2>Databases<a class="headerlink" href="#databases" title="Permalink to this headline">¶</a></h2>
<p>Next we&#8217;ll create a new postgis-enabled database for this project and use django&#8217;s syncdb command to create the necessary tables. Assuming you installed postgis functions, etc into your postgres template1, this is as simple as:</p>
<div class="highlight-python"><pre>createdb oregon -U postgres</pre>
</div>
<p>It is recommended, though not required, to set up a <a class="reference internal" href="studyregion.html#studyregion"><em>study region</em></a>. At a minimum, you&#8217;ll need to decide on a spatial reference system to store your geographic data.  For the case of oregon, let&#8217;s say we have data in UTM Zone 10N, WGS84 datum which corresponds to the SRID 32610 (see <a class="reference external" href="http://www.spatialreference.org/ref/epsg/32610/">http://www.spatialreference.org/ref/epsg/32610/</a>). This is also the projection we want to use for storing our
shapes so we&#8217;ll add this to our <tt class="docutils literal"><span class="pre">settings.py</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">GEOMETRY_DB_SRID</span> <span class="o">=</span> <span class="mi">32610</span>
</pre></div>
</div>
<p>Finally, we&#8217;ll create the necessary tables in the database:</p>
<div class="highlight-python"><pre>python manage.py syncdb
python manage.py migrate</pre>
</div>
</div>
<div class="section" id="static-media">
<h2>Static Media<a class="headerlink" href="#static-media" title="Permalink to this headline">¶</a></h2>
<p>All static media is split between the project media and the madrona media.</p>
<p>The project media goes in a &#8216;media&#8217; directory at the same level as your project directory. So let&#8217;s create the media directory:</p>
<div class="highlight-python"><pre>cd oregon_project
mkdir media</pre>
</div>
<p>Project media and madrona media get combined into a single directory. Let&#8217;s create that directory now:</p>
<div class="highlight-python"><pre>cd /var/www/
mkdir oregon_media
cd /usr/local/src/oregon_project/oregon</pre>
</div>
<p>Point MEDIA_ROOT to this directory in our <tt class="docutils literal"><span class="pre">settings_local.py</span></tt> file:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">MEDIA_ROOT</span> <span class="o">=</span> <span class="s">&#39;/var/www/oregon_media&#39;</span>
</pre></div>
</div>
<p>The install_media command will then take all files from madrona media and oregon media directories and combine them into this directory. It is safe to assume that when you deploy madrona you&#8217;ll want this directory to be fully web accessible:</p>
<div class="highlight-python"><pre>python manage.py install_media</pre>
</div>
<p>This step also compresses all js and css using the django-compress app to ensure that your js and css are single compact files to maximize performance (when not running in DEBUG mode).</p>
</div>
<div class="section" id="deployment-for-testing">
<h2>Deployment for Testing<a class="headerlink" href="#deployment-for-testing" title="Permalink to this headline">¶</a></h2>
<p>For now, we&#8217;ll just test our new project using django&#8217;s built-in development server. First we need to set up the sites framework so that our domain is accurate
for any absolute urls created by our Madrona project. Then run the dev server to test it:</p>
<div class="highlight-python"><pre>python manage.py enable_sharing
python manage.py site localhost:8000
python manage.py runserver</pre>
</div>
<p>Our Oregon Madrona project should now be accessible at <a class="reference external" href="http://localhost:8000/">http://localhost:8000/</a> ...</p>
<img alt="_images/screen1.png" src="_images/screen1.png" />
<div class="section" id="setup-and-deployment">
<h3>Setup and Deployment<a class="headerlink" href="#setup-and-deployment" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="using-settings-py-and-settings-local-py">
<h2>Using settings.py and settings_local.py<a class="headerlink" href="#using-settings-py-and-settings-local-py" title="Permalink to this headline">¶</a></h2>
<p>Take a look at <tt class="docutils literal"><span class="pre">test_project/settings_local.template</span></tt> and
<tt class="docutils literal"><span class="pre">settings.py</span></tt>. Madrona uses a simple splitsetting scheme as described
<a class="reference external" href="http://code.djangoproject.com/wiki/SplitSettings#Multiplesettingfilesimportingfromeachother">here</a>. What this enables is the ability to specify standard settings in settings.py and commit them to a public repository.
You then create a settings_local.py file which contains your passwords and settings specific to your local machine.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">For security reasons, <tt class="docutils literal"><span class="pre">SECRET_KEY</span></tt>, <tt class="docutils literal"><span class="pre">DATABASES</span></tt>, passwords
and other sensistive local settings are kept private and never published.</p>
</div>
<p>Lets do that now. Copy settings_local.template to settings_local.py, then
replace the SECRET_KEY with your own randomly-generated key:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">&#39;SOME_RANDOMLY_GENERATED_GOBBLYGOOK_VERY_SECRET&#39;</span>
</pre></div>
</div>
<p>Add the following lines, altering as needed to allow connection to your local postgres database:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
   <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;django.contrib.gis.db.backends.postgis&#39;</span><span class="p">,</span>
       <span class="s">&#39;NAME&#39;</span><span class="p">:</span> <span class="s">&#39;example&#39;</span><span class="p">,</span>
       <span class="s">&#39;USER&#39;</span><span class="p">:</span> <span class="s">&#39;postgres&#39;</span><span class="p">,</span>
       <span class="s">&#39;HOST&#39;</span><span class="p">:</span> <span class="s">&#39;localhost&#39;</span><span class="p">,</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="handling-static-media">
<h2>Handling static media<a class="headerlink" href="#handling-static-media" title="Permalink to this headline">¶</a></h2>
<p>Because a Madrona instance is split between madrona (the core functionality) and the project-specific code, static media files such as html, javascript, css, images, etc. may exist in both.
Django expects all the static media to be in a single directory.
In order to merge the madrona media with the project media,
you need to create an empty <cite>mediaroot</cite> directory and set it as your MEDIA_ROOT in the project settings_local.py</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mkdir</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">test_media</span>
</pre></div>
</div>
<p>Now add the following to you <tt class="docutils literal"><span class="pre">settings_local.py</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">MEDIA_ROOT</span> <span class="o">=</span> <span class="s">&#39;/path/to/test_media&#39;</span>
</pre></div>
</div>
<p>Then use the &#8216;install_media&#8217; management command to merge all the media files into the MEDIA_ROOT directory.:</p>
<div class="highlight-python"><pre>python manage.py install_media</pre>
</div>
<p>To setup the database schema and populate with some initial data, run the
django syncdb command from within the <tt class="docutils literal"><span class="pre">test_project</span></tt> directory:</p>
<div class="highlight-python"><pre>python manage.py syncdb</pre>
</div>
<p>Use the migrate command to handle creating the schemas and populating the database
for those applications which are under <a class="reference external" href="http://south.aeracode.org/docs/about.html">migration control</a>:</p>
<div class="highlight-python"><pre>python manage.py migrate</pre>
</div>
<p>Enable sharing globally for the site:</p>
<div class="highlight-python"><pre>python manage.py enable_sharing</pre>
</div>
<p>Set up the site to run under a particular domain, in this case just on localhost port 8000:</p>
<div class="highlight-python"><pre>python manage.py site localhost:8000</pre>
</div>
</div>
<div class="section" id="test-and-run-the-development-server">
<h2>Test and run the development server<a class="headerlink" href="#test-and-run-the-development-server" title="Permalink to this headline">¶</a></h2>
<p>Confirm that everything is working as expected by running the tests:</p>
<div class="highlight-python"><pre>python utils/run_tests.py</pre>
</div>
<p>If everything looks good, turn on the dev server:</p>
<div class="highlight-python"><pre>python manage.py runserver</pre>
</div>
<p>Go to <tt class="docutils literal"><span class="pre">http://localhost:8000/admin/</span></tt> in a browser and use the authentication
credentials specified when syncdb was run.
At <tt class="docutils literal"><span class="pre">http://localhost:8000/</span></tt> the interface should render with sample data.</p>
<div class="section" id="next-steps">
<h3>Next steps<a class="headerlink" href="#next-steps" title="Permalink to this headline">¶</a></h3>
<p>Madrona has fixtures containing test data that is installed on database
setup like an example <a class="reference internal" href="studyregion.html#studyregion"><em>Study Region</em></a> and <a class="reference internal" href="layers.html#layers"><em>madrona.layers -   KML Data Layers</em></a>. This makes
it easy to verify the installation and learn how the tool works. For use in an
actual planning session these default datasets will need to be replaced.</p>
<p>While the above shows a minimal bare-bones project, it&#8217;s not a very interesting example. From here we might want to expand on the configuration of our features a bit, adding manipulators, attributes, verbose name, and custom links to the Options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@register</span>
<span class="k">class</span> <span class="nc">Mpa</span><span class="p">(</span><span class="n">PolygonFeature</span><span class="p">):</span>
    <span class="n">designation</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
    <span class="k">class</span> <span class="nc">Options</span><span class="p">:</span>
        <span class="n">verbose_name</span> <span class="o">=</span> <span class="s">&#39;Marine Protected Area&#39;</span>
        <span class="n">form</span> <span class="o">=</span> <span class="s">&#39;oregon.omm.models.MpaForm&#39;</span>
        <span class="n">manipulators</span> <span class="o">=</span> <span class="p">[</span> <span class="s">&#39;madrona.manipulators.manipulators.ClipToStudyRegion&#39;</span> <span class="p">]</span>
        <span class="n">optional_manipulators</span> <span class="o">=</span> <span class="p">[</span> <span class="s">&#39;madrona.manipulators.manipulators.ClipToGraticuleManipulator&#39;</span> <span class="p">]</span>
        <span class="n">links</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">related</span><span class="p">(</span><span class="s">&#39;Habitat Spreadsheet&#39;</span><span class="p">,</span>
                <span class="s">&#39;oregon.omm.views.habitat_spreadsheet&#39;</span><span class="p">,</span>
                <span class="n">select</span><span class="o">=</span><span class="s">&#39;single&#39;</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s">&#39;application/xls&#39;</span>
            <span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above <cite>Mpa</cite> feature has a custom link for a Habitat Spreadsheet; the oregon.omm.views.habitat_spreadsheet view would need to be written for this to function properly. For more info see documentation on Creating Link Views TODO.</p>
</div>
<p>See the documentation in the following sections to customize Madrona as
needed:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="features.html"><tt class="docutils literal"><span class="pre">madrona.features</span></tt> -  Spatial Content Management of <em>Features</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="studyregion.html"><tt class="docutils literal"><span class="pre">madrona.studyregion</span></tt> -  The Study Region</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="layers.html"><tt class="docutils literal"><span class="pre">madrona.layers</span></tt> -   KML Data Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_users.html">Managing Users in Madrona</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migrations for Database Schema Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="manipulators.html"><tt class="docutils literal"><span class="pre">madrona.manipulators</span></tt> -  Manipulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="staticmap.html"><tt class="docutils literal"><span class="pre">madrona.staticmap</span></tt> -  Static Map Data Layers</a></li>
<li class="toctree-l1"><a class="reference internal" href="sharing_configuration.html">Sharing Features and Collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="template_customization.html">Template Customization</a></li>
</ul>
</div>
<p>The setup this guide has walked through only specifies how to run the django
development server. To setup a public facing website using Apache, consult the
<a class="reference internal" href="deployment.html#deployment"><em>Deployment</em></a> notes.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Creating a Madrona project from scratch</a><ul>
<li><a class="reference internal" href="#project-structure">Project Structure</a></li>
<li><a class="reference internal" href="#install-dependencies">Install Dependencies</a></li>
<li><a class="reference internal" href="#create-new-django-project">Create new django project</a></li>
<li><a class="reference internal" href="#settings">Settings</a></li>
<li><a class="reference internal" href="#creating-features-and-featurecollections">Creating Features and FeatureCollections</a></li>
<li><a class="reference internal" href="#urls">Urls</a></li>
<li><a class="reference internal" href="#databases">Databases</a></li>
<li><a class="reference internal" href="#static-media">Static Media</a></li>
<li><a class="reference internal" href="#deployment-for-testing">Deployment for Testing</a><ul>
<li><a class="reference internal" href="#setup-and-deployment">Setup and Deployment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-settings-py-and-settings-local-py">Using settings.py and settings_local.py</a></li>
<li><a class="reference internal" href="#handling-static-media">Handling static media</a></li>
<li><a class="reference internal" href="#test-and-run-the-development-server">Test and run the development server</a><ul>
<li><a class="reference internal" href="#next-steps">Next steps</a><ul>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="template_customization.html"
                        title="previous chapter">Template Customization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="features.html"
                        title="next chapter"><tt class="docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">madrona.features</span></tt> -  Spatial Content Management of <em>Features</em></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial_scratch.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="features.html" title="madrona.features - Spatial Content Management of Features"
             >next</a> |</li>
        <li class="right" >
          <a href="template_customization.html" title="Template Customization"
             >previous</a> |</li>
        <li><a href="index.html">Madrona Decision Support Framework v4.0b1 documentation</a> &raquo;</li>
          <li><a href="tutorial.html" >Tutorials</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, MarineMap Consortium, Ecotrust.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>