<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">/*
<span class='line'>  2</span> 
<span class='line'>  3</span>   OpenLayers.js -- OpenLayers Map Viewer Library
<span class='line'>  4</span> 
<span class='line'>  5</span>   Copyright (c) 2006-2012 by OpenLayers Contributors
<span class='line'>  6</span>   Published under the 2-clause BSD license.
<span class='line'>  7</span>   See http://openlayers.org/dev/license.txt for the full text of the license, and http://openlayers.org/dev/authors.txt for full list of contributors.
<span class='line'>  8</span> 
<span class='line'>  9</span>   Includes compressed code under the following licenses:
<span class='line'> 10</span> 
<span class='line'> 11</span>   (For uncompressed versions of the code used, please see the
<span class='line'> 12</span>   OpenLayers Github repository: &lt;https://github.com/openlayers/openlayers>)
<span class='line'> 13</span> 
<span class='line'> 14</span> */</span><span class="WHIT">
<span class='line'> 15</span> 
<span class='line'> 16</span> </span><span class="COMM">/**
<span class='line'> 17</span>  * Contains XMLHttpRequest.js &lt;http://code.google.com/p/xmlhttprequest/>
<span class='line'> 18</span>  * Copyright 2007 Sergey Ilinsky (http://www.ilinsky.com)
<span class='line'> 19</span>  *
<span class='line'> 20</span>  * Licensed under the Apache License, Version 2.0 (the "License");
<span class='line'> 21</span>  * you may not use this file except in compliance with the License.
<span class='line'> 22</span>  * You may obtain a copy of the License at
<span class='line'> 23</span>  * http://www.apache.org/licenses/LICENSE-2.0
<span class='line'> 24</span>  */</span><span class="WHIT">
<span class='line'> 25</span> 
<span class='line'> 26</span> </span><span class="COMM">/**
<span class='line'> 27</span>  * OpenLayers.Util.pagePosition is based on Yahoo's getXY method, which is
<span class='line'> 28</span>  * Copyright (c) 2006, Yahoo! Inc.
<span class='line'> 29</span>  * All rights reserved.
<span class='line'> 30</span>  * 
<span class='line'> 31</span>  * Redistribution and use of this software in source and binary forms, with or
<span class='line'> 32</span>  * without modification, are permitted provided that the following conditions
<span class='line'> 33</span>  * are met:
<span class='line'> 34</span>  * 
<span class='line'> 35</span>  * * Redistributions of source code must retain the above copyright notice,
<span class='line'> 36</span>  *   this list of conditions and the following disclaimer.
<span class='line'> 37</span>  * 
<span class='line'> 38</span>  * * Redistributions in binary form must reproduce the above copyright notice,
<span class='line'> 39</span>  *   this list of conditions and the following disclaimer in the documentation
<span class='line'> 40</span>  *   and/or other materials provided with the distribution.
<span class='line'> 41</span>  * 
<span class='line'> 42</span>  * * Neither the name of Yahoo! Inc. nor the names of its contributors may be
<span class='line'> 43</span>  *   used to endorse or promote products derived from this software without
<span class='line'> 44</span>  *   specific prior written permission of Yahoo! Inc.
<span class='line'> 45</span>  * 
<span class='line'> 46</span>  * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
<span class='line'> 47</span>  * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
<span class='line'> 48</span>  * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
<span class='line'> 49</span>  * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
<span class='line'> 50</span>  * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
<span class='line'> 51</span>  * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
<span class='line'> 52</span>  * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
<span class='line'> 53</span>  * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
<span class='line'> 54</span>  * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
<span class='line'> 55</span>  * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
<span class='line'> 56</span>  * POSSIBILITY OF SUCH DAMAGE.
<span class='line'> 57</span>  */</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">OpenLayers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">VERSION_NUMBER</span><span class="PUNC">:</span><span class="STRN">"Release 2.12-rc5"</span><span class="PUNC">,</span><span class="NAME">singleFile</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_getScriptLocation</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="REGX">/(^|(.*?\/))(OpenLayers[^\/]*?\.js)(\?|$)/</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"script"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getAttribute</span><span class="PUNC">(</span><span class="STRN">"src"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.match</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ImgPath</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">arguments.length</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c.initialize</span><span class="PUNC">?</span><span class="NAME">c.initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.inherit.apply</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d.prototype</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="NAME">OpenLayers.inherit</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c.prototype</span><span class="PUNC">=</span><span class="NAME">b.prototype</span><span class="PUNC">;</span><span class="NAME">a.prototype</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.prototype</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a.prototype</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">window.Event</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">window.Event</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">&&</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">(</span><span class="STRN">"toString"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.toString</span><span class="PUNC">=</span><span class="NAME">b.toString</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.String</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">startsWith</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">contains</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">trim</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="REGX">/^\s\s*/</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\s\s*$/</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">camelize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">"-"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">e.charAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">e.substring</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="NAME">OpenLayers.String.tokenRegEx</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.split</span><span class="PUNC">(</span><span class="REGX">/\.+/</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">f.apply</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="STRN">"undefined"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">?</span><span class="STRN">"undefined"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tokenRegEx</span><span class="PUNC">:</span><span class="REGX">/\$\{([\w.]+?)\}/g</span><span class="PUNC">,</span><span class="NAME">numberRegEx</span><span class="PUNC">:</span><span class="REGX">/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/</span><span class="PUNC">,</span><span class="NAME">isNumeric</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.String.numberRegEx.test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">numericIf</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.replace</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="REGX">/^\s*|\s*$/g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.String.isNumeric</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="NAME">OpenLayers.Number</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">decimalSeparator</span><span class="PUNC">:</span><span class="STRN">"."</span><span class="PUNC">,</span><span class="NAME">thousandsSeparator</span><span class="PUNC">:</span><span class="STRN">","</span><span class="PUNC">,</span><span class="NAME">limitSigDigs</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.toPrecision</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"undefined"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"undefined"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Number.thousandsSeparator</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">"undefined"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Number.decimalSeparator</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.toFixed</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">"."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">e.length</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="REGX">/(-?[0-9]+)([0-9]{3})/</span><span class="PUNC">;</span><span class="NAME">f.test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"$1"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">"$2"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 62</span> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">e.length</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="STRN">"0"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c.length</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"0"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Function</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">bind</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.apply</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.concat</span><span class="PUNC">(</span><span class="NAME">Array.prototype.slice.apply</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.apply</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">bindAsEventListener</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.call</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">False</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">True</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Void</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 63</span> </span><span class="NAME">OpenLayers.Array</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">filter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Array.prototype.filter</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.filter</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.call</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">left</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">right</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">top</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">centerLonLat</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.bottom</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">,</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.left</span><span class="PUNC">==</span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">this.right</span><span class="PUNC">==</span><span class="NAME">a.right</span><span class="PUNC">&&</span><span class="NAME">this.top</span><span class="PUNC">==</span><span class="NAME">a.top</span><span class="PUNC">&&</span><span class="NAME">this.bottom</span><span class="PUNC">==</span><span class="NAME">a.bottom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">,</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="NAME">this.bottom</span><span class="PUNC">,</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">,</span><span class="NAME">this.right</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">,</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toBBOX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">this.bottom</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">this.right</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">this.top</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Polygon</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LinearRing</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getWidth</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.right</span><span class="PUNC">-</span><span class="NAME">this.left</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getHeight</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">this.bottom</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">this.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="NAME">getCenterPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">+</span><span class="NAME">this.right</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.bottom</span><span class="PUNC">+</span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCenterLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.centerLonLat</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.centerLonLat</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">+</span><span class="NAME">this.right</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.bottom</span><span class="PUNC">+</span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.centerLonLat</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">scale</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="STRN">"OpenLayers.LonLat"</span><span class="PUNC">==</span><span class="NAME">b.CLASS_NAME</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.lon</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.lat</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.bottom</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.right</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"Bounds.add cannot receive null values"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.right</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extend</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.LonLat"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Bounds"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.centerLonLat</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.left</span><span class="PUNC">||</span><span class="NAME">b.left</span><span class="PUNC">&lt;</span><span class="NAME">this.left</span><span class="PUNC">)</span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="NAME">b.left</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.bottom</span><span class="PUNC">||</span><span class="NAME">b.bottom</span><span class="PUNC">&lt;</span><span class="NAME">this.bottom</span><span class="PUNC">)</span><span class="NAME">this.bottom</span><span class="PUNC">=</span><span class="NAME">b.bottom</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.right</span><span class="PUNC">||</span><span class="NAME">b.right</span><span class="PUNC">></span><span class="NAME">this.right</span><span class="PUNC">)</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="NAME">b.right</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.top</span><span class="PUNC">||</span><span class="NAME">b.top</span><span class="PUNC">></span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">b.top</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"boolean"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">inclusive</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">b.inclusive</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.worldBounds</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">d.left</span><span class="PUNC">+</span><span class="NAME">d.right</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.containsLonLat</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">a.lon</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">a.lat</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">inclusive</span><span class="PUNC">:</span><span class="NAME">b.inclusive</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">contains</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">this.left</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">this.right</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">>=</span><span class="NAME">this.bottom</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">this.top</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">></span><span class="NAME">this.left</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.right</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">></span><span class="NAME">this.bottom</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.top</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersectsBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"boolean"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">inclusive</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.worldBounds</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">b.worldBounds</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">b.worldBounds</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b.inclusive</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.inclusive</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.left</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="NAME">a.right</span><span class="PUNC">||</span><span class="NAME">c.right</span><span class="PUNC">==</span><span class="NAME">a.left</span><span class="PUNC">||</span><span class="NAME">c.top</span><span class="PUNC">==</span><span class="NAME">a.bottom</span><span class="PUNC">||</span><span class="NAME">c.bottom</span><span class="PUNC">==</span><span class="NAME">a.top</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.inclusive</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.top</span><span class="PUNC">>=</span><span class="NAME">c.bottom</span><span class="PUNC">&&</span><span class="NAME">a.top</span><span class="PUNC">&lt;=</span><span class="NAME">c.top</span><span class="PUNC">||</span><span class="NAME">c.top</span><span class="PUNC">></span><span class="NAME">a.bottom</span><span class="PUNC">&&</span><span class="NAME">c.top</span><span class="PUNC">&lt;</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.left</span><span class="PUNC">>=</span><span class="NAME">c.left</span><span class="PUNC">&&</span><span class="NAME">a.left</span><span class="PUNC">&lt;=</span><span class="NAME">c.right</span><span class="PUNC">||</span><span class="NAME">c.left</span><span class="PUNC">>=</span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">c.left</span><span class="PUNC">&lt;=</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.right</span><span class="PUNC">>=</span><span class="NAME">c.left</span><span class="PUNC">&&</span><span class="NAME">a.right</span><span class="PUNC">&lt;=</span><span class="NAME">c.right</span><span class="PUNC">||</span><span class="NAME">c.right</span><span class="PUNC">>=</span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">c.right</span><span class="PUNC">&lt;=</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">>=</span><span class="NAME">c.bottom</span><span class="PUNC">&&</span><span class="NAME">a.bottom</span><span class="PUNC">&lt;=</span><span class="NAME">c.top</span><span class="PUNC">||</span><span class="NAME">c.bottom</span><span class="PUNC">>=</span><span class="NAME">a.bottom</span><span class="PUNC">&&</span><span class="NAME">c.bottom</span><span class="PUNC">&lt;=</span><span class="NAME">a.top</span><span class="PUNC">||</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.worldBounds</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.worldBounds</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">g.containsBounds</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">g.containsBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">g</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="PUNC">{</span><span class="NAME">inclusive</span><span class="PUNC">:</span><span class="NAME">b.inclusive</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.add</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">inclusive</span><span class="PUNC">:</span><span class="NAME">b.inclusive</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.contains</span><span class="PUNC">(</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">determineQuadrant</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.lat</span><span class="PUNC">&lt;</span><span class="NAME">c.lat</span><span class="PUNC">?</span><span class="STRN">"b"</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.lon</span><span class="PUNC">&lt;</span><span class="NAME">c.lon</span><span class="PUNC">?</span><span class="STRN">"l"</span><span class="PUNC">:</span><span class="STRN">"r"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transform</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.centerLonLat</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.bottom</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.bottom</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.top</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.top</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">e.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bottom</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">d.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">d.x</span><span class="PUNC">,</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wrapDateLine</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.leftTolerance</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.rightTolerance</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.left</span><span class="PUNC">&lt;</span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">e.right</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">&lt;=</span><span class="NAME">a.left</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">e.left</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">>=</span><span class="NAME">a.right</span><span class="PUNC">&&</span><span class="NAME">e.right</span><span class="PUNC">></span><span class="NAME">a.right</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.add</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.left</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.right</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">e.right</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">></span><span class="NAME">a.right</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.add</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Bounds"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Bounds.fromString</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds.fromArray</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Bounds.fromArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="NAME">OpenLayers.Bounds.fromSize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.h</span><span class="PUNC">,</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Bounds.oppositeQuadrant</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="STRN">"t"</span><span class="PUNC">==</span><span class="NAME">a.charAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"b"</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">"l"</span><span class="PUNC">==</span><span class="NAME">a.charAt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"r"</span><span class="PUNC">:</span><span class="STRN">"l"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">visible</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"none"</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.display</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toggle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Element.visible</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"none"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">c.style.display</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getHeight</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.offsetHeight</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hasClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.className</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">"(^|\\s)"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"(\\s|$)"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="NAME">addClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Element.hasClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.className</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.className</span><span class="PUNC">?</span><span class="STRN">" "</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.className</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.className</span><span class="PUNC">=</span><span class="NAME">OpenLayers.String.trim</span><span class="PUNC">(</span><span class="NAME">c.replace</span><span class="PUNC">(</span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">"(^|\\s+)"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"(\\s+|$)"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toggleClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Element.hasClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.style</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.style</span><span class="PUNC">[</span><span class="NAME">OpenLayers.String.camelize</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">document.defaultView</span><span class="PUNC">&&</span><span class="NAME">document.defaultView.getComputedStyle</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.defaultView.getComputedStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c.getPropertyValue</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">a.currentStyle</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.currentStyle</span><span class="PUNC">[</span><span class="NAME">OpenLayers.String.camelize</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="STRN">"top"</span><span class="PUNC">,</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="STRN">"bottom"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">window.opera</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="STRN">"static"</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"position"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"auto"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="STRN">"auto"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lon</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lat</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"lon="</span><span class="PUNC">+</span><span class="NAME">this.lon</span><span class="PUNC">+</span><span class="STRN">",lat="</span><span class="PUNC">+</span><span class="NAME">this.lat</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toShortString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.lon</span><span class="PUNC">+</span><span class="STRN">", "</span><span class="PUNC">+</span><span class="NAME">this.lat</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">this.lon</span><span class="PUNC">,</span><span class="NAME">this.lat</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"LonLat.add cannot receive null values"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">this.lon</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.lat</span><span class="PUNC">+</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.lon</span><span class="PUNC">==</span><span class="NAME">a.lon</span><span class="PUNC">&&</span><span class="NAME">this.lat</span><span class="PUNC">==</span><span class="NAME">a.lat</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.lon</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.lat</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transform</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.lon</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.lat</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lon</span><span class="PUNC">=</span><span class="NAME">c.x</span><span class="PUNC">;</span><span class="NAME">this.lat</span><span class="PUNC">=</span><span class="NAME">c.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wrapDateLine</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">b.lon</span><span class="PUNC">&lt;</span><span class="NAME">a.left</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b.lon</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">b.lon</span><span class="PUNC">></span><span class="NAME">a.right</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b.lon</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.LonLat"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="NAME">OpenLayers.LonLat.fromString</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.LonLat.fromArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"x="</span><span class="PUNC">+</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="STRN">",y="</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">==</span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="NAME">this.y</span><span class="PUNC">==</span><span class="NAME">a.y</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"Pixel.add cannot receive null values"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 79</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">offset</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Pixel"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Size</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">w</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.h</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"w="</span><span class="PUNC">+</span><span class="NAME">this.w</span><span class="PUNC">+</span><span class="STRN">",h="</span><span class="PUNC">+</span><span class="NAME">this.h</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">this.w</span><span class="PUNC">,</span><span class="NAME">this.h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.w</span><span class="PUNC">==</span><span class="NAME">a.w</span><span class="PUNC">&&</span><span class="NAME">this.h</span><span class="PUNC">==</span><span class="NAME">a.h</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.w</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Size"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Console</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">log</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">debug</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">info</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">warn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">error</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">userError</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">alert</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">assert</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dir</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dirxml</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">trace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">group</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">groupEnd</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">timeEnd</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">profile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">profileEnd</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">count</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Console"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"script"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">src.indexOf</span><span class="PUNC">(</span><span class="STRN">"firebug.js"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">console</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Console</span><span class="PUNC">,</span><span class="NAME">console</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Lang</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">code</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">defaultCode</span><span class="PUNC">:</span><span class="STRN">"en"</span><span class="PUNC">,</span><span class="NAME">getCode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Lang.code</span><span class="PUNC">||</span><span class="NAME">OpenLayers.Lang.setCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Lang.code</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"msie"</span><span class="PUNC">==</span><span class="NAME">OpenLayers.BROWSER_NAME</span><span class="PUNC">?</span><span class="NAME">navigator.userLanguage</span><span class="PUNC">:</span><span class="NAME">navigator.language</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">"-"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"object"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Lang</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"-"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"object"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Lang</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Console.warn</span><span class="PUNC">(</span><span class="STRN">"Failed to find OpenLayers.Lang."</span><span class="PUNC">+</span><span class="NAME">a.join</span><span class="PUNC">(</span><span class="STRN">"-"</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">" dictionary, falling back to default language"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Lang.defaultCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Lang.code</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Lang</span><span class="PUNC">[</span><span class="NAME">OpenLayers.Lang.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.String.format</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Lang.translate</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">arguments.length</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.isElement</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"[object Array]"</span><span class="PUNC">===</span><span class="NAME">Object.prototype.toString.call</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.splice</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a.indexOf</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.dotless</span><span class="PUNC">=</span><span class="REGX">/\./g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 83</span> </span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">=</span><span class="NAME">b.replace</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.dotless</span><span class="PUNC">,</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.left</span><span class="PUNC">=</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="NAME">c.y</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="NAME">d.w</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="NAME">d.h</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.position</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.border</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.overflow</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.style.filter</span><span class="PUNC">=</span><span class="STRN">"alpha(opacity="</span><span class="PUNC">+</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">,</span><span class="NAME">a.style.opacity</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.filter</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">a.style.opacity</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.style.backgroundImage</span><span class="PUNC">=</span><span class="STRN">"url("</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="STRN">"OpenLayersDiv"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="NAME">OpenLayers.Util.createImage</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"img"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="STRN">"OpenLayersDiv"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"relative"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"error"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.style.alt</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">i.galleryImg</span><span class="PUNC">=</span><span class="STRN">"no"</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.src</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.IMAGE_RELOAD_ATTEMPTS</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="NAME">OpenLayers.Util.alphaHackNeeded</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.alphaHack</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Util.alphaHackNeeded</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">navigator.appVersion.split</span><span class="PUNC">(</span><span class="STRN">"MSIE"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">document.body.filters</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="NAME">OpenLayers.Util.alphaHackNeeded</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NUMB">5.5</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">7</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.alphaHackNeeded</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="NAME">OpenLayers.Util.modifyAlphaImageDiv</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.childNodes</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.src</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="STRN">"_innerImage"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="STRN">"relative"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.alphaHack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"none"</span><span class="PUNC">!=</span><span class="NAME">a.style.display</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.display</span><span class="PUNC">=</span><span class="STRN">"inline-block"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="STRN">"scale"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.style.filter</span><span class="PUNC">=</span><span class="STRN">"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"</span><span class="PUNC">+</span><span class="NAME">b.src</span><span class="PUNC">+</span><span class="STRN">"', sizingMethod='"</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="STRN">"')"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.style.opacity</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.style.opacity</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'> 88</span> </span><span class="PUNC">(</span><span class="NAME">a.style.filter</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">" alpha(opacity="</span><span class="PUNC">+</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">a.style.opacity</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.style.filter</span><span class="PUNC">=</span><span class="STRN">"alpha(opacity=0)"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.createAlphaImageDiv</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createImage</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.className</span><span class="PUNC">=</span><span class="STRN">"olAlphaImg"</span><span class="PUNC">;</span><span class="NAME">j.appendChild</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.modifyAlphaImageDiv</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 89</span> </span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">window.Event</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">window.Event</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">&&</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">&&</span><span class="NAME">b.hasOwnProperty</span><span class="PUNC">(</span><span class="STRN">"toString"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.hasOwnProperty</span><span class="PUNC">(</span><span class="STRN">"toString"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.toString</span><span class="PUNC">=</span><span class="NAME">b.toString</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 90</span> </span><span class="NAME">OpenLayers.Util.getParameterString</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="STRN">"function"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.constructor</span><span class="PUNC">==</span><span class="NAME">Array</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">encodeURIComponent</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e.join</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">encodeURIComponent</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">encodeURIComponent</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"="</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.join</span><span class="PUNC">(</span><span class="STRN">"&"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.urlAppend</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="REGX">/[?&]/</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">===</span><span class="NAME">d.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">d.length</span><span class="PUNC">?</span><span class="STRN">"&"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">:</span><span class="STRN">"?"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 91</span> </span><span class="NAME">OpenLayers.Util.getImagesLocation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.ImgPath</span><span class="PUNC">||</span><span class="NAME">OpenLayers._getScriptLocation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"img/"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.getImageLocation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.getImagesLocation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.Try</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 92</span> </span><span class="NAME">OpenLayers.Util.getXmlNodeValue</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.Try</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.text</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.textContent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.firstChild.nodeValue</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.textContent</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.mouseLeft</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.relatedTarget</span><span class="PUNC">?</span><span class="NAME">a.relatedTarget</span><span class="PUNC">:</span><span class="NAME">a.toElement</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.parentNode</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.DEFAULT_PRECISION</span><span class="PUNC">=</span><span class="NUMB">14</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.toFloat</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.DEFAULT_PRECISION</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"number"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.toPrecision</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.deg</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">180</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.VincentyConstants</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">6378137</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">6356752.3142</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">298.257223563</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 94</span> </span><span class="NAME">OpenLayers.Util.distVincenty</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.VincentyConstants</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">(</span><span class="NAME">b.lon</span><span class="PUNC">-</span><span class="NAME">a.lon</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.atan</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">(</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.atan</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">(</span><span class="NAME">b.lat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">20</span><span class="PUNC">;</span><span class="NUMB">1.0</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">12</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">-</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="PUNC">--</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">q</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 95</span> </span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">/</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">16</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">NaN</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">1024</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">256</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">128</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">74</span><span class="PUNC">-</span><span class="NUMB">47</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">16384</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">4096</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">768</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">320</span><span class="PUNC">-</span><span class="NUMB">175</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toFixed</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="NAME">OpenLayers.Util.destinationVincenty</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.VincentyConstants</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.b</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e.f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.rad</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">d.rad</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NUMB">16384</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">4096</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">768</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">320</span><span class="PUNC">-</span><span class="NUMB">175</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NUMB">1024</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">256</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">128</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">74</span><span class="PUNC">-</span><span class="NUMB">47</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NUMB">1.0</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">12</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">o</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">/</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">/</span><span class="NUMB">16</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">d.deg</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.deg</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="NAME">OpenLayers.Util.getParameters</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">window.location.href</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.String.contains</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.String.contains</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"#"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"#"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.length</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.split</span><span class="PUNC">(</span><span class="REGX">/[&;]/</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">"="</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">decodeURIComponent</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">unescape</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\+/g</span><span class="PUNC">,</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">decodeURIComponent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">unescape</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.split</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">e.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.lastSeqID</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">"id_"</span><span class="PUNC">:</span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.dotless</span><span class="PUNC">,</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.lastSeqID</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">OpenLayers.Util.lastSeqID</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.INCHES_PER_UNIT</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">inches</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ft</span><span class="PUNC">:</span><span class="NUMB">12</span><span class="PUNC">,</span><span class="NAME">mi</span><span class="PUNC">:</span><span class="NUMB">63360</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">:</span><span class="NUMB">39.3701</span><span class="PUNC">,</span><span class="NAME">km</span><span class="PUNC">:</span><span class="NUMB">39370.1</span><span class="PUNC">,</span><span class="NAME">dd</span><span class="PUNC">:</span><span class="NUMB">4374754</span><span class="PUNC">,</span><span class="NAME">yd</span><span class="PUNC">:</span><span class="NUMB">36</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.INCHES_PER_UNIT</span><span class="PUNC">[</span><span class="STRN">"in"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.inches</span><span class="PUNC">;</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.degrees</span><span class="PUNC">=</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.dd</span><span class="PUNC">;</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.nmi</span><span class="PUNC">=</span><span class="NUMB">1852</span><span class="PUNC">*</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.m</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>100</span> </span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">=</span><span class="NUMB">0.0254000508001016</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">OpenLayers.INCHES_PER_UNIT</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">Inch</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.inches</span><span class="PUNC">,</span><span class="NAME">Meter</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Foot</span><span class="PUNC">:</span><span class="NUMB">0.3048006096012192</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IFoot</span><span class="PUNC">:</span><span class="NUMB">0.3048</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">ClarkeFoot</span><span class="PUNC">:</span><span class="NUMB">0.3047972651151</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">SearsFoot</span><span class="PUNC">:</span><span class="NUMB">0.30479947153867626</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">GoldCoastFoot</span><span class="PUNC">:</span><span class="NUMB">0.3047997101815088</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IInch</span><span class="PUNC">:</span><span class="NUMB">0.0254</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">MicroInch</span><span class="PUNC">:</span><span class="NUMB">2.54</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">5</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Mil</span><span class="PUNC">:</span><span class="NUMB">2.54</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>102</span> </span><span class="NAME">Centimeter</span><span class="PUNC">:</span><span class="NUMB">0.01</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Kilometer</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Yard</span><span class="PUNC">:</span><span class="NUMB">0.9144018288036576</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">SearsYard</span><span class="PUNC">:</span><span class="NUMB">0.914398414616029</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianYard</span><span class="PUNC">:</span><span class="NUMB">0.9143985307444408</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianYd37</span><span class="PUNC">:</span><span class="NUMB">0.91439523</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianYd62</span><span class="PUNC">:</span><span class="NUMB">0.9143988</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianYd75</span><span class="PUNC">:</span><span class="NUMB">0.9143985</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianFoot</span><span class="PUNC">:</span><span class="NUMB">0.30479951</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianFt37</span><span class="PUNC">:</span><span class="NUMB">0.30479841</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianFt62</span><span class="PUNC">:</span><span class="NUMB">0.3047996</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>103</span> </span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IndianFt75</span><span class="PUNC">:</span><span class="NUMB">0.3047995</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Mile</span><span class="PUNC">:</span><span class="NUMB">1609.3472186944373</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IYard</span><span class="PUNC">:</span><span class="NUMB">0.9144</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IMile</span><span class="PUNC">:</span><span class="NUMB">1609.344</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">NautM</span><span class="PUNC">:</span><span class="NUMB">1852</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="STRN">"Lat-66"</span><span class="PUNC">:</span><span class="NUMB">110943.31648893273</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="STRN">"Lat-83"</span><span class="PUNC">:</span><span class="NUMB">110946.25736872235</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Decimeter</span><span class="PUNC">:</span><span class="NUMB">0.1</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Millimeter</span><span class="PUNC">:</span><span class="NUMB">0.0010</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Dekameter</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Decameter</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>104</span> </span><span class="NAME">Hectometer</span><span class="PUNC">:</span><span class="NUMB">100</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">GermanMeter</span><span class="PUNC">:</span><span class="NUMB">1.0000135965</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">CaGrid</span><span class="PUNC">:</span><span class="NUMB">0.999738</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">ClarkeChain</span><span class="PUNC">:</span><span class="NUMB">20.1166194976</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">GunterChain</span><span class="PUNC">:</span><span class="NUMB">20.11684023368047</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">BenoitChain</span><span class="PUNC">:</span><span class="NUMB">20.116782494375872</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">SearsChain</span><span class="PUNC">:</span><span class="NUMB">20.11676512155</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">ClarkeLink</span><span class="PUNC">:</span><span class="NUMB">0.201166194976</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">GunterLink</span><span class="PUNC">:</span><span class="NUMB">0.2011684023368047</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">BenoitLink</span><span class="PUNC">:</span><span class="NUMB">0.20116782494375873</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>105</span> </span><span class="NAME">SearsLink</span><span class="PUNC">:</span><span class="NUMB">0.2011676512155</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Rod</span><span class="PUNC">:</span><span class="NUMB">5.02921005842012</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IntnlChain</span><span class="PUNC">:</span><span class="NUMB">20.1168</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">IntnlLink</span><span class="PUNC">:</span><span class="NUMB">0.201168</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Perch</span><span class="PUNC">:</span><span class="NUMB">5.02921005842012</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Pole</span><span class="PUNC">:</span><span class="NUMB">5.02921005842012</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Furlong</span><span class="PUNC">:</span><span class="NUMB">201.1684023368046</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Rood</span><span class="PUNC">:</span><span class="NUMB">3.778266898</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">CapeFoot</span><span class="PUNC">:</span><span class="NUMB">0.3047972615</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Brealey</span><span class="PUNC">:</span><span class="NUMB">375</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">ModAmFt</span><span class="PUNC">:</span><span class="NUMB">0.304812252984506</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>106</span> </span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="NAME">Fathom</span><span class="PUNC">:</span><span class="NUMB">1.8288</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="STRN">"NautM-UK"</span><span class="PUNC">:</span><span class="NUMB">1853.184</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="STRN">"50kilometers"</span><span class="PUNC">:</span><span class="NUMB">5</span><span class="NAME">E4</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">,</span><span class="STRN">"150kilometers"</span><span class="PUNC">:</span><span class="NUMB">15</span><span class="NAME">E4</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>107</span> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">OpenLayers.INCHES_PER_UNIT</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">mm</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Meter</span><span class="PUNC">/</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">,</span><span class="NAME">cm</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Meter</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">dm</span><span class="PUNC">:</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Meter</span><span class="PUNC">,</span><span class="NAME">km</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">*</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Meter</span><span class="PUNC">,</span><span class="NAME">kmi</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.nmi</span><span class="PUNC">,</span><span class="NAME">fath</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Fathom</span><span class="PUNC">,</span><span class="NAME">ch</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.IntnlChain</span><span class="PUNC">,</span><span class="NAME">link</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.IntnlLink</span><span class="PUNC">,</span><span class="STRN">"us-in"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.inches</span><span class="PUNC">,</span><span class="STRN">"us-ft"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Foot</span><span class="PUNC">,</span><span class="STRN">"us-yd"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Yard</span><span class="PUNC">,</span><span class="STRN">"us-ch"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.GunterChain</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>108</span> </span><span class="STRN">"us-mi"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.Mile</span><span class="PUNC">,</span><span class="STRN">"ind-yd"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.IndianYd37</span><span class="PUNC">,</span><span class="STRN">"ind-ft"</span><span class="PUNC">:</span><span class="NAME">OpenLayers.INCHES_PER_UNIT.IndianFt37</span><span class="PUNC">,</span><span class="STRN">"ind-ch"</span><span class="PUNC">:</span><span class="NUMB">20.11669506</span><span class="PUNC">/</span><span class="NAME">OpenLayers.METERS_PER_INCH</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.DOTS_PER_INCH</span><span class="PUNC">=</span><span class="NUMB">72</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.normalizeScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"degrees"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.normalizeScale</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">OpenLayers.INCHES_PER_UNIT</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">OpenLayers.DOTS_PER_INCH</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>109</span> </span><span class="NAME">OpenLayers.Util.getScaleFromResolution</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"degrees"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">OpenLayers.INCHES_PER_UNIT</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">OpenLayers.DOTS_PER_INCH</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>110</span> </span><span class="NAME">OpenLayers.Util.pagePosition</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getViewportElement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">window</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.IS_GECKO</span><span class="PUNC">&&</span><span class="NAME">document.getBoxObjectFor</span><span class="PUNC">&&</span><span class="STRN">"absolute"</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"position"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">==</span><span class="NAME">a.style.top</span><span class="PUNC">||</span><span class="STRN">""</span><span class="PUNC">==</span><span class="NAME">a.style.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.getBoundingClientRect</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getBoundingClientRect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.scrollTop</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.left</span><span class="PUNC">+</span><span class="NAME">c.scrollLeft</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.top</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">document.getBoxObjectFor</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.getBoxObjectFor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.getBoxObjectFor</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.screenX</span><span class="PUNC">-</span><span class="NAME">c.screenX</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>111</span> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.screenY</span><span class="PUNC">-</span><span class="NAME">c.screenY</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.offsetLeft</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.offsetTop</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.offsetParent</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e.offsetLeft</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e.offsetTop</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.offsetParent</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.BROWSER_NAME</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"opera"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">||</span><span class="STRN">"safari"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="STRN">"absolute"</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"position"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">document.body.offsetTop</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.offsetParent</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="NAME">document.body</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e.scrollLeft</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"opera"</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="STRN">"TR"</span><span class="PUNC">!=</span><span class="NAME">e.tagName</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e.scrollTop</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.offsetParent</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>112</span> </span><span class="NAME">OpenLayers.Util.getViewportElement</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">arguments.callee.viewportElement</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"msie"</span><span class="PUNC">==</span><span class="NAME">OpenLayers.BROWSER_NAME</span><span class="PUNC">&&</span><span class="STRN">"CSS1Compat"</span><span class="PUNC">!=</span><span class="NAME">document.compatMode</span><span class="PUNC">?</span><span class="NAME">document.body</span><span class="PUNC">:</span><span class="NAME">document.documentElement</span><span class="PUNC">,</span><span class="NAME">arguments.callee.viewportElement</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>113</span> </span><span class="NAME">OpenLayers.Util.isEquivalentUrl</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">ignoreCase</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ignorePort80</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ignoreHash</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUrlObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUrlObject</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"args"</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.args</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.args</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">b.args</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">b.args</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b.args</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>114</span> </span><span class="NAME">OpenLayers.Util.createUrlObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="REGX">/^\w+:\/\//</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">window.location</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.port</span><span class="PUNC">?</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">c.port</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.protocol</span><span class="PUNC">+</span><span class="STRN">"//"</span><span class="PUNC">+</span><span class="NAME">c.host.split</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"/"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.pathname.split</span><span class="PUNC">(</span><span class="STRN">"/"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">c.join</span><span class="PUNC">(</span><span class="STRN">"/"</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b.ignoreCase</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.href</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d.host</span><span class="PUNC">=</span><span class="NAME">c.host.split</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.protocol</span><span class="PUNC">=</span><span class="NAME">c.protocol</span><span class="PUNC">;</span><span class="NAME">d.port</span><span class="PUNC">=</span><span class="NAME">b.ignorePort80</span><span class="PUNC">?</span><span class="STRN">"80"</span><span class="PUNC">==</span><span class="NAME">c.port</span><span class="PUNC">||</span><span class="STRN">"0"</span><span class="PUNC">==</span><span class="NAME">c.port</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="NAME">c.port</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">==</span><span class="NAME">c.port</span><span class="PUNC">||</span><span class="STRN">"0"</span><span class="PUNC">==</span><span class="NAME">c.port</span><span class="PUNC">?</span><span class="STRN">"80"</span><span class="PUNC">:</span><span class="NAME">c.port</span><span class="PUNC">;</span><span class="NAME">d.hash</span><span class="PUNC">=</span><span class="NAME">b.ignoreHash</span><span class="PUNC">||</span><span class="STRN">"#"</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>115</span> </span><span class="NAME">c.hash</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="NAME">c.hash</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.search</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">a.substr</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.args</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getParameters</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.pathname</span><span class="PUNC">=</span><span class="STRN">"/"</span><span class="PUNC">==</span><span class="NAME">c.pathname.charAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c.pathname</span><span class="PUNC">:</span><span class="STRN">"/"</span><span class="PUNC">+</span><span class="NAME">c.pathname</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.removeTail</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"?"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"#"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">a.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">a.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.IS_GECKO</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"webkit"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"gecko"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>116</span> </span><span class="NAME">OpenLayers.CANVAS_SUPPORTED</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a.getContext</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">a.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.BROWSER_NAME</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">b.indexOf</span><span class="PUNC">(</span><span class="STRN">"opera"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"opera"</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">b.indexOf</span><span class="PUNC">(</span><span class="STRN">"msie"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"msie"</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">b.indexOf</span><span class="PUNC">(</span><span class="STRN">"safari"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"safari"</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">b.indexOf</span><span class="PUNC">(</span><span class="STRN">"mozilla"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">b.indexOf</span><span class="PUNC">(</span><span class="STRN">"firefox"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"firefox"</span><span class="PUNC">:</span><span class="STRN">"mozilla"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.getBrowserName</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.BROWSER_NAME</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>117</span> </span><span class="NAME">OpenLayers.Util.getRenderedDimensions</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.style.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.containerElement</span><span class="PUNC">?</span><span class="NAME">c.containerElement</span><span class="PUNC">:</span><span class="NAME">document.body</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.w</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NAME">f.style.width</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.h</span><span class="PUNC">,</span><span class="NAME">f.style.height</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.displayClass</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.className</span><span class="PUNC">=</span><span class="NAME">c.displayClass</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.innerHTML</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b.style.overflow</span><span class="PUNC">=</span><span class="STRN">"visible"</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.childNodes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.childNodes.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.childNodes</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.childNodes</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.overflow</span><span class="PUNC">=</span><span class="STRN">"visible"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>118</span> </span><span class="NAME">g.appendChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">f.parentNode</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="STRN">"body"</span><span class="PUNC">!=</span><span class="NAME">c.tagName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"position"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"absolute"</span><span class="PUNC">==</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="STRN">"static"</span><span class="PUNC">!=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.parentNode</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">f.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">b.scrollWidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.style.width</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">b.scrollHeight</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.removeChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>119</span> </span><span class="NAME">OpenLayers.Util.getScrollbarWidth</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util._scrollbarWidth</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="NAME">b.style.top</span><span class="PUNC">=</span><span class="STRN">"-1000px"</span><span class="PUNC">;</span><span class="NAME">b.style.left</span><span class="PUNC">=</span><span class="STRN">"-1000px"</span><span class="PUNC">;</span><span class="NAME">b.style.width</span><span class="PUNC">=</span><span class="STRN">"100px"</span><span class="PUNC">;</span><span class="NAME">b.style.height</span><span class="PUNC">=</span><span class="STRN">"50px"</span><span class="PUNC">;</span><span class="NAME">b.style.overflow</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">c.style.height</span><span class="PUNC">=</span><span class="STRN">"200px"</span><span class="PUNC">;</span><span class="NAME">b.appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.body.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.offsetWidth</span><span class="PUNC">;</span><span class="NAME">b.style.overflow</span><span class="PUNC">=</span><span class="STRN">"scroll"</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.offsetWidth</span><span class="PUNC">;</span><span class="NAME">document.body.removeChild</span><span class="PUNC">(</span><span class="NAME">document.body.lastChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span> </span><span class="NAME">OpenLayers.Util._scrollbarWidth</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util._scrollbarWidth</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>121</span> </span><span class="NAME">OpenLayers.Util.getFormattedLonLat</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"dms"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">540</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NUMB">360</span><span class="PUNC">-</span><span class="NUMB">180</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NUMB">10</span><span class="PUNC">;</span><span class="NUMB">60</span><span class="PUNC">&lt;=</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">60</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">60</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">60</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">10</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"0"</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">"\u00b0"</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c.indexOf</span><span class="PUNC">(</span><span class="STRN">"dm"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">"0"</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"'"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c.indexOf</span><span class="PUNC">(</span><span class="STRN">"dms"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="STRN">"0"</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">+</span><span class="STRN">'"'</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"lon"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"W"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"E"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"S"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"N"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Feature</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">lonlat</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">marker</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">popupClass</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">popup</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.lonlat</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.layer.map</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.popup</span><span class="PUNC">&&</span><span class="NAME">this.layer.map.removePopup</span><span class="PUNC">(</span><span class="NAME">this.popup</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.marker</span><span class="PUNC">&&</span><span class="NAME">this.layer.removeMarker</span><span class="PUNC">(</span><span class="NAME">this.marker</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="NAME">this.lonlat</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.marker</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>122</span> </span><span class="PUNC">(</span><span class="NAME">this.destroyMarker</span><span class="PUNC">(</span><span class="NAME">this.marker</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.marker</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.popup</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.destroyPopup</span><span class="PUNC">(</span><span class="NAME">this.popup</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.popup</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onScreen</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.layer.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.layer.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">containsLonLat</span><span class="PUNC">(</span><span class="NAME">this.lonlat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.lonlat</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.marker</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Marker</span><span class="PUNC">(</span><span class="NAME">this.lonlat</span><span class="PUNC">,</span><span class="NAME">this.data.icon</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.marker</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.marker.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createPopup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.lonlat</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.popup</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.popup</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.popupClass</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>123</span> </span><span class="NAME">this.popupClass</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Popup.Anchored</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_popup"</span><span class="PUNC">,</span><span class="NAME">this.lonlat</span><span class="PUNC">,</span><span class="NAME">this.data.popupSize</span><span class="PUNC">,</span><span class="NAME">this.data.popupContentHTML</span><span class="PUNC">,</span><span class="NAME">this.marker</span><span class="PUNC">?</span><span class="NAME">this.marker.icon</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.data.overflow</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.popup.contentDiv.style.overflow</span><span class="PUNC">=</span><span class="NAME">this.data.overflow</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.popup.feature</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.popup</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyPopup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.popup</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.popup.feature</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.popup.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.popup</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Feature"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.State</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">UNKNOWN</span><span class="PUNC">:</span><span class="STRN">"Unknown"</span><span class="PUNC">,</span><span class="NAME">INSERT</span><span class="PUNC">:</span><span class="STRN">"Insert"</span><span class="PUNC">,</span><span class="NAME">UPDATE</span><span class="PUNC">:</span><span class="STRN">"Update"</span><span class="PUNC">,</span><span class="NAME">DELETE</span><span class="PUNC">:</span><span class="STRN">"Delete"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>124</span> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Feature</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">fid</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">geometry</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">attributes</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">bounds</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">state</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">renderIntent</span><span class="PUNC">:</span><span class="STRN">"default"</span><span class="PUNC">,</span><span class="NAME">modified</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Feature.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lonlat</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.geometry</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.state</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.attributes</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.attributes</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">this.attributes</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.style</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.layer.removeFeatures</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>125</span> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.modified</span><span class="PUNC">=</span><span class="NAME">this.geometry</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Feature.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">?</span><span class="NAME">this.geometry.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.attributes</span><span class="PUNC">,</span><span class="NAME">this.style</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onScreen</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="NAME">this.layer.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layer.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.geometry.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.toGeometry</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">intersects</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVisibility</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.style</span><span class="PUNC">&&</span><span class="STRN">"none"</span><span class="PUNC">==</span><span class="NAME">this.style.display</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">this.layer</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>126</span> </span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="NAME">this.layer.styleMap</span><span class="PUNC">&&</span><span class="STRN">"none"</span><span class="PUNC">==</span><span class="NAME">this.layer.styleMap.createSymbolizer</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.renderIntent</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">display</span><span class="PUNC">||</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.layer.getVisibility</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createPopup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">atPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.geometry</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.geometry.atPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyPopup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="NAME">this.geometry.move</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"OpenLayers.LonLat"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">?</span><span class="NAME">this.layer.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>127</span> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layer.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">this.geometry.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layer.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry.move</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layer.drawFeature</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toState</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">OpenLayers.State.UPDATE</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.state</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.UNKNOWN</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">:</span><span class="NAME">this.state</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">OpenLayers.State.INSERT</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.state</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.UNKNOWN</span><span class="PUNC">:</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">this.state</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">this.state</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.UNKNOWN</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.UPDATE</span><span class="PUNC">:</span><span class="NAME">this.state</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>128</span> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">OpenLayers.State.UNKNOWN</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.state</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Feature.Vector"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>129</span> </span><span class="NAME">OpenLayers.Feature.Vector.style</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">"default"</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">fillColor</span><span class="PUNC">:</span><span class="STRN">"#ee9900"</span><span class="PUNC">,</span><span class="NAME">fillOpacity</span><span class="PUNC">:</span><span class="NUMB">0.4</span><span class="PUNC">,</span><span class="NAME">hoverFillColor</span><span class="PUNC">:</span><span class="STRN">"white"</span><span class="PUNC">,</span><span class="NAME">hoverFillOpacity</span><span class="PUNC">:</span><span class="NUMB">0.8</span><span class="PUNC">,</span><span class="NAME">strokeColor</span><span class="PUNC">:</span><span class="STRN">"#ee9900"</span><span class="PUNC">,</span><span class="NAME">strokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">strokeWidth</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">strokeLinecap</span><span class="PUNC">:</span><span class="STRN">"round"</span><span class="PUNC">,</span><span class="NAME">strokeDashstyle</span><span class="PUNC">:</span><span class="STRN">"solid"</span><span class="PUNC">,</span><span class="NAME">hoverStrokeColor</span><span class="PUNC">:</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">hoverStrokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hoverStrokeWidth</span><span class="PUNC">:</span><span class="NUMB">0.2</span><span class="PUNC">,</span><span class="NAME">pointRadius</span><span class="PUNC">:</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">hoverPointRadius</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hoverPointUnit</span><span class="PUNC">:</span><span class="STRN">"%"</span><span class="PUNC">,</span><span class="NAME">pointerEvents</span><span class="PUNC">:</span><span class="STRN">"visiblePainted"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"inherit"</span><span class="PUNC">,</span><span class="NAME">fontColor</span><span class="PUNC">:</span><span class="STRN">"#000000"</span><span class="PUNC">,</span><span class="NAME">labelAlign</span><span class="PUNC">:</span><span class="STRN">"cm"</span><span class="PUNC">,</span><span class="NAME">labelOutlineColor</span><span class="PUNC">:</span><span class="STRN">"white"</span><span class="PUNC">,</span><span class="NAME">labelOutlineWidth</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">select</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">fillColor</span><span class="PUNC">:</span><span class="STRN">"blue"</span><span class="PUNC">,</span><span class="NAME">fillOpacity</span><span class="PUNC">:</span><span class="NUMB">0.4</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>130</span> </span><span class="NAME">hoverFillColor</span><span class="PUNC">:</span><span class="STRN">"white"</span><span class="PUNC">,</span><span class="NAME">hoverFillOpacity</span><span class="PUNC">:</span><span class="NUMB">0.8</span><span class="PUNC">,</span><span class="NAME">strokeColor</span><span class="PUNC">:</span><span class="STRN">"blue"</span><span class="PUNC">,</span><span class="NAME">strokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">strokeWidth</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">strokeLinecap</span><span class="PUNC">:</span><span class="STRN">"round"</span><span class="PUNC">,</span><span class="NAME">strokeDashstyle</span><span class="PUNC">:</span><span class="STRN">"solid"</span><span class="PUNC">,</span><span class="NAME">hoverStrokeColor</span><span class="PUNC">:</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">hoverStrokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hoverStrokeWidth</span><span class="PUNC">:</span><span class="NUMB">0.2</span><span class="PUNC">,</span><span class="NAME">pointRadius</span><span class="PUNC">:</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">hoverPointRadius</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hoverPointUnit</span><span class="PUNC">:</span><span class="STRN">"%"</span><span class="PUNC">,</span><span class="NAME">pointerEvents</span><span class="PUNC">:</span><span class="STRN">"visiblePainted"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"pointer"</span><span class="PUNC">,</span><span class="NAME">fontColor</span><span class="PUNC">:</span><span class="STRN">"#000000"</span><span class="PUNC">,</span><span class="NAME">labelAlign</span><span class="PUNC">:</span><span class="STRN">"cm"</span><span class="PUNC">,</span><span class="NAME">labelOutlineColor</span><span class="PUNC">:</span><span class="STRN">"white"</span><span class="PUNC">,</span><span class="NAME">labelOutlineWidth</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">temporary</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">fillColor</span><span class="PUNC">:</span><span class="STRN">"#66cccc"</span><span class="PUNC">,</span><span class="NAME">fillOpacity</span><span class="PUNC">:</span><span class="NUMB">0.2</span><span class="PUNC">,</span><span class="NAME">hoverFillColor</span><span class="PUNC">:</span><span class="STRN">"white"</span><span class="PUNC">,</span><span class="NAME">hoverFillOpacity</span><span class="PUNC">:</span><span class="NUMB">0.8</span><span class="PUNC">,</span><span class="NAME">strokeColor</span><span class="PUNC">:</span><span class="STRN">"#66cccc"</span><span class="PUNC">,</span><span class="NAME">strokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>131</span> </span><span class="NAME">strokeLinecap</span><span class="PUNC">:</span><span class="STRN">"round"</span><span class="PUNC">,</span><span class="NAME">strokeWidth</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">strokeDashstyle</span><span class="PUNC">:</span><span class="STRN">"solid"</span><span class="PUNC">,</span><span class="NAME">hoverStrokeColor</span><span class="PUNC">:</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">hoverStrokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hoverStrokeWidth</span><span class="PUNC">:</span><span class="NUMB">0.2</span><span class="PUNC">,</span><span class="NAME">pointRadius</span><span class="PUNC">:</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">hoverPointRadius</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hoverPointUnit</span><span class="PUNC">:</span><span class="STRN">"%"</span><span class="PUNC">,</span><span class="NAME">pointerEvents</span><span class="PUNC">:</span><span class="STRN">"visiblePainted"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">:</span><span class="STRN">"inherit"</span><span class="PUNC">,</span><span class="NAME">fontColor</span><span class="PUNC">:</span><span class="STRN">"#000000"</span><span class="PUNC">,</span><span class="NAME">labelAlign</span><span class="PUNC">:</span><span class="STRN">"cm"</span><span class="PUNC">,</span><span class="NAME">labelOutlineColor</span><span class="PUNC">:</span><span class="STRN">"white"</span><span class="PUNC">,</span><span class="NAME">labelOutlineWidth</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">"delete"</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Style</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">title</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">description</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layerName</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">isDefault</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">rules</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">context</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">defaultStyle</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">defaultsPerSymbolizer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">propertyStyles</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rules</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.rules</span><span class="PUNC">&&</span><span class="NAME">this.addRules</span><span class="PUNC">(</span><span class="NAME">b.rules</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setDefaultStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">OpenLayers.Feature.Vector.style</span><span class="PUNC">[</span><span class="STRN">"default"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.rules.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.rules</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>132</span> </span><span class="NAME">this.rules</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.defaultStyle</span><span class="PUNC">=</span><span class="NAME">this.rules</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createSymbolizer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.defaultsPerSymbolizer</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="NAME">this.createLiterals</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.defaultStyle</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.rules</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.evaluate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Rule</span><span class="PUNC">&&</span><span class="NAME">d.elseFilter</span><span class="PUNC">?</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.applySymbolizer</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">e.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.applySymbolizer</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b.label</span><span class="PUNC">&&</span><span class="STRN">"string"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b.label</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>133</span> </span><span class="PUNC">(</span><span class="NAME">b.label</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">+</span><span class="NAME">b.label</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applySymbolizer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.geometry</span><span class="PUNC">?</span><span class="NAME">this.getSymbolizerPrefix</span><span class="PUNC">(</span><span class="NAME">c.geometry</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Style.SYMBOLIZER_PREFIXES</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.symbolizer</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">a.symbolizer</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.defaultsPerSymbolizer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.defaultStyle</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">pointRadius</span><span class="PUNC">:</span><span class="NAME">d.pointRadius</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.stroke</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.graphic</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">strokeWidth</span><span class="PUNC">:</span><span class="NAME">d.strokeWidth</span><span class="PUNC">,</span><span class="NAME">strokeColor</span><span class="PUNC">:</span><span class="NAME">d.strokeColor</span><span class="PUNC">,</span><span class="NAME">strokeOpacity</span><span class="PUNC">:</span><span class="NAME">d.strokeOpacity</span><span class="PUNC">,</span><span class="NAME">strokeDashstyle</span><span class="PUNC">:</span><span class="NAME">d.strokeDashstyle</span><span class="PUNC">,</span><span class="NAME">strokeLinecap</span><span class="PUNC">:</span><span class="NAME">d.strokeLinecap</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>134</span> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.fill</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.graphic</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">fillColor</span><span class="PUNC">:</span><span class="NAME">d.fillColor</span><span class="PUNC">,</span><span class="NAME">fillOpacity</span><span class="PUNC">:</span><span class="NAME">d.fillOpacity</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.graphic</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">pointRadius</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.pointRadius</span><span class="PUNC">,</span><span class="NAME">externalGraphic</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.externalGraphic</span><span class="PUNC">,</span><span class="NAME">graphicName</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.graphicName</span><span class="PUNC">,</span><span class="NAME">graphicOpacity</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.graphicOpacity</span><span class="PUNC">,</span><span class="NAME">graphicWidth</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.graphicWidth</span><span class="PUNC">,</span><span class="NAME">graphicHeight</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.graphicHeight</span><span class="PUNC">,</span><span class="NAME">graphicXOffset</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.graphicXOffset</span><span class="PUNC">,</span><span class="NAME">graphicYOffset</span><span class="PUNC">:</span><span class="NAME">this.defaultStyle.graphicYOffset</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.createLiterals</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createLiterals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b.attributes</span><span class="PUNC">||</span><span class="NAME">b.data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.propertyStyles</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Style.createLiteral</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">findPropertyStyles</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.addPropertyStyles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.defaultStyle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.rules</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">symbolizer</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">this.addPropertyStyles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.addPropertyStyles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>136</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addPropertyStyles</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.match</span><span class="PUNC">(</span><span class="REGX">/\$\{\w+\}/</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addRules</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Array.prototype.push.apply</span><span class="PUNC">(</span><span class="NAME">this.rules</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.propertyStyles</span><span class="PUNC">=</span><span class="NAME">this.findPropertyStyles</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setDefaultStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.defaultStyle</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.propertyStyles</span><span class="PUNC">=</span><span class="NAME">this.findPropertyStyles</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getSymbolizerPrefix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Style.SYMBOLIZER_PREFIXES</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">a.CLASS_NAME.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>137</span> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.rules</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.rules</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.rules.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">a.rules.push</span><span class="PUNC">(</span><span class="NAME">this.rules</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.context</span><span class="PUNC">=</span><span class="NAME">this.context</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.context</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.defaultStyle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Style"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Style.createLiteral</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"${"</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.String.format</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>138</span> </span><span class="NAME">OpenLayers.Style.SYMBOLIZER_PREFIXES</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"Point"</span><span class="PUNC">,</span><span class="STRN">"Line"</span><span class="PUNC">,</span><span class="STRN">"Polygon"</span><span class="PUNC">,</span><span class="STRN">"Text"</span><span class="PUNC">,</span><span class="STRN">"Raster"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">container</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">root</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">extent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">locked</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">resolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">featureDx</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.container</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="NAME">this.resolution</span><span class="PUNC">=</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">this.extent</span><span class="PUNC">=</span><span class="NAME">this.container</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">supported</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.extent</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>139</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.scale</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.extent</span><span class="PUNC">=</span><span class="NAME">a.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.resolution</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.resolution</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.resolution</span><span class="PUNC">=</span><span class="NAME">this.resolution</span><span class="PUNC">||</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.geometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.geometry.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">this.extent</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">worldBounds</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.calculateFeatureDx</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>140</span> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">display</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.drawGeometry</span><span class="PUNC">(</span><span class="NAME">a.geometry</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"none"</span><span class="PUNC">!=</span><span class="NAME">b.display</span><span class="PUNC">&&</span><span class="NAME">b.label</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.geometry.getCentroid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.labelXOffset</span><span class="PUNC">||</span><span class="NAME">b.labelYOffset</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b.labelXOffset</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">b.labelXOffset</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b.labelYOffset</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">b.labelYOffset</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.move</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.drawText</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.removeText</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateFeatureDx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.featureDx</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.featureDx</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">+</span><span class="NAME">a.right</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.extent.left</span><span class="PUNC">+</span><span class="NAME">this.extent.right</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>141</span> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureIdFromEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">eraseFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.eraseGeometry</span><span class="PUNC">(</span><span class="NAME">d.geometry</span><span class="PUNC">,</span><span class="NAME">d.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.removeText</span><span class="PUNC">(</span><span class="NAME">d.id</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">eraseGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getRenderLayerId</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.container.id</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyDefaultSymbolizer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Renderer.defaultSymbolizer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>142</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.stroke</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">b.strokeWidth</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">b.strokeColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.fill</span><span class="PUNC">&&</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">b.fillColor</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Renderer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.defaultSymbolizer</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">fillColor</span><span class="PUNC">:</span><span class="STRN">"#000000"</span><span class="PUNC">,</span><span class="NAME">strokeColor</span><span class="PUNC">:</span><span class="STRN">"#000000"</span><span class="PUNC">,</span><span class="NAME">strokeWidth</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">fillOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">strokeOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">pointRadius</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">labelAlign</span><span class="PUNC">:</span><span class="STRN">"cm"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>143</span> </span><span class="NAME">OpenLayers.Renderer.symbol</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">star</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">350</span><span class="PUNC">,</span><span class="NUMB">75</span><span class="PUNC">,</span><span class="NUMB">379</span><span class="PUNC">,</span><span class="NUMB">161</span><span class="PUNC">,</span><span class="NUMB">469</span><span class="PUNC">,</span><span class="NUMB">161</span><span class="PUNC">,</span><span class="NUMB">397</span><span class="PUNC">,</span><span class="NUMB">215</span><span class="PUNC">,</span><span class="NUMB">423</span><span class="PUNC">,</span><span class="NUMB">301</span><span class="PUNC">,</span><span class="NUMB">350</span><span class="PUNC">,</span><span class="NUMB">250</span><span class="PUNC">,</span><span class="NUMB">277</span><span class="PUNC">,</span><span class="NUMB">301</span><span class="PUNC">,</span><span class="NUMB">303</span><span class="PUNC">,</span><span class="NUMB">215</span><span class="PUNC">,</span><span class="NUMB">231</span><span class="PUNC">,</span><span class="NUMB">161</span><span class="PUNC">,</span><span class="NUMB">321</span><span class="PUNC">,</span><span class="NUMB">161</span><span class="PUNC">,</span><span class="NUMB">350</span><span class="PUNC">,</span><span class="NUMB">75</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">cross</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">25</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NUMB">35</span><span class="PUNC">,</span><span class="NUMB">75</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">65</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">75</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NUMB">65</span><span class="PUNC">,</span><span class="NUMB">25</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">35</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">square</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">triangle</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.ElementsIndexer</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">maxZIndex</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">order</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">indices</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">compare</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.compare</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER</span><span class="PUNC">:</span><span class="NAME">OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER</span><span class="PUNC">;</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">insert</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.exists</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.remove</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.id</span><span class="PUNC">;</span><span class="NAME">this.determineZIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.order.length</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.compare</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">this.order</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.order.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>144</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.indices</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.getZIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getNextElement</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.id</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.order</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.order.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.indices</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.maxZIndex</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.order.length</span><span class="PUNC">?</span><span class="NAME">this.indices</span><span class="PUNC">[</span><span class="NAME">this.order</span><span class="PUNC">[</span><span class="NAME">this.order.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.order</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.indices</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.maxZIndex</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">exists</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.indices</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a._style.graphicZIndex</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">determineZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a._style.graphicZIndex</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>145</span> </span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.maxZIndex</span><span class="PUNC">,</span><span class="NAME">a._style.graphicZIndex</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">></span><span class="NAME">this.maxZIndex</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.maxZIndex</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNextElement</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.order.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">this.order</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getNextElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.ElementsIndexer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>146</span> </span><span class="NAME">OpenLayers.ElementsIndexer.IndexingMethods</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">Z_ORDER</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.getZIndex</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getZIndex</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Z_ORDER_DRAWING_ORDER</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Z_ORDER_Y_ORDER</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c._boundsBottom</span><span class="PUNC">-</span><span class="NAME">b._boundsBottom</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>147</span> </span><span class="NAME">OpenLayers.Renderer.Elements</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Renderer</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">rendererRoot</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">root</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">vectorRoot</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">textRoot</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">xmlns</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">xOffset</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">indexer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">BACKGROUND_ID_SUFFIX</span><span class="PUNC">:</span><span class="STRN">"_background"</span><span class="PUNC">,</span><span class="NAME">LABEL_ID_SUFFIX</span><span class="PUNC">:</span><span class="STRN">"_label"</span><span class="PUNC">,</span><span class="NAME">LABEL_OUTLINE_SUFFIX</span><span class="PUNC">:</span><span class="STRN">"_outline"</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Renderer.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rendererRoot</span><span class="PUNC">=</span><span class="NAME">this.createRenderRoot</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.root</span><span class="PUNC">=</span><span class="NAME">this.createRoot</span><span class="PUNC">(</span><span class="STRN">"_root"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vectorRoot</span><span class="PUNC">=</span><span class="NAME">this.createRoot</span><span class="PUNC">(</span><span class="STRN">"_vroot"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.textRoot</span><span class="PUNC">=</span><span class="NAME">this.createRoot</span><span class="PUNC">(</span><span class="STRN">"_troot"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.root.appendChild</span><span class="PUNC">(</span><span class="NAME">this.vectorRoot</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>148</span> </span><span class="NAME">this.root.appendChild</span><span class="PUNC">(</span><span class="NAME">this.textRoot</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rendererRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">this.root</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.container.appendChild</span><span class="PUNC">(</span><span class="NAME">this.rendererRoot</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.zIndexing</span><span class="PUNC">||</span><span class="NAME">b.yOrdering</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.indexer</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.ElementsIndexer</span><span class="PUNC">(</span><span class="NAME">b.yOrdering</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.xmlns</span><span class="PUNC">=</span><span class="NAME">this.root</span><span class="PUNC">=</span><span class="NAME">this.rendererRoot</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.vectorRoot</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.firstChild</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.textRoot</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.firstChild</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.indexer</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>149</span> </span><span class="NAME">this.indexer.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.prototype.setExtent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.scale</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.right</span><span class="PUNC">></span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">f.right</span><span class="PUNC">&lt;</span><span class="NAME">a.right</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">f.left</span><span class="PUNC">></span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="NAME">f.left</span><span class="PUNC">&lt;</span><span class="NAME">a.right</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">!==</span><span class="NAME">this.rightOfDateLine</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.xOffset</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">f.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rightOfDateLine</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNodeType</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>150</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Collection"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiPoint"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiLineString"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiPolygon"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.drawGeometry</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="STRN">"none"</span><span class="PUNC">!=</span><span class="NAME">b.display</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.backgroundGraphic</span><span class="PUNC">?</span><span class="NAME">this.redrawBackgroundNode</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.redrawNode</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">b._style.backgroundGraphic</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>151</span> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="NAME">this.BACKGROUND_ID_SUFFIX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">redrawNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.applyDefaultSymbolizer</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.getNodeType</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a._featureId</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a._boundsBottom</span><span class="PUNC">=</span><span class="NAME">b.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">bottom</span><span class="PUNC">;</span><span class="NAME">a._geometryClass</span><span class="PUNC">=</span><span class="NAME">b.CLASS_NAME</span><span class="PUNC">;</span><span class="NAME">a._style</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.drawGeometryNode</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.node</span><span class="PUNC">;</span><span class="NAME">this.indexer</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.indexer.insert</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.vectorRoot.insertBefore</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.vectorRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.parentNode</span><span class="PUNC">!==</span><span class="NAME">this.vectorRoot</span><span class="PUNC">&&</span><span class="NAME">this.vectorRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>152</span> </span><span class="NAME">this.postDraw</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.complete</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">redrawBackgroundNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.externalGraphic</span><span class="PUNC">=</span><span class="NAME">c.backgroundGraphic</span><span class="PUNC">;</span><span class="NAME">c.graphicXOffset</span><span class="PUNC">=</span><span class="NAME">c.backgroundXOffset</span><span class="PUNC">;</span><span class="NAME">c.graphicYOffset</span><span class="PUNC">=</span><span class="NAME">c.backgroundYOffset</span><span class="PUNC">;</span><span class="NAME">c.graphicZIndex</span><span class="PUNC">=</span><span class="NAME">c.backgroundGraphicZIndex</span><span class="PUNC">;</span><span class="NAME">c.graphicWidth</span><span class="PUNC">=</span><span class="NAME">c.backgroundWidth</span><span class="PUNC">||</span><span class="NAME">c.graphicWidth</span><span class="PUNC">;</span><span class="NAME">c.graphicHeight</span><span class="PUNC">=</span><span class="NAME">c.backgroundHeight</span><span class="PUNC">||</span><span class="NAME">c.graphicHeight</span><span class="PUNC">;</span><span class="NAME">c.backgroundGraphic</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">c.backgroundXOffset</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">c.backgroundYOffset</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">c.backgroundGraphicZIndex</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.redrawNode</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.BACKGROUND_ID_SUFFIX</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>153</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawGeometryNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">a._style</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">isFilled</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c.fill</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">c.fill</span><span class="PUNC">,</span><span class="NAME">isStroked</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c.stroke</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">c.strokeWidth</span><span class="PUNC">:</span><span class="NAME">c.stroke</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">b.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">c.graphic</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.isFilled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d.isStroked</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.drawPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">:</span><span class="NAME">d.isFilled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.drawLineString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.drawLinearRing</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.drawPolygon</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>154</span> </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Rectangle"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.drawRectangle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a._options</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">e</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">node</span><span class="PUNC">:</span><span class="NAME">this.setStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">complete</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">postDraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLineString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLinearRing</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPolygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawRectangle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawCircle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.LABEL_ID_SUFFIX</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.textRoot.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.LABEL_OUTLINE_SUFFIX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.textRoot.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>155</span> </span><span class="NAME">getFeatureIdFromEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.target</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.correspondingUseElement</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">a.srcElement</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_featureId</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">eraseGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.MultiPoint"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiLineString"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiPolygon"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.Collection"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.eraseGeometry</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.parentNode</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.geometry</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>156</span> </span><span class="PUNC">(</span><span class="NAME">c.geometry.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.geometry</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.indexer</span><span class="PUNC">&&</span><span class="NAME">this.indexer.remove</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c._style.backgroundGraphic</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="NAME">this.BACKGROUND_ID_SUFFIX</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.parentNode</span><span class="PUNC">&&</span><span class="NAME">c.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nodeFactory</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">this.nodeTypeCompare</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.createNode</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nodeTypeCompare</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.root</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>157</span> </span><span class="NAME">a.root.parentNode</span><span class="PUNC">==</span><span class="NAME">this.rendererRoot</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.root</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.rendererRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getRenderLayerId</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.root.parentNode.parentNode.id</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isComplexSymbol</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"circle"</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Renderer.Elements"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.VML</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Renderer.Elements</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">xmlns</span><span class="PUNC">:</span><span class="STRN">"urn:schemas-microsoft-com:vml"</span><span class="PUNC">,</span><span class="NAME">symbolCache</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">offset</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.supported</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">document.namespaces.olv</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">document.namespaces.add</span><span class="PUNC">(</span><span class="STRN">"olv"</span><span class="PUNC">,</span><span class="NAME">this.xmlns</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createStyleSheet</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"shape rect oval fill stroke imagedata group textbox"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.addRule</span><span class="PUNC">(</span><span class="STRN">"olv\\:"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"behavior: url(#default#VML); position: absolute; display: inline-block;"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">OpenLayers.Renderer.Elements.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>158</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">supported</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">document.namespaces</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Elements.prototype.setExtent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.left</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.top</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.size.h</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">this.offset</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.offset</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.offset.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">this.offset.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.root.coordorigin</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">this.xOffset</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">this.root</span><span class="PUNC">,</span><span class="NAME">this.vectorRoot</span><span class="PUNC">,</span><span class="NAME">this.textRoot</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.coordsize</span><span class="PUNC">=</span><span class="NAME">this.size.w</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">this.size.h</span><span class="PUNC">;</span><span class="NAME">this.root.style.flip</span><span class="PUNC">=</span><span class="STRN">"y"</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>159</span> </span><span class="NAME">setSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Renderer.prototype.setSize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">this.rendererRoot</span><span class="PUNC">,</span><span class="NAME">this.root</span><span class="PUNC">,</span><span class="NAME">this.vectorRoot</span><span class="PUNC">,</span><span class="NAME">this.textRoot</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.size.w</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.size.h</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e.style.width</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e.style.height</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNodeType</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.externalGraphic</span><span class="PUNC">?</span><span class="STRN">"olv:rect"</span><span class="PUNC">:</span><span class="NAME">this.isComplexSymbol</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"olv:shape"</span><span class="PUNC">:</span><span class="STRN">"olv:oval"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Rectangle"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"olv:rect"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Curve"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>160</span> </span><span class="STRN">"olv:shape"</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">a._style</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">a._options</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.fillColor</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.title</span><span class="PUNC">||</span><span class="NAME">b.graphicTitle</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.title</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">===</span><span class="NAME">a._geometryClass</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.externalGraphic</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.isFilled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.graphicWidth</span><span class="PUNC">||</span><span class="NAME">b.graphicHeight</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.graphicHeight</span><span class="PUNC">||</span><span class="NAME">b.graphicWidth</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b.graphicXOffset</span><span class="PUNC">?</span><span class="NAME">b.graphicXOffset</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b.graphicYOffset</span><span class="PUNC">?</span><span class="NAME">b.graphicYOffset</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.left</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">d.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>161</span> </span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d.y</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.flip</span><span class="PUNC">=</span><span class="STRN">"y"</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">c.isStroked</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.isComplexSymbol</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.importSymbol</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.path</span><span class="PUNC">=</span><span class="NAME">f.path</span><span class="PUNC">,</span><span class="NAME">a.coordorigin</span><span class="PUNC">=</span><span class="NAME">f.left</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">f.bottom</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.size</span><span class="PUNC">,</span><span class="NAME">a.coordsize</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">this.drawCircle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b.pointRadius</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.style.flip</span><span class="PUNC">=</span><span class="STRN">"y"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.drawCircle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b.pointRadius</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.isFilled</span><span class="PUNC">?</span><span class="NAME">a.fillcolor</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">a.filled</span><span class="PUNC">=</span><span class="STRN">"false"</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">d.length</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.isFilled</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>162</span> </span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.createNode</span><span class="PUNC">(</span><span class="STRN">"olv:fill"</span><span class="PUNC">,</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="STRN">"_fill"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.opacity</span><span class="PUNC">=</span><span class="NAME">b.fillOpacity</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">===</span><span class="NAME">a._geometryClass</span><span class="PUNC">&&</span><span class="NAME">b.externalGraphic</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.graphicOpacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.opacity</span><span class="PUNC">=</span><span class="NAME">b.graphicOpacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.src</span><span class="PUNC">=</span><span class="NAME">b.externalGraphic</span><span class="PUNC">,</span><span class="NAME">d.type</span><span class="PUNC">=</span><span class="STRN">"frame"</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NAME">b.graphicWidth</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">b.graphicHeight</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">d.aspect</span><span class="PUNC">=</span><span class="STRN">"atmost"</span><span class="PUNC">;</span><span class="NAME">d.parentNode</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">a.removeChild</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.rotation</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a._rotation</span><span class="PUNC">)</span><span class="NAME">a._rotation</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b.externalGraphic</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.graphicRotate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.opacity</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">===</span><span class="NAME">a._geometryClass</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>163</span> </span><span class="PUNC">(</span><span class="NAME">a.style.rotation</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">h.length</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.isStroked</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.createNode</span><span class="PUNC">(</span><span class="STRN">"olv:stroke"</span><span class="PUNC">,</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="STRN">"_stroke"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h.on</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h.color</span><span class="PUNC">=</span><span class="NAME">b.strokeColor</span><span class="PUNC">,</span><span class="NAME">h.weight</span><span class="PUNC">=</span><span class="NAME">b.strokeWidth</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">h.opacity</span><span class="PUNC">=</span><span class="NAME">b.strokeOpacity</span><span class="PUNC">,</span><span class="NAME">h.endcap</span><span class="PUNC">=</span><span class="STRN">"butt"</span><span class="PUNC">==</span><span class="NAME">b.strokeLinecap</span><span class="PUNC">?</span><span class="STRN">"flat"</span><span class="PUNC">:</span><span class="NAME">b.strokeLinecap</span><span class="PUNC">||</span><span class="STRN">"round"</span><span class="PUNC">,</span><span class="NAME">b.strokeDashstyle</span><span class="PUNC">)</span><span class="NAME">h.dashstyle</span><span class="PUNC">=</span><span class="NAME">this.dashStyle</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a.stroked</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h.on</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"inherit"</span><span class="PUNC">!=</span><span class="NAME">b.cursor</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b.cursor</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.cursor</span><span class="PUNC">=</span><span class="NAME">b.cursor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">graphicRotate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>164</span> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">a._style</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.rotation</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">d.graphicWidth</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">d.graphicHeight</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Image</span><span class="PUNC">;</span><span class="NAME">h.onreadystatechange</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"complete"</span><span class="PUNC">==</span><span class="NAME">h.readyState</span><span class="PUNC">||</span><span class="STRN">"interactive"</span><span class="PUNC">==</span><span class="NAME">h.readyState</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h.width</span><span class="PUNC">/</span><span class="NAME">h.height</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">d.pointRadius</span><span class="PUNC">,</span><span class="NAME">d.graphicWidth</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d.graphicHeight</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">d.graphicWidth</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">d.graphicHeight</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this.graphicRotate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.src</span><span class="PUNC">=</span><span class="NAME">d.externalGraphic</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">d.graphicWidth</span><span class="PUNC">,</span><span class="NAME">d.graphicHeight</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.graphicWidth</span><span class="PUNC">/</span><span class="NAME">d.graphicHeight</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.graphicWidth</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>165</span> </span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.graphicHeight</span><span class="PUNC">||</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="STRN">"_image"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">this.createNode</span><span class="PUNC">(</span><span class="STRN">"olv:imagedata"</span><span class="PUNC">,</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="STRN">"_image"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.style.width</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">k.style.height</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">k.src</span><span class="PUNC">=</span><span class="NAME">d.externalGraphic</span><span class="PUNC">;</span><span class="NAME">k.style.filter</span><span class="PUNC">=</span><span class="STRN">"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')"</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"progid:DXImageTransform.Microsoft.Matrix(M11="</span><span class="PUNC">+</span><span class="NAME">k</span><span class="PUNC">+</span><span class="STRN">",M12="</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">",M21="</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">",M22="</span><span class="PUNC">+</span><span class="NAME">k</span><span class="PUNC">+</span><span class="STRN">",SizingMethod='auto expand')\n"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>166</span> </span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">d.graphicOpacity</span><span class="PUNC">||</span><span class="NAME">d.fillOpacity</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">k</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">"progid:DXImageTransform.Microsoft.BasicImage(opacity="</span><span class="PUNC">+</span><span class="NAME">k</span><span class="PUNC">+</span><span class="STRN">")\n"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.filter</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toGeometry</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.rotate</span><span class="PUNC">(</span><span class="NAME">d.rotation</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.left</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.style.left</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">i.left</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.style.top</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">i.bottom</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">postDraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.style.visibility</span><span class="PUNC">=</span><span class="STRN">"visible"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a._style.fillColor</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a._style.strokeColor</span><span class="PUNC">;</span><span class="STRN">"none"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.fillcolor</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>167</span> </span><span class="PUNC">(</span><span class="NAME">a.fillcolor</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"none"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">a.strokecolor</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.strokecolor</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setNodeDimension</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c.left</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c.bottom</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">c.right</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c.top</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.left</span><span class="PUNC">=</span><span class="NAME">c.left</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="NAME">c.top</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="NAME">c.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.coordorigin</span><span class="PUNC">=</span><span class="NAME">c.left</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">c.top</span><span class="PUNC">;</span><span class="NAME">a.coordsize</span><span class="PUNC">=</span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">c.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dashStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>168</span> </span><span class="NAME">a.strokeDashstyle</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"solid"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dot"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dash"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dashdot"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"longdash"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"longdashdot"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="REGX">/[ ,]/</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">==</span><span class="NAME">a.length</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">>=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="STRN">"longdash"</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="STRN">"dot"</span><span class="PUNC">:</span><span class="STRN">"dash"</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">==</span><span class="NAME">a.length</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">>=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="STRN">"longdashdot"</span><span class="PUNC">:</span><span class="STRN">"dashdot"</span><span class="PUNC">:</span><span class="STRN">"solid"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.id</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.unselectable</span><span class="PUNC">=</span><span class="STRN">"on"</span><span class="PUNC">;</span><span class="NAME">c.onselectstart</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.False</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nodeTypeCompare</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.indexOf</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.substr</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>169</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.nodeName</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e.indexOf</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.substr</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createRenderRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="STRN">"_vmlRoot"</span><span class="PUNC">,</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"olv:group"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawCircle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawCircle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.left</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>170</span> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLineString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawLine</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLinearRing</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawLine</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLine</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setNodeDimension</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.components.length</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">g.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.y</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="STRN">" l "</span><span class="PUNC">;</span><span class="NAME">a.path</span><span class="PUNC">=</span><span class="STRN">"m"</span><span class="PUNC">+</span><span class="NAME">f.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">?</span><span class="STRN">" x e"</span><span class="PUNC">:</span><span class="STRN">" e"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPolygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setNodeDimension</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>171</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.components.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="STRN">"m"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">components</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">o</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m.y</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">k</span><span class="PUNC">&&</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="STRN">" l"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">?</span><span class="NAME">i</span><span class="PUNC">!=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">?</span><span class="NAME">j</span><span class="PUNC">!=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">?</span><span class="STRN">" x "</span><span class="PUNC">:</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="STRN">"e"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.path</span><span class="PUNC">=</span><span class="NAME">d.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawRectangle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.left</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>172</span> </span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.width</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.height</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.LABEL_ID_SUFFIX</span><span class="PUNC">,</span><span class="STRN">"olv:rect"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.LABEL_ID_SUFFIX</span><span class="PUNC">+</span><span class="STRN">"_textbox"</span><span class="PUNC">,</span><span class="STRN">"olv:textbox"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.style.left</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">this.offset.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">d.style.top</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">this.offset.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">d.style.flip</span><span class="PUNC">=</span><span class="STRN">"y"</span><span class="PUNC">;</span><span class="NAME">e.innerText</span><span class="PUNC">=</span><span class="NAME">b.label</span><span class="PUNC">;</span><span class="STRN">"inherit"</span><span class="PUNC">!=</span><span class="NAME">b.cursor</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b.cursor</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.style.cursor</span><span class="PUNC">=</span><span class="NAME">b.cursor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontColor</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>173</span> </span><span class="PUNC">(</span><span class="NAME">e.style.color</span><span class="PUNC">=</span><span class="NAME">b.fontColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontOpacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.style.filter</span><span class="PUNC">=</span><span class="STRN">"alpha(opacity="</span><span class="PUNC">+</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">b.fontOpacity</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontFamily</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.style.fontFamily</span><span class="PUNC">=</span><span class="NAME">b.fontFamily</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontSize</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.style.fontSize</span><span class="PUNC">=</span><span class="NAME">b.fontSize</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontWeight</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.style.fontWeight</span><span class="PUNC">=</span><span class="NAME">b.fontWeight</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontStyle</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.style.fontStyle</span><span class="PUNC">=</span><span class="NAME">b.fontStyle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.labelSelect</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d._featureId</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e._featureId</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e._geometry</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e._geometryClass</span><span class="PUNC">=</span><span class="NAME">c.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.style.whiteSpace</span><span class="PUNC">=</span><span class="STRN">"nowrap"</span><span class="PUNC">;</span><span class="NAME">e.inset</span><span class="PUNC">=</span><span class="STRN">"1px,0px,0px,0px"</span><span class="PUNC">;</span><span class="NAME">d.parentNode</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">d.appendChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.textRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.labelAlign</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>174</span> </span><span class="STRN">"cm"</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">b.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">"m"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e.clientWidth</span><span class="PUNC">*</span><span class="NAME">OpenLayers.Renderer.VML.LABEL_SHIFT</span><span class="PUNC">[</span><span class="NAME">b.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.clientHeight</span><span class="PUNC">*</span><span class="NAME">OpenLayers.Renderer.VML.LABEL_SHIFT</span><span class="PUNC">[</span><span class="NAME">b.substr</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d.style.left</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">d.style.left</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">d.style.top</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">d.style.top</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getLayer</span><span class="PUNC">(</span><span class="NAME">a.container.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Vector.RootContainer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getLayer</span><span class="PUNC">(</span><span class="NAME">this.container.id</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.renderer.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.Elements.prototype.moveRoot.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>175</span> </span><span class="NAME">importSymbol</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="STRN">"-"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.symbolCache</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.symbol</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">" is not a valid symbol name"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"m"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.left</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.bottom</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.right</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.top</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="STRN">"x e"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.join</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">a.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>176</span> </span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.top</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.right</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">path</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">left</span><span class="PUNC">:</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="NAME">a.bottom</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.symbolCache</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Renderer.VML"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.VML.LABEL_SHIFT</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">:</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Animation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a.requestAnimationFrame</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.webkitRequestAnimationFrame</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.mozRequestAnimationFrame</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.oRequestAnimationFrame</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.msRequestAnimationFrame</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.requestAnimationFrame</span><span class="PUNC">||</span><span class="NAME">a.webkitRequestAnimationFrame</span><span class="PUNC">||</span><span class="NAME">a.mozRequestAnimationFrame</span><span class="PUNC">||</span><span class="NAME">a.oRequestAnimationFrame</span><span class="PUNC">||</span><span class="NAME">a.msRequestAnimationFrame</span><span class="PUNC">||</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.setTimeout</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.apply</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">isNative</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">requestFrame</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">start</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>177</span> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">+</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">+</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">stop</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Tween</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">easing</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">begin</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">finish</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">duration</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">callbacks</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">animationId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">playing</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.easing</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Easing.Expo.easeOut</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">start</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.playing</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.begin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.finish</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.duration</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.callbacks</span><span class="PUNC">=</span><span class="NAME">d.callbacks</span><span class="PUNC">;</span><span class="NAME">this.time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Animation.stop</span><span class="PUNC">(</span><span class="NAME">this.animationId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.animationId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.callbacks</span><span class="PUNC">&&</span><span class="NAME">this.callbacks.start</span><span class="PUNC">&&</span><span class="NAME">this.callbacks.start.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.begin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.animationId</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Animation.start</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.play</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>178</span> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">stop</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.playing</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.callbacks</span><span class="PUNC">&&</span><span class="NAME">this.callbacks.done</span><span class="PUNC">&&</span><span class="NAME">this.callbacks.done.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.finish</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Animation.stop</span><span class="PUNC">(</span><span class="NAME">this.animationId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.animationId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.playing</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">play</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.begin</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.begin</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.finish</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"invalid value for Tween"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.easing.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.time</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.duration</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.time</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">this.callbacks</span><span class="PUNC">&&</span><span class="NAME">this.callbacks.eachStep</span><span class="PUNC">&&</span><span class="NAME">this.callbacks.eachStep.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>179</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.time</span><span class="PUNC">></span><span class="NAME">this.duration</span><span class="PUNC">&&</span><span class="NAME">this.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Tween"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Easing</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Easing"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Easing.Linear</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">easeIn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">easeOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">easeInOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Easing.Linear"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>180</span> </span><span class="NAME">OpenLayers.Easing.Expo</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">easeIn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">easeOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">easeInOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">></span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">--</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Easing.Expo"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>181</span> </span><span class="NAME">OpenLayers.Easing.Quad</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">easeIn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">easeOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">easeInOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">></span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">--</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Easing.Quad"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">parent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">bounds</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.parent</span><span class="PUNC">&&</span><span class="NAME">this.parent.clearBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extendBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.bounds.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.setBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.bounds</span><span class="PUNC">&&</span><span class="NAME">this.calculateBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>182</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.bounds</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVertices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">atPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.bounds.left</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.bounds.bottom</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.bounds.right</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.bounds.top</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">containsLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCentroid</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Format.WKT</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Format.WKT.prototype.write</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>183</span> </span><span class="NAME">Object.prototype.toString.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.fromWKT</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Format</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Format.WKT</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.fromWKT.format</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.WKT</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Geometry.fromWKT.format</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.read</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">geometry</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>184</span> </span><span class="NAME">OpenLayers.Geometry.segmentsIntersect</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.point</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.tolerance</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.x1</span><span class="PUNC">-</span><span class="NAME">b.x1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.y1</span><span class="PUNC">-</span><span class="NAME">b.y1</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.x2</span><span class="PUNC">-</span><span class="NAME">a.x1</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.y2</span><span class="PUNC">-</span><span class="NAME">a.y1</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b.y2</span><span class="PUNC">-</span><span class="NAME">b.y1</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">b.x2</span><span class="PUNC">-</span><span class="NAME">b.x1</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">o</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">/</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">o</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.x1</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a.y1</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NUMB">2</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="STRN">"x"</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="STRN">"y"</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">-</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.x</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">e.y</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>185</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NUMB">2</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">[</span><span class="STRN">"x"</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">[</span><span class="STRN">"y"</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.distanceToSegment</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.distance</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.distanceToSegment</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.x1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.y1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.x2</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b.y2</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">k</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">&lt;=</span><span class="NAME">k</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">components</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Geometry.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.components</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.addComponents</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.components.length</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.components</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">"new "</span><span class="PUNC">+</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="STRN">"()"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.addComponent</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>186</span> </span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getComponentsString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toShortString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.join</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.extend</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.left</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.bottom</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.right</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.top</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.setBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addComponents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>187</span> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.addComponent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.componentTypes</span><span class="PUNC">||</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.componentTypes</span><span class="PUNC">,</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.slice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.components</span><span class="PUNC">=</span><span class="NAME">c.concat</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.components.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.parent</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.clearBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeComponents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>188</span> </span><span class="NAME">this.removeComponent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clearBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getArea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getGeodesicArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getGeodesicArea</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCentroid</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.components.length</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>189</span> </span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getCentroid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.getArea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.getCentroid</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getGeodesicLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>190</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getGeodesicLength</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">move</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">rotate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">resize</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b.edge</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.details</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>191</span> </span><span class="NAME">i</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distanceTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">d.distance</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">||</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">!=</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">a.components.length</span><span class="PUNC">!=</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">equals</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transform</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">transform</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>192</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersects</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.intersects</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVertices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">Array.prototype.push.apply</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getVertices</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.Collection"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Geometry.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b.edge</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.details</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>193</span> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">d.x1</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">d.y1</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">d.x0</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">d.y0</span><span class="PUNC">,</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">d.distance</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">==</span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="NAME">this.y</span><span class="PUNC">==</span><span class="NAME">a.y</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toShortString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="STRN">", "</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.clearBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>194</span> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.distanceTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clearBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCentroid</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clearBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersects</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">?</span><span class="NAME">this.equals</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.intersects</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transform</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>195</span> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVertices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="KEYW">this</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.MultiPoint</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">addPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.addComponent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removePoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.removeComponent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.MultiPoint"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.Curve</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.MultiPoint</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">getLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distanceTo</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getGeodesicLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.equals</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">transform</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.components</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">b.components.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.components.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>196</span> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.distVincenty</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">c.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">d.x</span><span class="PUNC">,</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">d.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.Curve"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.Curve</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">removeComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">&&</span><span class="NUMB">2</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Geometry.Collection.prototype.removeComponent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersects</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getSortedSegments</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">{</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">x2</span><span class="PUNC">:</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">y2</span><span class="PUNC">:</span><span class="NAME">a.y</span><span class="PUNC">}</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">a.getSortedSegments</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>197</span> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.x1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.x2</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.y1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.y2</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i.x1</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">i.x2</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i.y1</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">i.y2</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Geometry.segmentsIntersect</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.intersects</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getSortedSegments</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.x</span><span class="PUNC">&lt;</span><span class="NAME">d.x</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">x2</span><span class="PUNC">:</span><span class="NAME">d.x</span><span class="PUNC">,</span><span class="NAME">y2</span><span class="PUNC">:</span><span class="NAME">d.y</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>198</span> </span><span class="PUNC">{</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">d.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">d.y</span><span class="PUNC">,</span><span class="NAME">x2</span><span class="PUNC">:</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">y2</span><span class="PUNC">:</span><span class="NAME">c.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x1</span><span class="PUNC">-</span><span class="NAME">b.x1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">splitWithSegment</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b.edge</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.tolerance</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">point</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">tolerance</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&lt;=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">n</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">d.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">d.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">d.y</span><span class="PUNC">,</span><span class="NAME">x2</span><span class="PUNC">:</span><span class="NAME">j.x</span><span class="PUNC">,</span><span class="NAME">y2</span><span class="PUNC">:</span><span class="NAME">j.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.segmentsIntersect</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">k.x</span><span class="PUNC">===</span><span class="NAME">a.x1</span><span class="PUNC">&&</span><span class="NAME">k.y</span><span class="PUNC">===</span><span class="NAME">a.y1</span><span class="PUNC">||</span><span class="NAME">k.x</span><span class="PUNC">===</span><span class="NAME">a.x2</span><span class="PUNC">&&</span><span class="NAME">k.y</span><span class="PUNC">===</span><span class="NAME">a.y2</span><span class="PUNC">||</span><span class="NAME">k.equals</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">k.equals</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">k.equals</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>199</span> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="NAME">k.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">n</span><span class="PUNC">&&</span><span class="NAME">k.equals</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">k.equals</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">k.equals</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">k.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">j.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">a.x1</span><span class="PUNC">&lt;</span><span class="NAME">a.x2</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a.y1</span><span class="PUNC">&lt;</span><span class="NAME">a.y2</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">lines</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">points</span><span class="PUNC">:</span><span class="NAME">h.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">||</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">split</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.mutual</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.getVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>200</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">i.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">&lt;=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">j.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">j.y</span><span class="PUNC">,</span><span class="NAME">x2</span><span class="PUNC">:</span><span class="NAME">k.x</span><span class="PUNC">,</span><span class="NAME">y2</span><span class="PUNC">:</span><span class="NAME">k.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">||</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="NAME">j.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">r</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">splitWithSegment</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">m.lines</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">l.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l.unshift</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Array.prototype.splice.apply</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">l.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.points.length</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">s</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">m.points</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l.equals</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.equals</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">g.length</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">n.length</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="NAME">k.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>201</span> </span><span class="NAME">a.splitWith</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">g.length</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">splitWith</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVertices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">this.components.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.components.slice</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.components.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.components.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b.edge</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.details</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getSortedSegments</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>202</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">o</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.distanceToSegment</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.distance</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.distance</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.x2</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">></span><span class="NAME">j.y1</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j.y2</span><span class="PUNC">||</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j.y1</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">></span><span class="NAME">j.y2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">e.distance</span><span class="PUNC">,</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="NAME">e.distance</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getSortedSegments</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.getSortedSegments</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">point</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">o</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i.x1</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">i.y1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">p</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.segmentsIntersect</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>203</span> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">m.x</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">m.y</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">m.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">m.y</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.distanceToSegment</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.distance</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.distance</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">d.x</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">d.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.distance</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">i.x2</span><span class="PUNC">,</span><span class="NAME">i.y2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">d.distance</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">d.x1</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">d.y1</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">d.x0</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">d.y0</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">e.distance</span><span class="PUNC">,</span><span class="NAME">x0</span><span class="PUNC">:</span><span class="NAME">e.x1</span><span class="PUNC">,</span><span class="NAME">y0</span><span class="PUNC">:</span><span class="NAME">e.y1</span><span class="PUNC">,</span><span class="NAME">x1</span><span class="PUNC">:</span><span class="NAME">e.x0</span><span class="PUNC">,</span><span class="NAME">y1</span><span class="PUNC">:</span><span class="NAME">e.y0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">simplify</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>204</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">b.length</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">o</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">o</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">l.y</span><span class="PUNC">+</span><span class="NAME">l.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">+</span><span class="NAME">n.x</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">*</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">n.x</span><span class="PUNC">*</span><span class="NAME">l.y</span><span class="PUNC">-</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">/</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">></span><span class="NAME">j</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">j</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">k</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">equals</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">--</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>205</span> </span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.LinearRing</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">addComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">a.equals</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.Collection.prototype.addComponent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.Collection.prototype.addComponent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">&&</span><span class="NUMB">3</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.components.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Geometry.Collection.prototype.removeComponent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>206</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Geometry.Collection.prototype.addComponent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">move</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">rotate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">resize</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transform</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">transform</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>207</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCentroid</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">2</span><span class="PUNC">>=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">*</span><span class="NAME">this.getArea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">h.x</span><span class="PUNC">+</span><span class="NAME">i.x</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">h.x</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">i.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">i.x</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">h.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">h.y</span><span class="PUNC">+</span><span class="NAME">i.y</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">h.x</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">i.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">i.x</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">h.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>208</span> </span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">&&</span><span class="NUMB">2</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">d.x</span><span class="PUNC">+</span><span class="NAME">e.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">-</span><span class="NAME">d.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getGeodesicArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.equals</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">transform</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">&&</span><span class="NAME">b.components.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>209</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">-</span><span class="NAME">d.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">(</span><span class="NAME">d.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.rad</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">40680631590769</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Number.limitSigDigs</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">>=</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">||</span><span class="NAME">g</span><span class="PUNC">>=</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">>=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">14</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>210</span> </span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">g</span><span class="PUNC">!=</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">i</span><span class="PUNC">></span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">++</span><span class="NAME">j</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">j</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersects</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.containsPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.intersects</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Geometry.LineString.prototype.intersects.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>211</span> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">intersects</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVertices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.components.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.components.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.Polygon</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">getArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getArea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getArea</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getGeodesicArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.components.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getGeodesicArea</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>212</span> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getGeodesicArea</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">containsPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">containsPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersects</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.containsPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>213</span> </span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.intersects</span><span class="PUNC">(</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.containsPoint</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.intersects</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.containsPoint</span><span class="PUNC">(</span><span class="NAME">e.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b.edge</span><span class="PUNC">&&</span><span class="NAME">this.intersects</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Geometry.Collection.prototype.distanceTo.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>214</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.Polygon.createRegularPolygon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LinearRing</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Polygon</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">div</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">type</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">allowSelection</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">displayClass</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">title</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">autoActivate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">active</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">handlerOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">handler</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">eventListeners</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">events</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.displayClass</span><span class="PUNC">=</span><span class="NAME">this.CLASS_NAME.replace</span><span class="PUNC">(</span><span class="STRN">"OpenLayers."</span><span class="PUNC">,</span><span class="STRN">"ol"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\./g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">)</span><span class="NAME">this.events.on</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.id</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>215</span> </span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.events</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">&&</span><span class="NAME">this.events.un</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.eventListeners</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.handler</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.handler.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.handlers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.handlers</span><span class="PUNC">)</span><span class="NAME">this.handlers.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.handlers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">&&</span><span class="NAME">this.handlers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.map.removeControl</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.handler</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>216</span> </span><span class="NAME">this.handler.setMap</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.div</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.div.className</span><span class="PUNC">=</span><span class="NAME">this.displayClass</span><span class="PUNC">,</span><span class="NAME">this.allowSelection</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.div.className</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">" olControlNoSelect"</span><span class="PUNC">,</span><span class="NAME">this.div.setAttribute</span><span class="PUNC">(</span><span class="STRN">"unselectable"</span><span class="PUNC">,</span><span class="STRN">"on"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.div.onselectstart</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.False</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">!=</span><span class="NAME">this.title</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.div.title</span><span class="PUNC">=</span><span class="NAME">this.title</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.div</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.div</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.div.style.left</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">this.div.style.top</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>217</span> </span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.handler</span><span class="PUNC">&&</span><span class="NAME">this.handler.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.active</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="NAME">this.displayClass.replace</span><span class="PUNC">(</span><span class="REGX">/ /g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"Active"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"activate"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.active</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.handler</span><span class="PUNC">&&</span><span class="NAME">this.handler.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.active</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="NAME">this.displayClass.replace</span><span class="PUNC">(</span><span class="REGX">/ /g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"Active"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"deactivate"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>218</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.TYPE_BUTTON</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.TYPE_TOGGLE</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.TYPE_TOOL</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">observers</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">KEY_SPACE</span><span class="PUNC">:</span><span class="NUMB">32</span><span class="PUNC">,</span><span class="NAME">KEY_BACKSPACE</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">KEY_TAB</span><span class="PUNC">:</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="NAME">KEY_RETURN</span><span class="PUNC">:</span><span class="NUMB">13</span><span class="PUNC">,</span><span class="NAME">KEY_ESC</span><span class="PUNC">:</span><span class="NUMB">27</span><span class="PUNC">,</span><span class="NAME">KEY_LEFT</span><span class="PUNC">:</span><span class="NUMB">37</span><span class="PUNC">,</span><span class="NAME">KEY_UP</span><span class="PUNC">:</span><span class="NUMB">38</span><span class="PUNC">,</span><span class="NAME">KEY_RIGHT</span><span class="PUNC">:</span><span class="NUMB">39</span><span class="PUNC">,</span><span class="NAME">KEY_DOWN</span><span class="PUNC">:</span><span class="NUMB">40</span><span class="PUNC">,</span><span class="NAME">KEY_DELETE</span><span class="PUNC">:</span><span class="NUMB">46</span><span class="PUNC">,</span><span class="NAME">element</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.target</span><span class="PUNC">||</span><span class="NAME">a.srcElement</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isSingleTouch</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.touches</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a.touches.length</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isMultiTouch</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.touches</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">a.touches.length</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isLeftClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.which</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a.which</span><span class="PUNC">||</span><span class="NAME">a.button</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a.button</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isRightClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.which</span><span class="PUNC">&&</span><span class="NUMB">3</span><span class="PUNC">==</span><span class="NAME">a.which</span><span class="PUNC">||</span><span class="NAME">a.button</span><span class="PUNC">&&</span><span class="NUMB">2</span><span class="PUNC">==</span><span class="NAME">a.button</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">stop</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>219</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.preventDefault</span><span class="PUNC">?</span><span class="NAME">a.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.returnValue</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.stopPropagation</span><span class="PUNC">?</span><span class="NAME">a.stopPropagation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.cancelBubble</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">findElement</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Event.element</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.parentNode</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c.tagName</span><span class="PUNC">||</span><span class="NAME">c.tagName.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">b.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.parentNode</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">observe</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"keypress"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">navigator.appVersion.match</span><span class="PUNC">(</span><span class="REGX">/Konqueror|Safari|KHTML/</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">a.attachEvent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"keydown"</span><span class="PUNC">;</span><span class="NAME">this.observers</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.observers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a._eventCacheID</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>220</span> </span><span class="STRN">"eventCacheID_"</span><span class="PUNC">;</span><span class="NAME">a.id</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.id</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a._eventCacheID</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a._eventCacheID</span><span class="PUNC">;</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.observers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">element</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">observer</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">useCapture</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.addEventListener</span><span class="PUNC">?</span><span class="NAME">a.addEventListener</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.attachEvent</span><span class="PUNC">&&</span><span class="NAME">a.attachEvent</span><span class="PUNC">(</span><span class="STRN">"on"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">stopObservingElement</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">_eventCacheID</span><span class="PUNC">;</span><span class="NAME">this._removeElementObservers</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">_removeElementObservers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="WHIT">
<span class='line'>221</span> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c.element</span><span class="PUNC">,</span><span class="NAME">c.name</span><span class="PUNC">,</span><span class="NAME">c.observer</span><span class="PUNC">,</span><span class="NAME">c.useCapture</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">stopObserving</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a._eventCacheID</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"keypress"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">navigator.appVersion.match</span><span class="PUNC">(</span><span class="REGX">/Konqueror|Safari|KHTML/</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">a.detachEvent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"keydown"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i.name</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">i.observer</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">i.useCapture</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.splice</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">g.length</span><span class="PUNC">&&</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>222</span> </span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.removeEventListener</span><span class="PUNC">?</span><span class="NAME">a.removeEventListener</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.detachEvent</span><span class="PUNC">&&</span><span class="NAME">a.detachEvent</span><span class="PUNC">(</span><span class="STRN">"on"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unloadCache</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">)</span><span class="NAME">OpenLayers.Event._removeElementObservers.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observers</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Event"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"unload"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.unloadCache</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>223</span> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">BROWSER_EVENTS</span><span class="PUNC">:</span><span class="STRN">"mouseover mouseout mousedown mouseup mousemove click dblclick rightclick dblrightclick resize focus blur touchstart touchmove touchend keydown"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">listeners</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">element</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">eventHandler</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">fallThrough</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">includeXY</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">extensions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">extensionCount</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">clearMouseListener</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.fallThrough</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.listeners</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.extensions</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.extensionCount</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>224</span> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.attachToElement</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.extensions</span><span class="PUNC">)</span><span class="STRN">"boolean"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.extensions</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">this.extensions</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.extensions</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.element</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">this.element</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.element.hasScrollEvent</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"scroll"</span><span class="PUNC">,</span><span class="NAME">this.clearMouseListener</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.eventHandler</span><span class="PUNC">=</span><span class="NAME">this.fallThrough</span><span class="PUNC">=</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="NAME">this.listeners</span><span class="PUNC">=</span><span class="NAME">this.element</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addEventType</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">attachToElement</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.element</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">this.element</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>225</span> </span><span class="PUNC">(</span><span class="NAME">this.eventHandler</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bindAsEventListener</span><span class="PUNC">(</span><span class="NAME">this.handleBrowserEvent</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.clearMouseListener</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.clearMouseCache</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.element</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.BROWSER_EVENTS.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.BROWSER_EVENTS</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.eventHandler</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"dragstart"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">on</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="STRN">"scope"</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.register</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.scope</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">register</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>226</span> </span><span class="PUNC">!</span><span class="NAME">this.extensions</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.extensions</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.object</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this.extensionCount</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">obj</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">e.splice</span><span class="PUNC">(</span><span class="NAME">this.extensionCount</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.extension</span><span class="PUNC">&&</span><span class="NAME">this.extensionCount</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">registerPriority</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.register</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">un</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="STRN">"scope"</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.unregister</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.scope</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unregister</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>227</span> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.object</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">obj</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">func</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">triggerEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">c.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.object</span><span class="PUNC">=</span><span class="NAME">this.object</span><span class="PUNC">;</span><span class="NAME">b.element</span><span class="PUNC">=</span><span class="NAME">this.element</span><span class="PUNC">;</span><span class="NAME">b.type</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b.type</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.func.apply</span><span class="PUNC">(</span><span class="NAME">d.obj</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fallThrough</span><span class="PUNC">||</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>228</span> </span><span class="NAME">handleBrowserEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.type</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.listeners</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">c.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.touches</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.clientX</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.clientY</span><span class="PUNC">;</span><span class="NAME">a.clientX</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">a.clientY</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">}</span><span class="NAME">this.includeXY</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">=</span><span class="NAME">this.getMousePosition</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.triggerEvent</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearMouseCache</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.element.scrolls</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.element.lefttop</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.body</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">a.scrollTop</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">a.scrollLeft</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">navigator.userAgent.match</span><span class="PUNC">(</span><span class="REGX">/iPhone/i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.element.offsets</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMousePosition</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.includeXY</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>229</span> </span><span class="NAME">this.element.hasScrollEvent</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"scroll"</span><span class="PUNC">,</span><span class="NAME">this.clearMouseListener</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.element.hasScrollEvent</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.clearMouseCache</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.element.scrolls</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getViewportElement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.element.scrolls</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">b.scrollLeft</span><span class="PUNC">,</span><span class="NAME">b.scrollTop</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="NAME">this.element.lefttop</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.element.lefttop</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">document.documentElement.clientLeft</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">document.documentElement.clientTop</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.element.offsets</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.element.offsets</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.pagePosition</span><span class="PUNC">(</span><span class="NAME">this.element</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NAME">a.clientX</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>230</span> </span><span class="NAME">this.element.scrolls</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">this.element.offsets</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">this.element.lefttop</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.clientY</span><span class="PUNC">+</span><span class="NAME">this.element.scrolls</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">this.element.offsets</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">this.element.lefttop</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Events"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">control</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">keyMask</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">active</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">evt</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.control</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.callbacks</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">||</span><span class="NAME">a.map</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.setMap</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">checkModifiers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.keyMask</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.shiftKey</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Handler.MOD_SHIFT</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="PUNC">(</span><span class="NAME">a.ctrlKey</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Handler.MOD_CTRL</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="PUNC">(</span><span class="NAME">a.altKey</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Handler.MOD_ALT</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="PUNC">(</span><span class="NAME">a.metaKey</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>231</span> </span><span class="NAME">OpenLayers.Handler.MOD_META</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">this.keyMask</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Events.prototype.BROWSER_EVENTS</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">this.register</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.active</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.active</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Events.prototype.BROWSER_EVENTS</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">this.unregister</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.active</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.callbacks</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">this.callbacks</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">this.control</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>232</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">register</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.events.registerPriority</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.events.registerPriority</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.setEvent</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unregister</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.events.unregister</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.events.unregister</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.setEvent</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.evt</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.control</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.MOD_NONE</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.MOD_SHIFT</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.MOD_CTRL</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.MOD_ALT</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>233</span> </span><span class="NAME">OpenLayers.Handler.MOD_META</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.Hover</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">delay</span><span class="PUNC">:</span><span class="NUMB">500</span><span class="PUNC">,</span><span class="NAME">pixelTolerance</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">stopMove</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">px</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">timerId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">mousemove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.passesTolerance</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.px</span><span class="PUNC">=</span><span class="NAME">a.xy</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.timerId</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.delayedCall</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.delay</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">this.stopMove</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseout</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.mouseLeft</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>234</span> </span><span class="NAME">passesTolerance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.pixelTolerance</span><span class="PUNC">&&</span><span class="NAME">this.px</span><span class="PUNC">&&</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.px.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.px.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">this.pixelTolerance</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearTimer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.timerId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.timerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.timerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">delayedCall</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"pause"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.Hover"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.Click</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">delay</span><span class="PUNC">:</span><span class="NUMB">300</span><span class="PUNC">,</span><span class="NAME">single</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="STRN">"double"</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">pixelTolerance</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">dblclickTolerance</span><span class="PUNC">:</span><span class="NUMB">13</span><span class="PUNC">,</span><span class="NAME">stopSingle</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">stopDouble</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">timerId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">touch</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">down</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">last</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">first</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">rightclickTimerId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">touchstart</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.touch</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.unregisterMouseListeners</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.touch</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.down</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchmove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchend</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.down</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">=</span><span class="NAME">this.last.xy</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>235</span> </span><span class="NAME">a.lastTouches</span><span class="PUNC">=</span><span class="NAME">this.last.touches</span><span class="PUNC">,</span><span class="NAME">this.handleSingle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.down</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unregisterMouseListeners</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="NAME">this.mousedown</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="NAME">this.mouseup</span><span class="PUNC">,</span><span class="NAME">click</span><span class="PUNC">:</span><span class="NAME">this.click</span><span class="PUNC">,</span><span class="NAME">dblclick</span><span class="PUNC">:</span><span class="NAME">this.dblclick</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.down</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.checkModifiers</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.control.handleRightClicks</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.isRightClick</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.rightclick</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rightclick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.passesTolerance</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>236</span> </span><span class="NAME">this.rightclickTimerId</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"dblrightclick"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NAME">this.stopDouble</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="STRN">"double"</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"rightclick"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.delayedRightCall</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rightclickTimerId</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.delay</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">this.stopSingle</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">delayedRightCall</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rightclickTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"rightclick"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">click</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.last</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handleSingle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">this.stopSingle</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>237</span> </span><span class="NAME">dblclick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleDouble</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">this.stopDouble</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleDouble</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.passesDblclickTolerance</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="STRN">"double"</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"dblclick"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleSingle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.passesTolerance</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.timerId</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.last.touches</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.last.touches.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="STRN">"double"</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handleDouble</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.last.touches</span><span class="PUNC">||</span><span class="NUMB">2</span><span class="PUNC">!==</span><span class="NAME">this.last.touches.length</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.first</span><span class="PUNC">=</span><span class="NAME">this.getEventInfo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.queuePotentialClick</span><span class="PUNC">(</span><span class="NAME">this.single</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>238</span> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">queuePotentialClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.timerId</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.delayedCall</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.delay</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">passesTolerance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.pixelTolerance</span><span class="PUNC">&&</span><span class="NAME">this.down</span><span class="PUNC">&&</span><span class="NAME">this.down.xy</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.pixelTolerance</span><span class="PUNC">>=</span><span class="NAME">this.down.xy.distanceTo</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.touch</span><span class="PUNC">&&</span><span class="NAME">this.down.touches.length</span><span class="PUNC">===</span><span class="NAME">this.last.touches.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.down.touches.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getTouchDistance</span><span class="PUNC">(</span><span class="NAME">this.down.touches</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.last.touches</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">this.pixelTolerance</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>239</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTouchDistance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">a.clientX</span><span class="PUNC">-</span><span class="NAME">b.clientX</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">a.clientY</span><span class="PUNC">-</span><span class="NAME">b.clientY</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">passesDblclickTolerance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.down</span><span class="PUNC">&&</span><span class="NAME">this.first</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.down.xy.distanceTo</span><span class="PUNC">(</span><span class="NAME">this.first.xy</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">this.dblclickTolerance</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearTimer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.timerId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.timerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.timerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.rightclickTimerId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.rightclickTimerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.rightclickTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">delayedCall</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.timerId</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>240</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getEventInfo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.touches</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.touches.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.touches</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">clientX</span><span class="PUNC">:</span><span class="NAME">d.clientX</span><span class="PUNC">,</span><span class="NAME">clientY</span><span class="PUNC">:</span><span class="NAME">d.clientY</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">xy</span><span class="PUNC">:</span><span class="NAME">a.xy</span><span class="PUNC">,</span><span class="NAME">touches</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.clearTimer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.first</span><span class="PUNC">=</span><span class="NAME">this.down</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.touch</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.Click"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.UTFGrid</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">autoActivate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">defaultHandlerOptions</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">delay</span><span class="PUNC">:</span><span class="NUMB">300</span><span class="PUNC">,</span><span class="NAME">pixelTolerance</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">stopMove</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">single</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="STRN">"double"</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">stopSingle</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">stopDouble</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handlerMode</span><span class="PUNC">:</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="NAME">setHandler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handlerMode</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.resetHandler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resetHandler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handler</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.handler.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handler.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"hover"</span><span class="PUNC">==</span><span class="NAME">this.handlerMode</span><span class="PUNC">?</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Hover</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">pause</span><span class="PUNC">:</span><span class="NAME">this.handleEvent</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="NAME">this.reset</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>241</span> </span><span class="NAME">this.handlerOptions</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"click"</span><span class="PUNC">==</span><span class="NAME">this.handlerMode</span><span class="PUNC">?</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Click</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">click</span><span class="PUNC">:</span><span class="NAME">this.handleEvent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.handlerOptions</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"move"</span><span class="PUNC">==</span><span class="NAME">this.handlerMode</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Hover</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">pause</span><span class="PUNC">:</span><span class="NAME">this.handleEvent</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="NAME">this.handleEvent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.handlerOptions</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handler</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.handlerOptions</span><span class="PUNC">=</span><span class="NAME">a.handlerOptions</span><span class="PUNC">||</span><span class="NAME">this.defaultHandlerOptions</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.resetHandler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>242</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.reset</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.findLayers</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.map.layers</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e.getFeatureInfo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">reset</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">findLayers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">||</span><span class="NAME">this.map.layers</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.UTFGrid</span><span class="PUNC">&&</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.UTFGrid"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">proj</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">projCode</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">titleRegEx</span><span class="PUNC">:</span><span class="REGX">/\+title=[^\+]*/</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.projCode</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">window.Proj4js</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.proj</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Proj4js.Proj</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.proj</span><span class="PUNC">?</span><span class="NAME">this.proj.srsCode</span><span class="PUNC">:</span><span class="NAME">this.projCode</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getUnits</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.proj</span><span class="PUNC">?</span><span class="NAME">this.proj.units</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">window.Proj4js</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>243</span> </span><span class="NAME">this.proj.defData</span><span class="PUNC">&&</span><span class="NAME">a.proj.defData</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.proj.defData.replace</span><span class="PUNC">(</span><span class="NAME">this.titleRegEx</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">a.proj.defData.replace</span><span class="PUNC">(</span><span class="NAME">this.titleRegEx</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.getCode</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">===</span><span class="NAME">OpenLayers.Projection.nullTransform</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.proj</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.projCode</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Projection"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>244</span> </span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">units</span><span class="PUNC">:</span><span class="STRN">"degrees"</span><span class="PUNC">,</span><span class="NAME">maxExtent</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">180</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">180</span><span class="PUNC">,</span><span class="NUMB">90</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">yx</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">"CRS:84"</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">units</span><span class="PUNC">:</span><span class="STRN">"degrees"</span><span class="PUNC">,</span><span class="NAME">maxExtent</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">180</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">180</span><span class="PUNC">,</span><span class="NUMB">90</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">units</span><span class="PUNC">:</span><span class="STRN">"m"</span><span class="PUNC">,</span><span class="NAME">maxExtent</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">2.003750834</span><span class="NAME">E7</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">2.003750834</span><span class="NAME">E7</span><span class="PUNC">,</span><span class="NUMB">2.003750834</span><span class="NAME">E7</span><span class="PUNC">,</span><span class="NUMB">2.003750834</span><span class="NAME">E7</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>245</span> </span><span class="NAME">OpenLayers.Projection.addTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">OpenLayers.Projection.nullTransform</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>246</span> </span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.proj</span><span class="PUNC">&&</span><span class="NAME">c.proj</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Proj4js.transform</span><span class="PUNC">(</span><span class="NAME">b.proj</span><span class="PUNC">,</span><span class="NAME">c.proj</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transforms</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Projection.nullTransform</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>247</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.x</span><span class="PUNC">=</span><span class="NUMB">180</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">=</span><span class="NUMB">180</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.atan</span><span class="PUNC">(</span><span class="NAME">Math.exp</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">=</span><span class="NAME">Math.log</span><span class="PUNC">(</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">360</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.addTransform</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.nullTransform</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">q</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">2.003750834</span><span class="NAME">E7</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">,</span><span class="STRN">"EPSG:3857"</span><span class="PUNC">,</span><span class="STRN">"EPSG:102113"</span><span class="PUNC">,</span><span class="STRN">"EPSG:102100"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"CRS:84"</span><span class="PUNC">,</span><span class="STRN">"urn:ogc:def:crs:EPSG:6.6:4326"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>248</span> </span><span class="STRN">"EPSG:4326"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Map</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">Z_INDEX_BASE</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">BaseLayer</span><span class="PUNC">:</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">Overlay</span><span class="PUNC">:</span><span class="NUMB">325</span><span class="PUNC">,</span><span class="NAME">Feature</span><span class="PUNC">:</span><span class="NUMB">725</span><span class="PUNC">,</span><span class="NAME">Popup</span><span class="PUNC">:</span><span class="NUMB">750</span><span class="PUNC">,</span><span class="NAME">Control</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">fractionalZoom</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">events</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">allOverlays</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">div</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">viewPortDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layerContainerOrigin</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layerContainerDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">controls</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">popups</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">baseLayer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">center</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">resolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">panRatio</span><span class="PUNC">:</span><span class="NUMB">1.5</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">tileSize</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">projection</span><span class="PUNC">:</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">,</span><span class="NAME">units</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">resolutions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maxResolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minResolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maxScale</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minScale</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>249</span> </span><span class="NAME">maxExtent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minExtent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">restrictedExtent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">numZoomLevels</span><span class="PUNC">:</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NAME">theme</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">displayProjection</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">fallThrough</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">panTween</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">eventListeners</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">panMethod</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Easing.Expo.easeOut</span><span class="PUNC">,</span><span class="NAME">panDuration</span><span class="PUNC">:</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NAME">paddingForPopups</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minPx</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maxPx</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">arguments.length</span><span class="PUNC">&&</span><span class="STRN">"object"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileSize</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Map.TILE_WIDTH</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Map.TILE_HEIGHT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.paddingForPopups</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NUMB">15</span><span class="PUNC">,</span><span class="NUMB">15</span><span class="PUNC">,</span><span class="NUMB">15</span><span class="PUNC">,</span><span class="NUMB">15</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.theme</span><span class="PUNC">=</span><span class="NAME">OpenLayers._getScriptLocation</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>250</span> </span><span class="STRN">"theme/default/style.css"</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">[</span><span class="NAME">this.projection</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">?</span><span class="NAME">this.projection.projCode</span><span class="PUNC">:</span><span class="NAME">this.projection</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.maxExtent</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.maxExtent</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.maxExtent</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.maxExtent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.minExtent</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.minExtent</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.minExtent</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.minExtent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>251</span> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.restrictedExtent</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.center</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layers</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Map_"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.div.style.height</span><span class="PUNC">=</span><span class="STRN">"1px"</span><span class="PUNC">,</span><span class="NAME">this.div.style.width</span><span class="PUNC">=</span><span class="STRN">"1px"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">,</span><span class="STRN">"olMap"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>252</span> </span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_OpenLayers_ViewPort"</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"relative"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"hidden"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv.style.height</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv.className</span><span class="PUNC">=</span><span class="STRN">"olMapViewport"</span><span class="PUNC">;</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.fallThrough</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">includeXY</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_OpenLayers_Container"</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.width</span><span class="PUNC">=</span><span class="STRN">"100px"</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.height</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>253</span> </span><span class="STRN">"100px"</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.zIndex</span><span class="PUNC">=</span><span class="NAME">this.Z_INDEX_BASE.Popup</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">)</span><span class="NAME">this.events.on</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">9</span><span class="PUNC">></span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">navigator.appVersion.split</span><span class="PUNC">(</span><span class="STRN">"MSIE"</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.events.register</span><span class="PUNC">(</span><span class="STRN">"resize"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.updateSize</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.updateSizeDestroy</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.updateSize</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"resize"</span><span class="PUNC">,</span><span class="NAME">this.updateSizeDestroy</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.theme</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"link"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>254</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.isEquivalentUrl</span><span class="PUNC">(</span><span class="NAME">d.item</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">href</span><span class="PUNC">,</span><span class="NAME">this.theme</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"link"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setAttribute</span><span class="PUNC">(</span><span class="STRN">"rel"</span><span class="PUNC">,</span><span class="STRN">"stylesheet"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setAttribute</span><span class="PUNC">(</span><span class="STRN">"type"</span><span class="PUNC">,</span><span class="STRN">"text/css"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setAttribute</span><span class="PUNC">(</span><span class="STRN">"href"</span><span class="PUNC">,</span><span class="NAME">this.theme</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"head"</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.controls</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.controls</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control.Navigation</span><span class="PUNC">?</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.Navigation</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Control.TouchNavigation</span><span class="PUNC">&&</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.TouchNavigation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>255</span> </span><span class="NAME">OpenLayers.Control.Zoom</span><span class="PUNC">?</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.Zoom</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Control.PanZoom</span><span class="PUNC">&&</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.PanZoom</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Control.ArgParser</span><span class="PUNC">&&</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.ArgParser</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Control.Attribution</span><span class="PUNC">&&</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.Attribution</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.controls.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.addControlToMap</span><span class="PUNC">(</span><span class="NAME">this.controls</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.popups</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.unloadDestroy</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.destroy</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>256</span> </span><span class="STRN">"unload"</span><span class="PUNC">,</span><span class="NAME">this.unloadDestroy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.layers</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.center</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.zoom</span><span class="PUNC">,</span><span class="NAME">this.addLayers</span><span class="PUNC">(</span><span class="NAME">b.layers</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.center</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.setCenter</span><span class="PUNC">(</span><span class="NAME">b.center</span><span class="PUNC">,</span><span class="NAME">b.zoom</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getViewport</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.viewPortDiv</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">render</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">,</span><span class="STRN">"olMap"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unloadDestroy</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">updateSizeDestroy</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.unloadDestroy</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>257</span> </span><span class="NAME">this.panTween</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.panTween.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.panTween</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"unload"</span><span class="PUNC">,</span><span class="NAME">this.unloadDestroy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.unloadDestroy</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.updateSizeDestroy</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"resize"</span><span class="PUNC">,</span><span class="NAME">this.updateSizeDestroy</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.events.unregister</span><span class="PUNC">(</span><span class="STRN">"resize"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.updateSize</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.paddingForPopups</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.controls</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.controls.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.controls</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.controls</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.layers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> </span><span class="NAME">this.layers</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">&&</span><span class="NAME">this.div.removeChild</span><span class="PUNC">(</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.eventListeners</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.events.un</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.eventListeners</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setOptions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.minPx</span><span class="PUNC">&&</span><span class="NAME">a.restrictedExtent</span><span class="PUNC">!=</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.zoom</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">forceZoomChange</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTileSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.tileSize</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getBy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>259</span> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c.test</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Array.filter</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">c.test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayersBy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getBy</span><span class="PUNC">(</span><span class="STRN">"layers"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayersByName</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getLayersBy</span><span class="PUNC">(</span><span class="STRN">"name"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayersByClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getLayersBy</span><span class="PUNC">(</span><span class="STRN">"CLASS_NAME"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getControlsBy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getBy</span><span class="PUNC">(</span><span class="STRN">"controls"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getControlsByClass</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getControlsBy</span><span class="PUNC">(</span><span class="STRN">"CLASS_NAME"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>260</span> </span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.id</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setLayerZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.setZIndex</span><span class="PUNC">(</span><span class="NAME">this.Z_INDEX_BASE</span><span class="PUNC">[</span><span class="NAME">a.isBaseLayer</span><span class="PUNC">?</span><span class="STRN">"BaseLayer"</span><span class="PUNC">:</span><span class="STRN">"Overlay"</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resetLayersZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.setLayerZIndex</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"preaddlayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.allOverlays</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.isBaseLayer</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.div.className</span><span class="PUNC">=</span><span class="STRN">"olLayerDiv"</span><span class="PUNC">;</span><span class="NAME">a.div.style.overflow</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>261</span> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.setLayerZIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.layers.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.isFixed</span><span class="PUNC">?</span><span class="NAME">this.viewPortDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.layerContainerDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layers.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setMap</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.isBaseLayer</span><span class="PUNC">||</span><span class="NAME">this.allOverlays</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.baseLayer</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.baseLayer</span><span class="PUNC">?</span><span class="NAME">this.setBaseLayer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.setVisibility</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"addlayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"added"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.afterAdd</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addLayers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.addLayer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>262</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"preremovelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.isFixed</span><span class="PUNC">?</span><span class="NAME">this.viewPortDiv.removeChild</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.layerContainerDiv.removeChild</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.removeMap</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.baseLayer</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.baseLayer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.isBaseLayer</span><span class="PUNC">||</span><span class="NAME">this.allOverlays</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setBaseLayer</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.resetLayersZIndex</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"removelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"removed"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>263</span> </span><span class="PUNC">{</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNumLayers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.layers.length</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayerIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setLayerIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getLayerIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">></span><span class="NAME">this.layers.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layers.splice</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layers.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.setLayerZIndex</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"order"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.allOverlays</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">this.setBaseLayer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>264</span> </span><span class="NAME">this.baseLayer</span><span class="PUNC">!==</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">this.setBaseLayer</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">raiseLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getLayerIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.setLayerIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setBaseLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">this.getScale</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.units</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.allOverlays</span><span class="PUNC">&&</span><span class="NAME">this.baseLayer.setVisibility</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.baseLayer</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.allOverlays</span><span class="PUNC">||</span><span class="NAME">this.baseLayer.visibility</span><span class="PUNC">)</span><span class="NAME">this.baseLayer.setVisibility</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>265</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.baseLayer.inRange</span><span class="PUNC">&&</span><span class="NAME">this.baseLayer.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">this.resolution</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setCenter</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changebaselayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">this.baseLayer</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addControl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.controls.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addControlToMap</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addControls</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">arguments.length</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.addControl</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addControlToMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.outsideViewport</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.div</span><span class="PUNC">;</span><span class="NAME">this.displayProjection</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.displayProjection</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>266</span> </span><span class="PUNC">(</span><span class="NAME">a.displayProjection</span><span class="PUNC">=</span><span class="NAME">this.displayProjection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setMap</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.draw</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.outsideViewport</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.style.zIndex</span><span class="PUNC">=</span><span class="NAME">this.Z_INDEX_BASE.Control</span><span class="PUNC">+</span><span class="NAME">this.controls.length</span><span class="PUNC">,</span><span class="NAME">this.viewPortDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.autoActivate</span><span class="PUNC">&&</span><span class="NAME">a.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getControl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.controls.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.controls</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.id</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeControl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">this.getControl</span><span class="PUNC">(</span><span class="NAME">a.id</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">&&</span><span class="NAME">a.div.parentNode</span><span class="PUNC">==</span><span class="NAME">this.viewPortDiv</span><span class="PUNC">&&</span><span class="NAME">this.viewPortDiv.removeChild</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.controls</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>267</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addPopup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.popups.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">this.removePopup</span><span class="PUNC">(</span><span class="NAME">this.popups</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.popups.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">c.style.zIndex</span><span class="PUNC">=</span><span class="NAME">this.Z_INDEX_BASE.Popup</span><span class="PUNC">+</span><span class="NAME">this.popups.length</span><span class="PUNC">,</span><span class="NAME">this.layerContainerDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removePopup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.popups</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">this.layerContainerDiv.removeChild</span><span class="PUNC">(</span><span class="NAME">a.div</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.size</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.size.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getCurrentSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>268</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.events.clearMouseCache</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a.equals</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">onMapResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.zoom</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.setCenter</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCurrentSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">this.div.clientWidth</span><span class="PUNC">,</span><span class="NAME">this.div.clientHeight</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.w</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.h</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">a.w</span><span class="PUNC">=</span><span class="NAME">this.div.offsetWidth</span><span class="PUNC">,</span><span class="NAME">a.h</span><span class="PUNC">=</span><span class="NAME">this.div.offsetHeight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.w</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.h</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">a.w</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.width</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.h</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.size.w</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.size.h</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCenter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCachedCenter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NAME">this.center</span><span class="PUNC">&&</span><span class="NAME">this.size</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>270</span> </span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.size.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.size.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.center</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.zoom</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">pan</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">animate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.dragging</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.moveByPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.dragging</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">a.equals</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.animate</span><span class="PUNC">?</span><span class="NAME">this.panTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.dragging</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"moveend"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>271</span> </span><span class="NAME">panTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.panMethod</span><span class="PUNC">&&</span><span class="NAME">this.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NAME">this.panRatio</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">containsLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.panTween</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.panTween</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Tween</span><span class="PUNC">(</span><span class="NAME">this.panMethod</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a.equals</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getPixelFromLonLat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getPixelFromLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.panTween.start</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.panDuration</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">callbacks</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">eachStep</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.moveByPx</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">done</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"moveend"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.setCenter</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCenter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.panTween</span><span class="PUNC">&&</span><span class="NAME">this.panTween.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">forceZoomChange</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveByPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.size.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.size.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.wrapDateLine</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">this.maxPx.x</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">>=</span><span class="NAME">this.minPx.x</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">this.maxPx.y</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">>=</span><span class="NAME">this.minPx.y</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">?</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dragging</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>273</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"movestart"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">this.minPx.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.maxPx.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">this.minPx.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.maxPx.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.visibility</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">this.baseLayer</span><span class="PUNC">||</span><span class="NAME">c.inRange</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">c.moveByPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">adjustZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>274</span> </span><span class="NAME">this.baseLayer.resolutions</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.size.w</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.fractionalZoom</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.baseLayer.wrapDateLine</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.adjustZoom</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.dragging</span><span class="PUNC">||</span><span class="NAME">this.dragging</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.forceZoomChange</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>275</span> </span><span class="PUNC">!</span><span class="NAME">this.isValidLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.maxExtent.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.calculateBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.restrictedExtent.containsBounds</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.restrictedExtent.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">this.restrictedExtent.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">g.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.left</span><span class="PUNC">&lt;</span><span class="NAME">this.restrictedExtent.left</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">this.restrictedExtent.left</span><span class="PUNC">-</span><span class="NAME">f.left</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.right</span><span class="PUNC">></span><span class="NAME">this.restrictedExtent.right</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>276</span> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">this.restrictedExtent.right</span><span class="PUNC">-</span><span class="NAME">f.right</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">></span><span class="NAME">this.restrictedExtent.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">g.lat</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.bottom</span><span class="PUNC">&lt;</span><span class="NAME">this.restrictedExtent.bottom</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.restrictedExtent.bottom</span><span class="PUNC">-</span><span class="NAME">f.bottom</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.top</span><span class="PUNC">></span><span class="NAME">this.restrictedExtent.top</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.restrictedExtent.top</span><span class="PUNC">-</span><span class="NAME">f.top</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">this.isValidZoomLevel</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">!=</span><span class="NAME">this.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.isValidLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.equals</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"movestart"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">this.center</span><span class="PUNC">&&</span><span class="NAME">this.centerLayerContainer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>277</span> </span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">this.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.layerContainerOrigin</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layerContainerOrigin</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">=</span><span class="STRN">"0px"</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">=</span><span class="STRN">"0px"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">restricted</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.center.lon</span><span class="PUNC">-</span><span class="NAME">h.lon</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h.lat</span><span class="PUNC">-</span><span class="NAME">this.center.lat</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">f.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">f.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.minPx</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.size.w</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.size.h</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.maxPx</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.minPx.x</span><span class="PUNC">+</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">f.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>278</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.minPx.y</span><span class="PUNC">+</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">f.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.zoom</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.resolution</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.baseLayer.visibility</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.baseLayer.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c.dragging</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.dragging</span><span class="PUNC">||</span><span class="NAME">this.baseLayer.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"moveend"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">zoomChanged</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layers.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">!==</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">f.isBaseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.calculateInRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.inRange</span><span class="PUNC">!=</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f.inRange</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">f.display</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"visibility"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>279</span> </span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">f.visibility</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">f.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c.dragging</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.dragging</span><span class="PUNC">||</span><span class="NAME">f.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"moveend"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">zoomChanged</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"moveend"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.popups.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.popups</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">updatePosition</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"zoomend"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">centerLayerContainer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">this.layerContainerOrigin</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>280</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">-</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.minPx.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.maxPx.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.minPx.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.maxPx.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isValidZoomLevel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.getNumZoomLevels</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isValidLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.containsLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">worldBounds</span><span class="PUNC">:</span><span class="NAME">this.baseLayer.wrapDateLine</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getProjection</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getProjectionObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>281</span> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getProjectionObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.projection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMaxResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.maxResolution</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMaxExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.restricted</span><span class="PUNC">&&</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.restrictedExtent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.maxExtent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNumZoomLevels</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.numZoomLevels</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>282</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.allOverlays</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.layers.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getUnits</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.units</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getScale</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getScaleFromResolution</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.baseLayer.units</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZoomForExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>283</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getZoomForExtent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolutionForZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZoomForResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isValidZoomLevel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.setCenter</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomIn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomTo</span><span class="PUNC">(</span><span class="NAME">this.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomOut</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomTo</span><span class="PUNC">(</span><span class="NAME">this.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomToExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>284</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.baseLayer.wrapDateLine</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.right</span><span class="PUNC">&lt;</span><span class="NAME">a.left</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">a.right</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">wrapDateLine</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.setCenter</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.getZoomForExtent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomToMaxExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomToExtent</span><span class="PUNC">(</span><span class="NAME">this.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">restricted</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a.restricted</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomToScale</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.baseLayer.units</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.size.w</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.size.h</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>285</span> </span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomToExtent</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">e.lon</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e.lat</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e.lon</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e.lat</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLonLatFromViewPortPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getViewPortPxFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.baseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.baseLayer.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLonLatFromPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getPixelFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>286</span> </span><span class="NAME">a.y</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getGeodesicPixelSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.getLonLatFromPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.add</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.add</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.add</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.add</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getProjectionObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">f.equals</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.transform</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.transform</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.transform</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.transform</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.distVincenty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.distVincenty</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getViewPortPxFromLayerPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>287</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayerPxFromViewPortPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.layerContainerDiv.style.top</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLonLatFromLayerPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getViewPortPxFromLayerPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLayerPxFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getLayerPxFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">this.getPixelFromLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>288</span> </span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Map"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Map.TILE_WIDTH</span><span class="PUNC">=</span><span class="NUMB">256</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Map.TILE_HEIGHT</span><span class="PUNC">=</span><span class="NUMB">256</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">div</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">alwaysInRange</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">RESOLUTION_PROPERTIES</span><span class="PUNC">:</span><span class="STRN">"scales resolutions maxScale minScale maxResolution minResolution numZoomLevels maxZoomLevel"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">events</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">alpha</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">displayInLayerSwitcher</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">visibility</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">attribution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">inRange</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">imageSize</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">eventListeners</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">gutter</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">projection</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">units</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">scales</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">resolutions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maxExtent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minExtent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maxResolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minResolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>289</span> </span><span class="NAME">numZoomLevels</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minScale</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maxScale</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">displayOutsideMaxExtent</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">wrapDateLine</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">metadata</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.metadata</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.alwaysInRange</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.alwaysInRange</span><span class="PUNC">=</span><span class="NAME">this.alwaysInRange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addOptions</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.id</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="NAME">this.CLASS_NAME</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.div.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">this.div.style.height</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">this.div.dir</span><span class="PUNC">=</span><span class="STRN">"ltr"</span><span class="PUNC">,</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>290</span> </span><span class="NAME">this.div</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.eventListeners</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.events.on</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.removeLayer</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">this.div</span><span class="PUNC">=</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="NAME">this.projection</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">&&</span><span class="NAME">this.events.un</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="NAME">this.eventListeners</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>291</span> </span><span class="NAME">getOptions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setName</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.name</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"name"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addOptions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.options</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a.projection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.projection</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="NAME">a.projection</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.projection</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">[</span><span class="NAME">a.projection.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.maxExtent</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a.maxExtent</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>292</span> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.maxExtent</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.maxExtent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.minExtent</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a.minExtent</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">a.minExtent</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.minExtent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">this.options</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.projection</span><span class="PUNC">&&</span><span class="NAME">this.projection.getUnits</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.units</span><span class="PUNC">=</span><span class="NAME">this.projection.getUnits</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.RESOLUTION_PROPERTIES.concat</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="STRN">"projection"</span><span class="PUNC">,</span><span class="STRN">"units"</span><span class="PUNC">,</span><span class="STRN">"minExtent"</span><span class="PUNC">,</span><span class="STRN">"maxExtent"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>293</span> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.initResolutions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">===</span><span class="KEYW">this</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.map.setCenter</span><span class="PUNC">(</span><span class="NAME">this.map.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.map.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changebaselayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onMapResize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">redraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.inRange</span><span class="PUNC">=</span><span class="NAME">this.calculateInRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.inRange</span><span class="PUNC">&&</span><span class="NAME">this.visibility</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"moveend"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">zoomChanged</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.visibility</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> </span><span class="NAME">this.isBaseLayer</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.inRange</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.display</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveByPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.maxExtent</span><span class="PUNC">=</span><span class="NAME">this.maxExtent</span><span class="PUNC">||</span><span class="NAME">this.map.maxExtent</span><span class="PUNC">,</span><span class="NAME">this.minExtent</span><span class="PUNC">=</span><span class="NAME">this.minExtent</span><span class="PUNC">||</span><span class="NAME">this.map.minExtent</span><span class="PUNC">,</span><span class="NAME">this.projection</span><span class="PUNC">=</span><span class="NAME">this.projection</span><span class="PUNC">||</span><span class="NAME">this.map.projection</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.projection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.projection</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="NAME">this.projection</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">=</span><span class="NAME">this.projection.getUnits</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.units</span><span class="PUNC">||</span><span class="NAME">this.map.units</span><span class="PUNC">,</span><span class="NAME">this.initResolutions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.isBaseLayer</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.inRange</span><span class="PUNC">=</span><span class="NAME">this.calculateInRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>295</span> </span><span class="NAME">this.div.style.display</span><span class="PUNC">=</span><span class="NAME">this.visibility</span><span class="PUNC">&&</span><span class="NAME">this.inRange</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setTileSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">afterAdd</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getImageSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.imageSize</span><span class="PUNC">||</span><span class="NAME">this.tileSize</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setTileSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.tileSize</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">this.tileSize</span><span class="PUNC">?</span><span class="NAME">this.tileSize</span><span class="PUNC">:</span><span class="NAME">this.map.getTileSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.gutter</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.imageSize</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.gutter</span><span class="PUNC">,</span><span class="NAME">a.h</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.gutter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getVisibility</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.visibility</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setVisibility</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.visibility</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.visibility</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.display</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>296</span> </span><span class="NAME">this.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"visibility"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"visibilitychanged"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="PUNC">(</span><span class="STRN">"none"</span><span class="PUNC">!=</span><span class="NAME">this.div.style.display</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.div.style.display</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.calculateInRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"block"</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateInRange</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.alwaysInRange</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">this.minResolution</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">this.maxResolution</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setIsBaseLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.isBaseLayer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.isBaseLayer</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>297</span> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changebaselayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initResolutions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.RESOLUTION_PROPERTIES.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.RESOLUTION_PROPERTIES</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.options.alwaysInRange</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.alwaysInRange</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d.resolutions</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.resolutions</span><span class="PUNC">=</span><span class="NAME">this.resolutionsFromScales</span><span class="PUNC">(</span><span class="NAME">d.scales</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d.resolutions</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.resolutions</span><span class="PUNC">=</span><span class="NAME">this.calculateResolutions</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d.resolutions</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.RESOLUTION_PROPERTIES.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>298</span> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.RESOLUTION_PROPERTIES</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.map</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d.resolutions</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.resolutions</span><span class="PUNC">=</span><span class="NAME">this.resolutionsFromScales</span><span class="PUNC">(</span><span class="NAME">d.scales</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d.resolutions</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.resolutions</span><span class="PUNC">=</span><span class="NAME">this.calculateResolutions</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.options.maxResolution</span><span class="PUNC">&&</span><span class="STRN">"auto"</span><span class="PUNC">!==</span><span class="NAME">this.options.maxResolution</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.options.maxResolution</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.options.minScale</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">this.options.minScale</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.options.minResolution</span><span class="PUNC">&&</span><span class="STRN">"auto"</span><span class="PUNC">!==</span><span class="NAME">this.options.minResolution</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>299</span> </span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.options.minResolution</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.options.maxScale</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">this.options.maxScale</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.resolutions</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.resolutions.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.resolutions</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.resolutions</span><span class="PUNC">[</span><span class="NAME">d.resolutions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.resolutions</span><span class="PUNC">=</span><span class="NAME">d.resolutions</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.resolutions.length</span><span class="PUNC">;</span><span class="NAME">this.scales</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.scales</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getScaleFromResolution</span><span class="PUNC">(</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.numZoomLevels</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.minResolution</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">this.maxScale</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>300</span> </span><span class="NAME">OpenLayers.Util.getScaleFromResolution</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.maxResolution</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="NAME">this.minScale</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getScaleFromResolution</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resolutionsFromScales</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateResolutions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.maxResolution</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.minScale</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">a.minScale</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"auto"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.maxExtent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>301</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.maxExtent.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.maxExtent.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b.h</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.minResolution</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.maxScale</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getResolutionFromScale</span><span class="PUNC">(</span><span class="NAME">a.maxScale</span><span class="PUNC">,</span><span class="NAME">this.units</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"auto"</span><span class="PUNC">==</span><span class="NAME">a.minResolution</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.minExtent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.minExtent.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.minExtent.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b.h</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"number"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"number"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.maxExtent</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getTileSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.maxExtent.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d.w</span><span class="PUNC">,</span><span class="NAME">this.maxExtent.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.maxZoomLevel</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>302</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.numZoomLevels</span><span class="PUNC">;</span><span class="STRN">"number"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">&&</span><span class="STRN">"number"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">Math.log</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">Math.log</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="STRN">"number"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="STRN">"number"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="STRN">"number"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="STRN">"number"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">&&</span><span class="STRN">"number"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"number"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>303</span> </span><span class="NAME">getExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.map.calculateBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZoomForExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c.w</span><span class="PUNC">,</span><span class="NAME">a.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c.h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getDataExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolutionForZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.resolutions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map.fractionalZoom</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZoomForResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>304</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map.fractionalZoom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">this.resolutions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.resolutions.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">>=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.resolutions.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLonLatFromViewPortPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>305</span> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">c.minPx</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">restricted</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">c.minPx.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">d.left</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">c.minPx.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">d.top</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wrapDateLine</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">this.maxExtent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getViewPortPxFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.calculateBounds</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">-</span><span class="NAME">c.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c.top</span><span class="PUNC">-</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setOpacity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.opacity</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.opacity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.div.childNodes</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>306</span> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">firstChild</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">lastChild</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="STRN">"iframe"</span><span class="PUNC">===</span><span class="NAME">f.nodeName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.parentNode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"opacity"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.div.style.zIndex</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.div.style.zIndex</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">adjustBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.gutter</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.gutter</span><span class="PUNC">*</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.bottom</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.right</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>307</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.top</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wrapDateLine</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">rightTolerance</span><span class="PUNC">:</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">leftTolerance</span><span class="PUNC">:</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">this.maxExtent</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.HTTPRequest</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">URL_HASH_FACTOR</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">params</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">reproject</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.params</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.params</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.params</span><span class="PUNC">=</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.HTTPRequest</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">this.params</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>308</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setUrl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mergeNewParams</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.params</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">this.params</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"params"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">redraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.mergeNewParams</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">_olSalt</span><span class="PUNC">:</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Layer.prototype.redraw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">selectUrl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.URL_HASH_FACTOR</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>309</span> </span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b.length</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFullRequestString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.params</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getParameterString</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.selectUrl</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.getParameters</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">f.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">&&</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getParameterString</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.urlAppend</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.HTTPRequest"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Tile</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">events</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">eventListeners</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">bounds</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">position</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">isLoading</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="NAME">b.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setBounds</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">e.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="STRN">"Tile_"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Object</span><span class="PUNC">)</span><span class="NAME">this.events.on</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unload</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isLoading</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>310</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"unload"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.eventListeners</span><span class="PUNC">&&</span><span class="NAME">this.events.un</span><span class="PUNC">(</span><span class="NAME">this.eventListeners</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="NAME">this.eventListeners</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.shouldDraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforedraw"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shouldDraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layer.maxExtent</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layer.map</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.baseLayer.wrapDateLine</span><span class="PUNC">&&</span><span class="NAME">c.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bounds.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>311</span> </span><span class="PUNC">{</span><span class="NAME">inclusive</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">worldBounds</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">this.layer.displayOutsideMaxExtent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.layer.map.baseLayer.wrapDateLine</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layer.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layer.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">leftTolerance</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">rightTolerance</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="NAME">b.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Tile"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Tile.Image</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Tile</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">imgDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">frame</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">imageReloadAttempts</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layerAlphaHack</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">asyncRequestId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">blankImageUrl</span><span class="PUNC">:</span><span class="STRN">"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7"</span><span class="PUNC">,</span><span class="NAME">maxGetUrlLength</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">canvasContext</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">crossOriginKeyword</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Tile.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.layerAlphaHack</span><span class="PUNC">=</span><span class="NAME">this.layer.alpha</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.alphaHack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.maxGetUrlLength</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>312</span> </span><span class="NAME">this.layer.gutter</span><span class="PUNC">||</span><span class="NAME">this.layerAlphaHack</span><span class="PUNC">)</span><span class="NAME">this.frame</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.frame.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">,</span><span class="NAME">this.frame.style.overflow</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.maxGetUrlLength</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Tile.Image.IFrame</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.imgDiv</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.frame</span><span class="PUNC">=</span><span class="NAME">this.imgDiv</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.asyncRequestId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Tile.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Tile.prototype.draw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">!=</span><span class="NAME">this.layer.map.baseLayer</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>313</span> </span><span class="NAME">this.layer.reproject</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">=</span><span class="NAME">this.getBoundsFromBaseLayer</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.isLoading</span><span class="PUNC">?</span><span class="NAME">this._loadEvent</span><span class="PUNC">=</span><span class="STRN">"reload"</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this._loadEvent</span><span class="PUNC">=</span><span class="STRN">"loadstart"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.positionTile</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.renderTile</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">renderTile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layer.div.appendChild</span><span class="PUNC">(</span><span class="NAME">this.getTile</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.layer.async</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.asyncRequestId</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.asyncRequestId</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.layer.getURLasync</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">==</span><span class="NAME">this.asyncRequestId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.initImage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">this.layer.getURL</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>314</span> </span><span class="NAME">this.initImage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">positionTile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getTile</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.frame</span><span class="PUNC">?</span><span class="NAME">this.size</span><span class="PUNC">:</span><span class="NAME">this.layer.getImageSize</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.left</span><span class="PUNC">=</span><span class="NAME">this.position.x</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a.top</span><span class="PUNC">=</span><span class="NAME">this.position.y</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a.width</span><span class="PUNC">=</span><span class="NAME">b.w</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a.height</span><span class="PUNC">=</span><span class="NAME">b.h</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Tile.prototype.clear.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.imgDiv</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getTile</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.parentNode</span><span class="PUNC">===</span><span class="NAME">this.layer.div</span><span class="PUNC">&&</span><span class="NAME">this.layer.div.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setImgSrc</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.layerAlphaHack</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.filter</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>315</span> </span><span class="STRN">"olImageLoadError"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.canvasContext</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getImage</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.imgDiv</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.imgDiv</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"img"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.imgDiv.className</span><span class="PUNC">=</span><span class="STRN">"olTileImage"</span><span class="PUNC">;</span><span class="NAME">this.imgDiv.galleryImg</span><span class="PUNC">=</span><span class="STRN">"no"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.imgDiv.style</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.frame</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.layer.gutter</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.layer.gutter</span><span class="PUNC">/</span><span class="NAME">this.layer.tileSize.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">this.layer.gutter</span><span class="PUNC">/</span><span class="NAME">this.layer.tileSize.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.left</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a.top</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a.width</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">100</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a.height</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">100</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">}</span><span class="NAME">a.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">;</span><span class="NAME">a.opacity</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">this.layer.opacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.filter</span><span class="PUNC">=</span><span class="STRN">"alpha(opacity="</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>316</span> </span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">this.layer.opacity</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="NAME">this.layerAlphaHack</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.paddingTop</span><span class="PUNC">=</span><span class="NAME">a.height</span><span class="PUNC">,</span><span class="NAME">a.height</span><span class="PUNC">=</span><span class="STRN">"0"</span><span class="PUNC">,</span><span class="NAME">a.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.frame</span><span class="PUNC">&&</span><span class="NAME">this.frame.appendChild</span><span class="PUNC">(</span><span class="NAME">this.imgDiv</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.imgDiv</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initImage</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="NAME">this._loadEvent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getImage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.url</span><span class="PUNC">&&</span><span class="NAME">a.getAttribute</span><span class="PUNC">(</span><span class="STRN">"src"</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">this.url</span><span class="PUNC">)</span><span class="NAME">this.onImageLoad</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.onImageLoad</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>317</span> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"error"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.onImageError</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.imageReloadAttempts</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.setImgSrc</span><span class="PUNC">(</span><span class="NAME">this.url</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.getAttribute</span><span class="PUNC">(</span><span class="STRN">"src"</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">this.blankImageUrl</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"error"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.crossOriginKeyword</span><span class="PUNC">&&</span><span class="NAME">a.removeAttribute</span><span class="PUNC">(</span><span class="STRN">"crossorigin"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.src</span><span class="PUNC">=</span><span class="NAME">this.blankImageUrl</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setImgSrc</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.imgDiv</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.style.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">,</span><span class="NAME">b.style.opacity</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.crossOriginKeyword</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"data:"</span><span class="PUNC">!==</span><span class="NAME">a.substr</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">b.setAttribute</span><span class="PUNC">(</span><span class="STRN">"crossorigin"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>318</span> </span><span class="NAME">this.crossOriginKeyword</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.removeAttribute</span><span class="PUNC">(</span><span class="STRN">"crossorigin"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.src</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.imgDiv</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b.parentNode</span><span class="PUNC">&&</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.frame</span><span class="PUNC">?</span><span class="NAME">this.frame</span><span class="PUNC">:</span><span class="NAME">this.getImage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createBackBuffer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.imgDiv</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.isLoading</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.frame</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.frame.cloneNode</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">this.imgDiv</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.imgDiv</span><span class="PUNC">;</span><span class="NAME">this.imgDiv</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onImageLoad</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.imgDiv</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.visibility</span><span class="PUNC">=</span><span class="STRN">"inherit"</span><span class="PUNC">;</span><span class="NAME">a.style.opacity</span><span class="PUNC">=</span><span class="NAME">this.layer.opacity</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>319</span> </span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.canvasContext</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loadend"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">7</span><span class="PUNC">></span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">navigator.appVersion.split</span><span class="PUNC">(</span><span class="STRN">"MSIE"</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.layer</span><span class="PUNC">&&</span><span class="NAME">this.layer.div</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"span"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layer.div</span><span class="PUNC">;</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.parentNode</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.layerAlphaHack</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.style.filter</span><span class="PUNC">=</span><span class="STRN">"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"</span><span class="PUNC">+</span><span class="NAME">a.src</span><span class="PUNC">+</span><span class="STRN">"', sizingMethod='scale')"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onImageError</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>320</span> </span><span class="NAME">this.imgDiv</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.src</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.imageReloadAttempts</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">this.imageReloadAttempts</span><span class="PUNC">&lt;=</span><span class="NAME">OpenLayers.IMAGE_RELOAD_ATTEMPTS</span><span class="PUNC">?</span><span class="NAME">this.setImgSrc</span><span class="PUNC">(</span><span class="NAME">this.layer.getURL</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"olImageLoadError"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loaderror"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.onImageLoad</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getCanvasContext</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.CANVAS_SUPPORTED</span><span class="PUNC">&&</span><span class="NAME">this.imgDiv</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.isLoading</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.canvasContext</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.width</span><span class="PUNC">=</span><span class="NAME">this.size.w</span><span class="PUNC">;</span><span class="NAME">a.height</span><span class="PUNC">=</span><span class="NAME">this.size.h</span><span class="PUNC">;</span><span class="NAME">this.canvasContext</span><span class="PUNC">=</span><span class="NAME">a.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>321</span> </span><span class="NAME">this.canvasContext.drawImage</span><span class="PUNC">(</span><span class="NAME">this.imgDiv</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.canvasContext</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Tile.Image"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Grid</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.HTTPRequest</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">tileSize</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">tileOriginCorner</span><span class="PUNC">:</span><span class="STRN">"bl"</span><span class="PUNC">,</span><span class="NAME">tileOrigin</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">tileOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">tileClass</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Tile.Image</span><span class="PUNC">,</span><span class="NAME">grid</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">singleTile</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ratio</span><span class="PUNC">:</span><span class="NUMB">1.5</span><span class="PUNC">,</span><span class="NAME">buffer</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">transitionEffect</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">numLoadingTiles</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">tileLoadingDelay</span><span class="PUNC">:</span><span class="NUMB">85</span><span class="PUNC">,</span><span class="NAME">serverResolutions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">moveTimerId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">deferMoveGriddedTiles</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">tileQueueId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">tileQueue</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">loading</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">backBuffer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">gridResolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">backBufferResolution</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">backBufferLonLat</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">backBufferTimerId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">removeBackBufferDelay</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>322</span> </span><span class="NAME">className</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.HTTPRequest.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.grid</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.tileQueue</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.removeBackBufferDelay</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.removeBackBufferDelay</span><span class="PUNC">=</span><span class="NAME">this.singleTile</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NUMB">2500</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.className</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.className</span><span class="PUNC">=</span><span class="NAME">this.singleTile</span><span class="PUNC">?</span><span class="STRN">"olLayerGridSingleTile"</span><span class="PUNC">:</span><span class="STRN">"olLayerGrid"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Animation.isNative</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.deferMoveGriddedTiles</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.moveGriddedTiles</span><span class="PUNC">(</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.moveTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.HTTPRequest.prototype.setMap.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>323</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">,</span><span class="NAME">this.className</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">this.moveTimerId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.moveTimerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.moveTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clearTileQueue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.removeBackBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clearGrid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileSize</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.HTTPRequest.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearGrid</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clearTileQueue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.grid</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>324</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.destroyTile</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.grid</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.gridResolution</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Grid</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">this.params</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.HTTPRequest.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.tileSize</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.tileSize</span><span class="PUNC">=</span><span class="NAME">this.tileSize.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.grid</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.gridResolution</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.backBuffer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.backBufferTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.tileQueue</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.tileQueueId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a.loading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a.moveTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>325</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.grid.length</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.getTilesBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.singleTile</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">e.containsBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="STRN">"resize"</span><span class="PUNC">!==</span><span class="NAME">this.transitionEffect</span><span class="PUNC">&&</span><span class="NAME">this.removeBackBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">"resize"</span><span class="PUNC">===</span><span class="NAME">this.transitionEffect</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.applyBackBuffer</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.initSingleTile</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">e.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">worldBounds</span><span class="PUNC">:</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>326</span> </span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">!==</span><span class="NAME">g</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.calculateBounds</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">this.transformDiv</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.div.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">this.div.style.height</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">this.div.style.left</span><span class="PUNC">=</span><span class="STRN">"0%"</span><span class="PUNC">,</span><span class="NAME">this.div.style.top</span><span class="PUNC">=</span><span class="STRN">"0%"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="STRN">"resize"</span><span class="PUNC">===</span><span class="NAME">this.transitionEffect</span><span class="PUNC">&&</span><span class="NAME">this.applyBackBuffer</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.initGriddedTiles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.moveGriddedTiles</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTileData</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.tileSize.w</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.tileSize.h</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">bounds</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.left</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>327</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h.top</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">k</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">tile</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">:</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">:</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">queueTileDraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.object</span><span class="PUNC">;</span><span class="PUNC">~</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.tileQueue</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.tileQueue.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileQueueId</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.tileQueueId</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Animation.start</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.drawTileFromQueue</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>328</span> </span><span class="NAME">this.div</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawTileFromQueue</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.tileQueue.length</span><span class="PUNC">?</span><span class="NAME">this.clearTileQueue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.tileQueue.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">draw</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearTileQueue</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Animation.stop</span><span class="PUNC">(</span><span class="NAME">this.tileQueueId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileQueueId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.tileQueue</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyTile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.removeTileMonitoringHooks</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getServerResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.serverResolutions</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.serverResolutions</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.serverResolutions.length</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>329</span> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.serverResolutions</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"no appropriate resolution in serverResolutions"</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getServerZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.serverResolutions</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.serverResolutions</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.map.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.zoomOffset</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transformDiv</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.div.style.width</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">this.div.style.height</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.left</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.top</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>330</span> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">b.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div.style.left</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">this.div.style.top</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolutionScale</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.width</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyBackBuffer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">&&</span><span class="NAME">this.removeBackBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.backBuffer</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.createBackBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="NAME">this.div.insertBefore</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.div.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.backBuffer</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">bounds</span><span class="PUNC">;</span><span class="NAME">this.backBufferLonLat</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">c.left</span><span class="PUNC">,</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">c.top</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.backBufferResolution</span><span class="PUNC">=</span><span class="NAME">this.gridResolution</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.style</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>331</span> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.backBufferResolution</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">c.width</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">c.height</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">this.backBufferLonLat</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.left</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.top</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.style.left</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">;</span><span class="NAME">b.style.top</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createBackBuffer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.grid.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.id</span><span class="PUNC">=</span><span class="NAME">this.div.id</span><span class="PUNC">+</span><span class="STRN">"_bb"</span><span class="PUNC">;</span><span class="NAME">a.className</span><span class="PUNC">=</span><span class="STRN">"olBackBuffer"</span><span class="PUNC">;</span><span class="NAME">a.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>332</span> </span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">createBackBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.style.top</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.tileSize.h</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">,</span><span class="NAME">f.style.left</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">this.tileSize.w</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeBackBuffer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.backBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.div.removeChild</span><span class="PUNC">(</span><span class="NAME">this.backBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.backBufferResolution</span><span class="PUNC">=</span><span class="NAME">this.backBuffer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveByPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.singleTile</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>333</span> </span><span class="NAME">this.moveGriddedTiles</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setTileSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.singleTile</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.h</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.h</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.w</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTilesBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">bounds</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">*</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">*</span><span class="NAME">a.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">a.left</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a.bottom</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initSingleTile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clearTileQueue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>334</span> </span><span class="NAME">a.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">b.lon</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.lon</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getLayerPxFromLonLat</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">b.left</span><span class="PUNC">,</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">b.top</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.grid.length</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a.moveTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.addTile</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.addTileMonitoringHooks</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.removeExcessTiles</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.gridResolution</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">calculateGridLayout</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.tileSize.w</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.tileSize.h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>335</span> </span><span class="NAME">a.left</span><span class="PUNC">-</span><span class="NAME">b.lon</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.buffer</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.tileSize.w</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.lon</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.top</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">b.lat</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.buffer</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">tilelon</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">tilelat</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">tileoffsetlon</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">tileoffsetlat</span><span class="PUNC">:</span><span class="NAME">b.lat</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">tileoffsetx</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">tileoffsety</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.tileSize.h</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTileOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.tileOrigin</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">tl</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="STRN">"top"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">tr</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="STRN">"top"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">bl</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="STRN">"bottom"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">br</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="STRN">"bottom"</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">[</span><span class="NAME">this.tileOriginCorner</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initGriddedTiles</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clearTileQueue</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>336</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">b.h</span><span class="PUNC">/</span><span class="NAME">this.tileSize.h</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">b.w</span><span class="PUNC">/</span><span class="NAME">this.tileSize.w</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getTileOrigin</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.calculateGridLayout</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.tileoffsetx</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.tileoffsety</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.tileoffsetlon</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.tileoffsetlat</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.tilelon</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.tilelat</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.top</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.map.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>337</span> </span><span class="NAME">p</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.grid.push</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">o</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">u</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">t.moveTo</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">this.addTile</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.addTileMonitoringHooks</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.push</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">s.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">tile</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">s.lon</span><span class="PUNC">-</span><span class="NAME">q.lon</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">s.lat</span><span class="PUNC">-</span><span class="NAME">q.lat</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.tileSize.w</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">&lt;=</span><span class="NAME">a.right</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">this.buffer</span><span class="PUNC">||</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.tileSize.h</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">>=</span><span class="NAME">a.bottom</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">this.buffer</span><span class="PUNC">||</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.removeExcessTiles</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.gridResolution</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>338</span> </span><span class="NAME">d.sort</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.distance</span><span class="PUNC">-</span><span class="NAME">b.distance</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">tile.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMaxExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.maxExtent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addTile</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">this.tileClass</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.tileSize</span><span class="PUNC">,</span><span class="NAME">this.tileOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.events.register</span><span class="PUNC">(</span><span class="STRN">"beforedraw"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.queueTileDraw</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addTileMonitoringHooks</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.onLoadStart</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.loading</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.loading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loadstart"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"tileloadstart"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">tile</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.numLoadingTiles</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>339</span> </span><span class="NAME">a.onLoadEnd</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.numLoadingTiles</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"tileloaded"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">tile</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.tileQueue.length</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.numLoadingTiles</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.loading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loadend"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.backBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.backBufferTimerId</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.removeBackBuffer</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.removeBackBufferDelay</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.onLoadError</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"tileerror"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">tile</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.events.on</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">loadstart</span><span class="PUNC">:</span><span class="NAME">a.onLoadStart</span><span class="PUNC">,</span><span class="NAME">loadend</span><span class="PUNC">:</span><span class="NAME">a.onLoadEnd</span><span class="PUNC">,</span><span class="NAME">unload</span><span class="PUNC">:</span><span class="NAME">a.onLoadEnd</span><span class="PUNC">,</span><span class="NAME">loaderror</span><span class="PUNC">:</span><span class="NAME">a.onLoadError</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>340</span> </span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeTileMonitoringHooks</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">loadstart</span><span class="PUNC">:</span><span class="NAME">a.onLoadStart</span><span class="PUNC">,</span><span class="NAME">loadend</span><span class="PUNC">:</span><span class="NAME">a.onLoadEnd</span><span class="PUNC">,</span><span class="NAME">unload</span><span class="PUNC">:</span><span class="NAME">a.onLoadEnd</span><span class="PUNC">,</span><span class="NAME">loaderror</span><span class="PUNC">:</span><span class="NAME">a.onLoadError</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveGriddedTiles</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Animation.isNative</span><span class="PUNC">)</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.moveTimerId</span><span class="PUNC">&&</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.moveTimerId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.moveTimerId</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">this.deferMoveGriddedTiles</span><span class="PUNC">,</span><span class="NAME">this.tileLoadingDelay</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.buffer</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getResolutionScale</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">position.x</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.left</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>341</span> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">position.y</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.top</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.top</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.tileSize.w</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.tileSize.h</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">></span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.shiftColumn</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.shiftColumn</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">></span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.shiftRow</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.shiftRow</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shiftRow</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.grid.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">this.tileSize.h</span><span class="PUNC">:</span><span class="NAME">this.tileSize.h</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>342</span> </span><span class="NAME">b.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i.bounds.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i.position.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.bottom</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">j.top</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">i.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">moveTo</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">b.unshift</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shiftColumn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">this.tileSize.w</span><span class="PUNC">:</span><span class="NAME">this.tileSize.w</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g.bounds.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g.position.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.left</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">h.right</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">g.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">shift</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.moveTo</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">f.unshift</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeExcessTiles</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>343</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.grid.length</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.destroyTile</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.grid.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.destroyTile</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onMapResize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.singleTile</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.clearGrid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setTileSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTileBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.maxExtent</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.tileSize.w</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">this.tileSize.h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.left</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.lon</span><span class="PUNC">-</span><span class="NAME">b.left</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.bottom</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>344</span> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.lat</span><span class="PUNC">-</span><span class="NAME">b.bottom</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.Grid"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.SphericalMercator</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">getExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.map.calculateBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLonLatFromViewPortPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getViewPortPxFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initMercatorParameters</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.RESOLUTIONS</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">this.MAX_ZOOM_LEVEL</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.RESOLUTIONS</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>345</span> </span><span class="NUMB">156543.03390625</span><span class="PUNC">/</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.units</span><span class="PUNC">=</span><span class="STRN">"m"</span><span class="PUNC">;</span><span class="NAME">this.projection</span><span class="PUNC">=</span><span class="NAME">this.projection</span><span class="PUNC">||</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">forwardMercator</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NAME">e.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">inverseMercator</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Projection.transform</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>346</span> </span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NAME">e.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.EventPane</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">smoothDragPan</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">isFixed</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">pane</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">mapObject</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.pane</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="NAME">this.div.id</span><span class="PUNC">+</span><span class="STRN">"_EventPane"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">=</span><span class="NAME">this.mapObject</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane.style.zIndex</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>347</span> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.zIndex</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.pane.style.display</span><span class="PUNC">=</span><span class="NAME">this.div.style.display</span><span class="PUNC">;</span><span class="NAME">this.pane.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">this.pane.style.height</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="STRN">"msie"</span><span class="PUNC">==</span><span class="NAME">OpenLayers.BROWSER_NAME</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.pane.style.background</span><span class="PUNC">=</span><span class="STRN">"url("</span><span class="PUNC">+</span><span class="NAME">OpenLayers.Util.getImageLocation</span><span class="PUNC">(</span><span class="STRN">"blank.gif"</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.isFixed</span><span class="PUNC">?</span><span class="NAME">this.map.viewPortDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.map.layerContainerDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.loadMapObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.mapObject</span><span class="PUNC">&&</span><span class="NAME">this.loadWarningMessage</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pane</span><span class="PUNC">&&</span><span class="NAME">this.pane.parentNode</span><span class="PUNC">&&</span><span class="NAME">this.pane.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">this.pane</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>348</span> </span><span class="NAME">OpenLayers.Layer.prototype.removeMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadWarningMessage</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.div.style.backgroundColor</span><span class="PUNC">=</span><span class="STRN">"darkblue"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NUMB">300</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a.h</span><span class="PUNC">,</span><span class="NUMB">200</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Size</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">a.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">b.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">b.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">+</span><span class="STRN">"_warning"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"auto"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.padding</span><span class="PUNC">=</span><span class="STRN">"7px"</span><span class="PUNC">;</span><span class="NAME">a.style.backgroundColor</span><span class="PUNC">=</span><span class="STRN">"yellow"</span><span class="PUNC">;</span><span class="NAME">a.innerHTML</span><span class="PUNC">=</span><span class="NAME">this.getWarningHTML</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getWarningHTML</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>349</span> </span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.display.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane.style.display</span><span class="PUNC">=</span><span class="NAME">this.div.style.display</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setZIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.setZIndex.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pane.style.zIndex</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.div.style.zIndex</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveByPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.moveByPx.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragPanMapObject</span><span class="PUNC">?</span><span class="NAME">this.dragPanMapObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">this.map.getCachedCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.moveTo.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>350</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.mapObject</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getOLLonLatFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">this.getMapObjectCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getOLZoomFromMapObjectZoom</span><span class="PUNC">(</span><span class="NAME">this.getMapObjectZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">d.equals</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">this.dragPanMapObject</span><span class="PUNC">&&</span><span class="NAME">this.smoothDragPan</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getViewPortPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.dragPanMapObject</span><span class="PUNC">(</span><span class="NAME">d.x</span><span class="PUNC">-</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NAME">e.y</span><span class="PUNC">-</span><span class="NAME">d.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getMapObjectLonLatFromOLLonLat</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.getMapObjectZoomFromOLZoom</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setMapObjectCenter</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>351</span> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLonLatFromViewPortPx</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.mapObject</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.getMapObjectCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getOLLonLatFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">this.getMapObjectLonLatFromMapObjectPixel</span><span class="PUNC">(</span><span class="NAME">this.getMapObjectPixelFromOLPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getViewPortPxFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.mapObject</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.getMapObjectCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getOLPixelFromMapObjectPixel</span><span class="PUNC">(</span><span class="NAME">this.getMapObjectPixelFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">this.getMapObjectLonLatFromOLLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getOLLonLatFromMapObjectLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>352</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getLongitudeFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getLatitudeFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectLonLatFromOLLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getMapObjectLonLatFromLonLat</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getOLPixelFromMapObjectPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getXFromMapObjectPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getYFromMapObjectPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Pixel</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectPixelFromOLPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getMapObjectPixelFromXY</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>353</span> </span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.EventPane"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.FixedZoomLevels</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initResolutions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"minZoomLevel"</span><span class="PUNC">,</span><span class="STRN">"maxZoomLevel"</span><span class="PUNC">,</span><span class="STRN">"numZoomLevels"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">this.options</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.map</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">||</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">&lt;</span><span class="NAME">this.MIN_ZOOM_LEVEL</span><span class="PUNC">)</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">=</span><span class="NAME">this.MIN_ZOOM_LEVEL</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.MAX_ZOOM_LEVEL</span><span class="PUNC">-</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.options.numZoomLevels</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.options.maxZoomLevel</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.numZoomLevels</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.maxZoomLevel</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>354</span> </span><span class="NAME">this.maxZoomLevel</span><span class="PUNC">-</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">this.numZoomLevels</span><span class="PUNC">;</span><span class="NAME">this.numZoomLevels</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.maxZoomLevel</span><span class="PUNC">=</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">+</span><span class="NAME">this.numZoomLevels</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.RESOLUTIONS</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.resolutions</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">this.maxZoomLevel</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.RESOLUTIONS</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.maxResolution</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.minResolution</span><span class="PUNC">=</span><span class="NAME">this.resolutions</span><span class="PUNC">[</span><span class="NAME">this.resolutions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.resolutions</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.prototype.getResolution.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>355</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NAME">c.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">b.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getZoomForResolution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.resolutions</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Layer.prototype.getZoomForResolution.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.getZoomForExtent</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.prototype.getExtent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>356</span> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getOLZoomFromMapObjectZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">,</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">!==</span><span class="KEYW">this</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.baseLayer.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">this.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectZoomFromOLZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">this.minZoomLevel</span><span class="PUNC">,</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">!==</span><span class="KEYW">this</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getZoomForResolution</span><span class="PUNC">(</span><span class="NAME">this.map.baseLayer.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.FixedZoomLevels"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Google</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.EventPane</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Layer.FixedZoomLevels</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">MIN_ZOOM_LEVEL</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">MAX_ZOOM_LEVEL</span><span class="PUNC">:</span><span class="NUMB">21</span><span class="PUNC">,</span><span class="NAME">RESOLUTIONS</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">1.40625</span><span class="PUNC">,</span><span class="NUMB">0.703125</span><span class="PUNC">,</span><span class="NUMB">0.3515625</span><span class="PUNC">,</span><span class="NUMB">0.17578125</span><span class="PUNC">,</span><span class="NUMB">0.087890625</span><span class="PUNC">,</span><span class="NUMB">0.0439453125</span><span class="PUNC">,</span><span class="NUMB">0.02197265625</span><span class="PUNC">,</span><span class="NUMB">0.010986328125</span><span class="PUNC">,</span><span class="NUMB">0.0054931640625</span><span class="PUNC">,</span><span class="NUMB">0.00274658203125</span><span class="PUNC">,</span><span class="NUMB">0.001373291015625</span><span class="PUNC">,</span><span class="NUMB">6.866455078125</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">3.4332275390625</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">1.71661376953125</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">8.58306884765625</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">4.291534423828125</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">2.145767211914062</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1.072883605957031</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">5.36441802978515</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">2.68220901489257</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">1.341104507446289</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">6.705522537231445</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>357</span> </span><span class="NAME">type</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">wrapDateLine</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">sphericalMercator</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">version</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.version</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b.version</span><span class="PUNC">=</span><span class="STRN">"function"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">GMap2</span><span class="PUNC">?</span><span class="STRN">"2"</span><span class="PUNC">:</span><span class="STRN">"3"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google</span><span class="PUNC">[</span><span class="STRN">"v"</span><span class="PUNC">+</span><span class="NAME">b.version.replace</span><span class="PUNC">(</span><span class="REGX">/\./g</span><span class="PUNC">,</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="STRN">"Unsupported Google Maps API version: "</span><span class="PUNC">+</span><span class="NAME">b.version</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c.DEFAULTS</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.maxExtent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.maxExtent</span><span class="PUNC">=</span><span class="NAME">b.maxExtent.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.EventPane.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>358</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Layer.SphericalMercator</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.initMercatorParameters</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Google</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setVisibility</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.opacity</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">this.opacity</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.EventPane.prototype.setVisibility.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setOpacity</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._dragging</span><span class="PUNC">||</span><span class="NAME">this.setGMapVisibility</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.EventPane.prototype.display.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>359</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._dragging</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.EventPane.prototype.moveTo.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._dragging</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setOpacity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">this.opacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="STRN">"opacity"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.opacity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.getVisibility</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getMapContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.modifyDOMElement</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setGMapVisibility</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NAME">a.count</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>360</span> </span><span class="NAME">this.removeGMapElements</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">OpenLayers.Layer.EventPane.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeGMapElements</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.mapObject</span><span class="PUNC">&&</span><span class="NAME">this.getMapContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.parentNode</span><span class="PUNC">&&</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.termsOfUse</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.parentNode</span><span class="PUNC">&&</span><span class="NAME">b.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.poweredBy</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.parentNode</span><span class="PUNC">&&</span><span class="NAME">a.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.visibility</span><span class="PUNC">&&</span><span class="NAME">this.mapObject</span><span class="PUNC">&&</span><span class="NAME">this.setGMapVisibility</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>361</span> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NAME">b.count</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.removeGMapElements</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">--</span><span class="NAME">b.count</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.termsOfUse</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.poweredBy</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.mapObject</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.dragObject</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.EventPane.prototype.removeMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getOLBoundsFromMapObjectBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.getSouthWest</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getNorthEast</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.forwardMercator</span><span class="PUNC">(</span><span class="NAME">b.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.forwardMercator</span><span class="PUNC">(</span><span class="NAME">a.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">b.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>362</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">b.lon</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getWarningHTML</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"googleWarning"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectCenter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLongitudeFromMapObjectLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.forwardMercator</span><span class="PUNC">(</span><span class="NAME">a.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">a.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLatitudeFromMapObjectLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.forwardMercator</span><span class="PUNC">(</span><span class="NAME">a.lng</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>363</span> </span><span class="NAME">a.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">a.lat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getXFromMapObjectPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getYFromMapObjectPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.Google"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>364</span> </span><span class="NAME">OpenLayers.Layer.Google.v2</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">termsOfUse</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">poweredBy</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">dragObject</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">loadMapObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.type</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">G_NORMAL_MAP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.mapObject</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d.termsOfUse</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.poweredBy</span><span class="PUNC">,</span><span class="PUNC">++</span><span class="NAME">d.count</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.id</span><span class="PUNC">=</span><span class="NAME">this.map.id</span><span class="PUNC">+</span><span class="STRN">"_GMap2Container"</span><span class="PUNC">;</span><span class="NAME">e.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="NAME">e.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">e.style.height</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">;</span><span class="NAME">d.appendChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GMap2</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.lastChild</span><span class="PUNC">,</span><span class="NAME">d.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.style.zIndex</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>365</span> </span><span class="STRN">"1100"</span><span class="PUNC">,</span><span class="NAME">b.style.right</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.style.bottom</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.className</span><span class="PUNC">=</span><span class="STRN">"olLayerGoogleCopyright"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.lastChild</span><span class="PUNC">,</span><span class="NAME">d.appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.style.zIndex</span><span class="PUNC">=</span><span class="STRN">"1100"</span><span class="PUNC">,</span><span class="NAME">c.style.right</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.style.bottom</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.className</span><span class="PUNC">=</span><span class="STRN">"olLayerGooglePoweredBy gmnoprint"</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">mapObject</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">termsOfUse</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">poweredBy</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">count</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.mapObject</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.termsOfUse</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.poweredBy</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.mapObject.getMapTypes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.mapObject.addMapType</span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a.getDragObject</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>366</span> </span><span class="NAME">this.dragObject</span><span class="PUNC">=</span><span class="NAME">a.getDragObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.dragPanMapObject</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.isBaseLayer</span><span class="PUNC">&&</span><span class="NAME">this.setGMapVisibility</span><span class="PUNC">(</span><span class="STRN">"none"</span><span class="PUNC">!==</span><span class="NAME">this.div.style.display</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onMapResize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.visibility</span><span class="PUNC">&&</span><span class="NAME">this.mapObject.isLoaded</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.mapObject.checkResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._resized</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">GEvent.addListener</span><span class="PUNC">(</span><span class="NAME">this.mapObject</span><span class="PUNC">,</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">GEvent.removeListener</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a._resized</span><span class="PUNC">;</span><span class="NAME">a.mapObject.checkResize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.moveTo</span><span class="PUNC">(</span><span class="NAME">a.map.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._resized</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setGMapVisibility</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>367</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.mapObject.getContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.mapObject.setMapType</span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">this.termsOfUse.style.left</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">this.termsOfUse.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">this.poweredBy.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.displayed</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b.displayed</span><span class="PUNC">===</span><span class="NAME">this.id</span><span class="PUNC">&&</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">b.displayed</span><span class="PUNC">,</span><span class="NAME">b.displayed</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">,</span><span class="NAME">this.termsOfUse.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">,</span><span class="NAME">this.termsOfUse.style.left</span><span class="PUNC">=</span><span class="STRN">"-9999px"</span><span class="PUNC">,</span><span class="NAME">this.poweredBy.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapContainer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.getContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectBoundsFromOLBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>368</span> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.inverseMercator</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">a.left</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">a.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.inverseMercator</span><span class="PUNC">(</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">a.right</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">a.right</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GLatLngBounds</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GLatLng</span><span class="PUNC">(</span><span class="NAME">b.lat</span><span class="PUNC">,</span><span class="NAME">b.lon</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GLatLng</span><span class="PUNC">(</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMapObjectCenter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.mapObject.setCenter</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dragPanMapObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dragObject.moveBy</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GSize</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectLonLatFromMapObjectPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.fromContainerPixelToLatLng</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>369</span> </span><span class="NAME">getMapObjectPixelFromMapObjectLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.fromLatLngToContainerPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectZoomFromMapObjectBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.getBoundsZoomLevel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectLonLatFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.inverseMercator</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GLatLng</span><span class="PUNC">(</span><span class="NAME">c.lat</span><span class="PUNC">,</span><span class="NAME">c.lon</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GLatLng</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectPixelFromXY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">GPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">format</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">options</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">autoDestroy</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">defaultFilter</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mergeWithDefaultFilter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.defaultFilter</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Filter.Logical</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Filter.Logical.AND</span><span class="PUNC">,</span><span class="NAME">filters</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">this.defaultFilter</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">this.defaultFilter</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.format</span><span class="PUNC">=</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.filter</span><span class="PUNC">=</span><span class="NAME">this.mergeWithDefaultFilter</span><span class="PUNC">(</span><span class="NAME">a.filter</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">create</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>370</span> </span><span class="NAME">update</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">"delete"</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">commit</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">abort</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createCallback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Protocol"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">code</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">requestType</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">last</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">features</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">reqFeatures</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">priv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">error</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">success</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.code</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Protocol.Response"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> </span><span class="NAME">OpenLayers.Protocol.Response.SUCCESS</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.Response.FAILURE</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.Attribution</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">separator</span><span class="PUNC">:</span><span class="STRN">", "</span><span class="PUNC">,</span><span class="NAME">template</span><span class="PUNC">:</span><span class="STRN">"${layers}"</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">removelayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">addlayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">changelayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">changebaselayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Control.prototype.draw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.events.on</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">changebaselayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">changelayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>372</span> </span><span class="NAME">addlayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">removelayer</span><span class="PUNC">:</span><span class="NAME">this.updateAttribution</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateAttribution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.div</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateAttribution</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.layers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.layers.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.layers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d.attribution</span><span class="PUNC">&&</span><span class="NAME">d.getVisibility</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d.attribution</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">d.attribution</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.div.innerHTML</span><span class="PUNC">=</span><span class="NAME">OpenLayers.String.format</span><span class="PUNC">(</span><span class="NAME">this.template</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="NAME">a.join</span><span class="PUNC">(</span><span class="NAME">this.separator</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.Attribution"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">options</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">externalProjection</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">internalProjection</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">keepData</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.options</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Read not implemented."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">write</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Write not implemented."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Format"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.JSON</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Format</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">indent</span><span class="PUNC">:</span><span class="STRN">"    "</span><span class="PUNC">,</span><span class="NAME">space</span><span class="PUNC">:</span><span class="STRN">" "</span><span class="PUNC">,</span><span class="NAME">newline</span><span class="PUNC">:</span><span class="STRN">"\n"</span><span class="PUNC">,</span><span class="NAME">level</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">pretty</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">nativeJSON</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">window.JSON</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">JSON.parse</span><span class="PUNC">&&</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.nativeJSON</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^[\],:{}\s]*$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="REGX">/\\["\\\/bfnrtu]/g</span><span class="PUNC">,</span><span class="STRN">"@"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g</span><span class="PUNC">,</span><span class="STRN">"]"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/(?:^|:|,)(?:\s*\[)+/g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">eval</span><span class="PUNC">(</span><span class="STRN">"("</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>373</span> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="STRN">"object"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">c.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="NAME">this.keepData</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">write</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pretty</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.serialize</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.pretty</span><span class="PUNC">&&</span><span class="NAME">this.nativeJSON</span><span class="PUNC">?</span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.serialize</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="STRN">"Trouble serializing: "</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">writeIndent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.pretty</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.level</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">this.indent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>374</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">writeNewline</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.pretty</span><span class="PUNC">?</span><span class="NAME">this.newline</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">writeSpace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.pretty</span><span class="PUNC">?</span><span class="NAME">this.space</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">serialize</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">object</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="STRN">"null"</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.constructor</span><span class="PUNC">==</span><span class="NAME">Date</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.serialize.date.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.constructor</span><span class="PUNC">==</span><span class="NAME">Array</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.serialize.array.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"{"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.level</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">a.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Format.JSON.prototype.write.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.pretty</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Format.JSON.prototype.write.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>375</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.pretty</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.writeNewline</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.writeIndent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="STRN">":"</span><span class="PUNC">,</span><span class="NAME">this.writeSpace</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.level</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.writeNewline</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.writeIndent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">array</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"["</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.level</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Format.JSON.prototype.write.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.pretty</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">this.writeNewline</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.writeIndent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.level</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">this.writeNewline</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.writeIndent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>376</span> </span><span class="STRN">"]"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">string</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">"\u0008"</span><span class="PUNC">:</span><span class="STRN">"\\b"</span><span class="PUNC">,</span><span class="STRN">"\t"</span><span class="PUNC">:</span><span class="STRN">"\\t"</span><span class="PUNC">,</span><span class="STRN">"\n"</span><span class="PUNC">:</span><span class="STRN">"\\n"</span><span class="PUNC">,</span><span class="STRN">"\u000c"</span><span class="PUNC">:</span><span class="STRN">"\\f"</span><span class="PUNC">,</span><span class="STRN">"\r"</span><span class="PUNC">:</span><span class="STRN">"\\r"</span><span class="PUNC">,</span><span class="STRN">'"'</span><span class="PUNC">:</span><span class="STRN">'\\"'</span><span class="PUNC">,</span><span class="STRN">"\\"</span><span class="PUNC">:</span><span class="STRN">"\\\\"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="REGX">/["\\\x00-\x1f]/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">'"'</span><span class="PUNC">+</span><span class="NAME">a.replace</span><span class="PUNC">(</span><span class="REGX">/([\x00-\x1f\\"])/g</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.charCodeAt</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="STRN">"\\u00"</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">%</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'"'</span><span class="PUNC">:</span><span class="STRN">'"'</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">'"'</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">number</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">isFinite</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">:</span><span class="STRN">"null"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">""</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">date</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">"0"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="STRN">'"'</span><span class="PUNC">+</span><span class="NAME">a.getFullYear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"-"</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>377</span> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.getMonth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"-"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.getDate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"T"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.getHours</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.getMinutes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a.getSeconds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">'"'</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Format.JSON"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.XML</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Format</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">namespaces</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">namespaceAlias</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">defaultPrefix</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">readers</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">writers</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">xmldom</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">window.ActiveXObject</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.xmldom</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"Microsoft.XMLDOM"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.namespaces</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.namespaces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.namespaceAlias</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.namespaces</span><span class="PUNC">)</span><span class="NAME">this.namespaceAlias</span><span class="PUNC">[</span><span class="NAME">this.namespaces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.xmldom</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>378</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setNamespace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.namespaces</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.namespaceAlias</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"&lt;"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.Try</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">window.ActiveXObject</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.xmldom</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"Microsoft.XMLDOM"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.xmldom</span><span class="PUNC">;</span><span class="NAME">b.loadXML</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">DOMParser</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">parseFromString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"text/xml"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">;</span><span class="NAME">b.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="STRN">"data:text/xml;charset=utf-8,"</span><span class="PUNC">+</span><span class="NAME">encodeURIComponent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.overrideMimeType</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>379</span> </span><span class="NAME">b.overrideMimeType</span><span class="PUNC">(</span><span class="STRN">"text/xml"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.responseXML</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.keepData</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">write</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.xmldom</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.xml</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLSerializer</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.implementation.createDocument</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.importNode</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.importNode</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.serializeToString</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.serializeToString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createElementNS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.xmldom</span><span class="PUNC">?</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.xmldom.createNode</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.xmldom.createNode</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">document.createElementNS</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>380</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createTextNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"string"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.xmldom</span><span class="PUNC">?</span><span class="NAME">this.xmldom.createTextNode</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getElementsByTagNameNS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.getElementsByTagNameNS</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagNameNS</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"*"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.prefix</span><span class="PUNC">?</span><span class="NAME">e.prefix</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"*"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">f</span><span class="PUNC">==</span><span class="NAME">e.nodeName</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="STRN">"*"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">==</span><span class="NAME">e.namespaceURI</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getAttributeNodeNS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.getAttributeNodeNS</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.getAttributeNodeNS</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>381</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.attributes</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e.namespaceURI</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.prefix</span><span class="PUNC">?</span><span class="NAME">e.prefix</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">==</span><span class="NAME">e.nodeName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getAttributeNS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.getAttributeNS</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.getAttributeNS</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getAttributeNodeNS</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.nodeValue</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getChildValue</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.firstChild</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.nextSibling</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">d.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.nodeValue</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isSimpleContent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.firstChild</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>382</span> </span><span class="NAME">a.nextSibling</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">contentType</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Format.XML.CONTENT_TYPE.EMPTY</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.firstChild</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.nextSibling</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">:</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Format.XML.CONTENT_TYPE.MIXED</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hasAttributeNS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.hasAttributeNS</span><span class="PUNC">?</span><span class="NAME">a.hasAttributeNS</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>383</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.getAttributeNodeNS</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setAttributeNS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">)</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.xmldom</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.ownerDocument.createNode</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.nodeValue</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNode</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.setAttribute</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="STRN">"setAttributeNS not implemented"</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createElementNSPlus</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.uri</span><span class="PUNC">||</span><span class="NAME">this.namespaces</span><span class="PUNC">[</span><span class="NAME">b.prefix</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.namespaces</span><span class="PUNC">[</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.namespaces</span><span class="PUNC">[</span><span class="NAME">this.defaultPrefix</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.createElementNS</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.attributes</span><span class="PUNC">&&</span><span class="NAME">this.setAttributes</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>384</span> </span><span class="NAME">b.attributes</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.value</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">this.createTextNode</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setAttributes</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.namespaces</span><span class="PUNC">[</span><span class="NAME">e.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e.indexOf</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.setAttributeNS</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">readNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.readers</span><span class="PUNC">[</span><span class="NAME">a.namespaceURI</span><span class="PUNC">?</span><span class="NAME">this.namespaceAlias</span><span class="PUNC">[</span><span class="NAME">a.namespaceURI</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.defaultPrefix</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.localName</span><span class="PUNC">||</span><span class="NAME">a.nodeName.split</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"*"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">readChildNodes</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>385</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.childNodes</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">d.nodeType</span><span class="PUNC">&&</span><span class="NAME">this.readNode</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">writeNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">this.namespaceAlias</span><span class="PUNC">[</span><span class="NAME">c.namespaceURI</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.defaultPrefix</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.writers</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getChildEl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.getThisOrNextEl</span><span class="PUNC">(</span><span class="NAME">a.firstChild</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNextEl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.getThisOrNextEl</span><span class="PUNC">(</span><span class="NAME">a.nextSibling</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getThisOrNextEl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>386</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.nextSibling</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">a.localName</span><span class="PUNC">||</span><span class="NAME">a.nodeName.split</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">===</span><span class="NAME">a.namespaceURI</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^\s*$/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a.nodeValue</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">6</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">12</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">11</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lookupNamespaceURI</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.lookupNamespaceURI</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.lookupNamespaceURI</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">a.namespaceURI</span><span class="PUNC">&&</span><span class="NAME">a.prefix</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.namespaceURI</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.attributes.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>387</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.attributes</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"xmlns"</span><span class="PUNC">===</span><span class="NAME">d.prefix</span><span class="PUNC">&&</span><span class="NAME">d.name</span><span class="PUNC">===</span><span class="STRN">"xmlns:"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.value</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"xmlns"</span><span class="PUNC">===</span><span class="NAME">d.name</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.value</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.lookupNamespaceURI</span><span class="PUNC">(</span><span class="NAME">a.parentNode</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.lookupNamespaceURI</span><span class="PUNC">(</span><span class="NAME">a.ownerElement</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">9</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.lookupNamespaceURI</span><span class="PUNC">(</span><span class="NAME">a.documentElement</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">6</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">12</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">11</span><span class="PUNC">:</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.lookupNamespaceURI</span><span class="PUNC">(</span><span class="NAME">a.parentNode</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getXMLDoc</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Format.XML.document</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.xmldom</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">document.implementation</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>388</span> </span><span class="NAME">document.implementation.createDocument</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Format.XML.document</span><span class="PUNC">=</span><span class="NAME">document.implementation.createDocument</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NAME">this.xmldom</span><span class="PUNC">&&</span><span class="NAME">window.ActiveXObject</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.xmldom</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"Microsoft.XMLDOM"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.XML.document</span><span class="PUNC">||</span><span class="NAME">this.xmldom</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Format.XML"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.XML.CONTENT_TYPE</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">EMPTY</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">SIMPLE</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">COMPLEX</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">MIXED</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.XML.lookupNamespaceURI</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Format.XML.prototype.lookupNamespaceURI</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Format.XML.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>389</span> </span><span class="NAME">OpenLayers.Format.XML.document</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.MultiPolygon</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.MultiPolygon"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.Drag</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">started</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">stopDown</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">touch</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">last</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">start</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">lastMoveEvt</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">oldOnselectstart</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">interval</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">timeoutId</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">documentDrag</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">documentEvents</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.documentDrag</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this._docMove</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.mousemove</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">xy</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.clientX</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.clientY</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">element</span><span class="PUNC">:</span><span class="NAME">document</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this._docUp</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.mouseup</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">xy</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.clientX</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.clientY</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>390</span> </span><span class="NAME">dragstart</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.checkModifiers</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.isLeftClick</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">OpenLayers.Event.isSingleTouch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.started</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.start</span><span class="PUNC">=</span><span class="NAME">a.xy</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="STRN">"olDragDown"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.down</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"down"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.xy</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.oldOnselectstart</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.oldOnselectstart</span><span class="PUNC">=</span><span class="NAME">document.onselectstart</span><span class="PUNC">?</span><span class="NAME">document.onselectstart</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Function.True</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">document.onselectstart</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.False</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.stopDown</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.started</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>391</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.start</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dragmove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.lastMoveEvt</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.started</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.timeoutId</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.xy.x</span><span class="PUNC">!=</span><span class="NAME">this.last.x</span><span class="PUNC">||</span><span class="NAME">a.xy.y</span><span class="PUNC">!=</span><span class="NAME">this.last.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.documentDrag</span><span class="PUNC">&&</span><span class="NAME">this.documentEvents</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.element</span><span class="PUNC">===</span><span class="NAME">document</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.adjustXY</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.removeDocumentEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.interval</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.timeoutId</span><span class="PUNC">=</span><span class="NAME">setTimeout</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.removeTimeout</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.interval</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.move</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"move"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.xy</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.oldOnselectstart</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.oldOnselectstart</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>392</span> </span><span class="NAME">document.onselectstart</span><span class="PUNC">,</span><span class="NAME">document.onselectstart</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.False</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">a.xy</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dragend</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.started</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.documentDrag</span><span class="PUNC">&&</span><span class="NAME">this.documentEvents</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.adjustXY</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.removeDocumentEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.start</span><span class="PUNC">!=</span><span class="NAME">this.last</span><span class="PUNC">;</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="NAME">this.started</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="STRN">"olDragDown"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.up</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"up"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.xy</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"done"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.xy</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.onselectstart</span><span class="PUNC">=</span><span class="NAME">this.oldOnselectstart</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">down</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>393</span> </span><span class="NAME">up</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dragstart</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchstart</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.touch</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.touch</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.map.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="NAME">this.mousedown</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="NAME">this.mouseup</span><span class="PUNC">,</span><span class="NAME">mousemove</span><span class="PUNC">:</span><span class="NAME">this.mousemove</span><span class="PUNC">,</span><span class="NAME">click</span><span class="PUNC">:</span><span class="NAME">this.click</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dragstart</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousemove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dragmove</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchmove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dragmove</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeTimeout</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.timeoutId</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.dragging</span><span class="PUNC">&&</span><span class="NAME">this.mousemove</span><span class="PUNC">(</span><span class="NAME">this.lastMoveEvt</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dragend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>394</span> </span><span class="NAME">touchend</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.xy</span><span class="PUNC">=</span><span class="NAME">this.last</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.dragend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseout</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.started</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.mouseLeft</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.documentDrag</span><span class="PUNC">)</span><span class="NAME">this.addDocumentEvents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.start</span><span class="PUNC">!=</span><span class="NAME">this.last</span><span class="PUNC">;</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="NAME">this.started</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="STRN">"olDragDown"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.out</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"out"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"done"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.xy</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">document.onselectstart</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">document.onselectstart</span><span class="PUNC">=</span><span class="NAME">this.oldOnselectstart</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">click</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.start</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>395</span> </span><span class="NAME">this.last</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.dragging</span><span class="PUNC">=</span><span class="NAME">this.started</span><span class="PUNC">=</span><span class="NAME">this.touch</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.last</span><span class="PUNC">=</span><span class="NAME">this.start</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="STRN">"olDragDown"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">adjustXY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.pagePosition</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.xy.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.xy.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addDocumentEvents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>396</span> </span><span class="STRN">"olDragDown"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.documentEvents</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="STRN">"mousemove"</span><span class="PUNC">,</span><span class="NAME">this._docMove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="STRN">"mouseup"</span><span class="PUNC">,</span><span class="NAME">this._docUp</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeDocumentEvents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">document.body</span><span class="PUNC">,</span><span class="STRN">"olDragDown"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.documentEvents</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="STRN">"mousemove"</span><span class="PUNC">,</span><span class="NAME">this._docMove</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="STRN">"mouseup"</span><span class="PUNC">,</span><span class="NAME">this._docUp</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.Drag"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.Box</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">dragHandler</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">boxDivClassName</span><span class="PUNC">:</span><span class="STRN">"olHandlerBoxZoomBox"</span><span class="PUNC">,</span><span class="NAME">boxOffsets</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragHandler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Drag</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">down</span><span class="PUNC">:</span><span class="NAME">this.startBox</span><span class="PUNC">,</span><span class="NAME">move</span><span class="PUNC">:</span><span class="NAME">this.moveBox</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="NAME">this.removeBox</span><span class="PUNC">,</span><span class="NAME">up</span><span class="PUNC">:</span><span class="NAME">this.endBox</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">keyMask</span><span class="PUNC">:</span><span class="NAME">this.keyMask</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragHandler</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.dragHandler.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.dragHandler</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>397</span> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragHandler</span><span class="PUNC">&&</span><span class="NAME">this.dragHandler.setMap</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">startBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"start"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBox</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createDiv</span><span class="PUNC">(</span><span class="STRN">"zoomBox"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">9999</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">9999</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.className</span><span class="PUNC">=</span><span class="NAME">this.boxDivClassName</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.style.zIndex</span><span class="PUNC">=</span><span class="NAME">this.map.Z_INDEX_BASE.Popup</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.map.viewPortDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.zoomBox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="STRN">"olDrawBox"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.dragHandler.start.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>398</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.dragHandler.start.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getBoxOffsets</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.style.width</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">f.width</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.style.height</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f.height</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.style.left</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">f.left</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">f.left</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.style.top</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f.top</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">f.top</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">endBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">5</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.dragHandler.start.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">5</span><span class="PUNC">&lt;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.dragHandler.start.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.dragHandler.start</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>399</span> </span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.dragHandler.start.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.removeBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"done"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.viewPortDiv.removeChild</span><span class="PUNC">(</span><span class="NAME">this.zoomBox</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boxOffsets</span><span class="PUNC">=</span><span class="NAME">this.zoomBox</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.removeClass</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="STRN">"olDrawBox"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.dragHandler.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>400</span> </span><span class="PUNC">(</span><span class="NAME">this.dragHandler.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.zoomBox</span><span class="PUNC">&&</span><span class="NAME">this.removeBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getBoxOffsets</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.boxOffsets</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="NAME">a.style.border</span><span class="PUNC">=</span><span class="STRN">"1px solid black"</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="STRN">"3px"</span><span class="PUNC">;</span><span class="NAME">document.body.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">==</span><span class="NAME">a.clientWidth</span><span class="PUNC">;</span><span class="NAME">document.body.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">this.zoomBox</span><span class="PUNC">,</span><span class="STRN">"border-left-width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">this.zoomBox</span><span class="PUNC">,</span><span class="STRN">"border-right-width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">this.zoomBox</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>401</span> </span><span class="STRN">"border-top-width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Element.getStyle</span><span class="PUNC">(</span><span class="NAME">this.zoomBox</span><span class="PUNC">,</span><span class="STRN">"border-bottom-width"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boxOffsets</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">left</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">right</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">top</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">bottom</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.boxOffsets</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.Box"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.ZoomBox</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Control.TYPE_TOOL</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">keyMask</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">alwaysZoom</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Box</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">done</span><span class="PUNC">:</span><span class="NAME">this.zoomBox</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">keyMask</span><span class="PUNC">:</span><span class="NAME">this.keyMask</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">zoomBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.out</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a.right</span><span class="PUNC">-</span><span class="NAME">a.left</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a.top</span><span class="PUNC">-</span><span class="NAME">a.bottom</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.map.size.h</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.map.size.w</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="NAME">a.getCenterPixel</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.lon</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>402</span> </span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.lon</span><span class="PUNC">+</span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.lat</span><span class="PUNC">-</span><span class="NAME">c.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d.lat</span><span class="PUNC">+</span><span class="NAME">c.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.bottom</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.top</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">b.lon</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">,</span><span class="NAME">c.lon</span><span class="PUNC">,</span><span class="NAME">c.lat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.zoomToExtent</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">==</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">this.alwaysZoom</span><span class="PUNC">&&</span><span class="NAME">this.map.zoomTo</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.out</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.out</span><span class="PUNC">?</span><span class="NAME">this.map.setCenter</span><span class="PUNC">(</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.map.setCenter</span><span class="PUNC">(</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>403</span> </span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.ZoomBox"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.DragPan</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Control.TYPE_TOOL</span><span class="PUNC">,</span><span class="NAME">panned</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">interval</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">documentDrag</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">kinetic</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">enableKinetic</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">kineticInterval</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.enableKinetic</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">interval</span><span class="PUNC">:</span><span class="NAME">this.kineticInterval</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="STRN">"object"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.enableKinetic</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.enableKinetic</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.kinetic</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Kinetic</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Drag</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">move</span><span class="PUNC">:</span><span class="NAME">this.panMap</span><span class="PUNC">,</span><span class="NAME">done</span><span class="PUNC">:</span><span class="NAME">this.panMapDone</span><span class="PUNC">,</span><span class="NAME">down</span><span class="PUNC">:</span><span class="NAME">this.panMapStart</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">interval</span><span class="PUNC">:</span><span class="NAME">this.interval</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>404</span> </span><span class="NAME">documentDrag</span><span class="PUNC">:</span><span class="NAME">this.documentDrag</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">panMapStart</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.kinetic</span><span class="PUNC">&&</span><span class="NAME">this.kinetic.begin</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">panMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.kinetic</span><span class="PUNC">&&</span><span class="NAME">this.kinetic.update</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.panned</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NAME">this.handler.last.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">this.handler.last.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">animate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">panMapDone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.panned</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.kinetic</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.kinetic.end</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NAME">this.handler.last.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">this.handler.last.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">animate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.kinetic.move</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.map.pan</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">dragging</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>405</span> </span><span class="NAME">animate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.panned</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.DragPan"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.MouseWheel</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">wheelListener</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">interval</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">delta</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">cumulative</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wheelListener</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bindAsEventListener</span><span class="PUNC">(</span><span class="NAME">this.onWheelEvent</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wheelListener</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onWheelEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.checkModifiers</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Event.element</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>406</span> </span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.currentStyle</span><span class="PUNC">?</span><span class="NAME">e.currentStyle.overflow</span><span class="PUNC">:</span><span class="NAME">document.defaultView.getComputedStyle</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getPropertyValue</span><span class="PUNC">(</span><span class="STRN">"overflow"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="STRN">"auto"</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">||</span><span class="STRN">"scroll"</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Element.hasClass</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="STRN">"olScrollable"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.map.layers.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.map.layers</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">i.div</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">i.pane</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">this.map.div</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.parentNode</span><span class="PUNC">}</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">window.event</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.wheelDelta</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.wheelDelta</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">%</span><span class="NUMB">160</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">0.75</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NUMB">120</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.detail</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a.detail</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>407</span> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a.detail</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.delta</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.interval</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this._timeoutId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._timeoutId</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.wheelZoom</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.interval</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.wheelZoom</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wheelZoom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.delta</span><span class="PUNC">;</span><span class="NAME">this.delta</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">=</span><span class="NAME">this.map.events.getMousePosition</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"down"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.cumulative</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="STRN">"up"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.cumulative</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>408</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.wheelListener</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"DOMMouseScroll"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"mousewheel"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="STRN">"mousewheel"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.wheelListener</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"DOMMouseScroll"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">window</span><span class="PUNC">,</span><span class="STRN">"mousewheel"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">document</span><span class="PUNC">,</span><span class="STRN">"mousewheel"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>409</span> </span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.MouseWheel"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.Navigation</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">dragPan</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">dragPanOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pinchZoom</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pinchZoomOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">documentDrag</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">zoomBox</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">zoomBoxEnabled</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">zoomWheelEnabled</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">mouseWheelOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">handleRightClicks</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">zoomBoxKeyMask</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Handler.MOD_SHIFT</span><span class="PUNC">,</span><span class="NAME">autoActivate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handlers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragPan</span><span class="PUNC">&&</span><span class="NAME">this.dragPan.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragPan</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>410</span> </span><span class="NAME">this.zoomBox</span><span class="PUNC">&&</span><span class="NAME">this.zoomBox.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBox</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.pinchZoom</span><span class="PUNC">&&</span><span class="NAME">this.pinchZoom.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pinchZoom</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dragPan.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomWheelEnabled</span><span class="PUNC">&&</span><span class="NAME">this.handlers.wheel.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers.click.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBoxEnabled</span><span class="PUNC">&&</span><span class="NAME">this.zoomBox.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pinchZoom</span><span class="PUNC">&&</span><span class="NAME">this.pinchZoom.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.pinchZoom</span><span class="PUNC">&&</span><span class="NAME">this.pinchZoom.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>411</span> </span><span class="NAME">this.zoomBox.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragPan.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers.click.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers.wheel.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleRightClicks</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.map.viewPortDiv.oncontextmenu</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.False</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers.click</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Click</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">click</span><span class="PUNC">:</span><span class="NAME">this.defaultClick</span><span class="PUNC">,</span><span class="NAME">dblclick</span><span class="PUNC">:</span><span class="NAME">this.defaultDblClick</span><span class="PUNC">,</span><span class="NAME">dblrightclick</span><span class="PUNC">:</span><span class="NAME">this.defaultDblRightClick</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="STRN">"double"</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">stopDouble</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragPan</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.DragPan</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">map</span><span class="PUNC">:</span><span class="NAME">this.map</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>412</span> </span><span class="NAME">documentDrag</span><span class="PUNC">:</span><span class="NAME">this.documentDrag</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.dragPanOptions</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBox</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.ZoomBox</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">map</span><span class="PUNC">:</span><span class="NAME">this.map</span><span class="PUNC">,</span><span class="NAME">keyMask</span><span class="PUNC">:</span><span class="NAME">this.zoomBoxKeyMask</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dragPan.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers.wheel</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.MouseWheel</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">up</span><span class="PUNC">:</span><span class="NAME">this.wheelUp</span><span class="PUNC">,</span><span class="NAME">down</span><span class="PUNC">:</span><span class="NAME">this.wheelDown</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.mouseWheelOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.PinchZoom</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.pinchZoom</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.PinchZoom</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">map</span><span class="PUNC">:</span><span class="NAME">this.map</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.pinchZoomOptions</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">defaultClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.lastTouches</span><span class="PUNC">&&</span><span class="NUMB">2</span><span class="PUNC">==</span><span class="NAME">a.lastTouches.length</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>413</span> </span><span class="NAME">this.map.zoomOut</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">defaultDblClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.setCenter</span><span class="PUNC">(</span><span class="NAME">this.map.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.map.zoom</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">defaultDblRightClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.setCenter</span><span class="PUNC">(</span><span class="NAME">this.map.getLonLatFromViewPortPx</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.map.zoom</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wheelChange</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map.fractionalZoom</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">this.map.getNumZoomLevels</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">a.xy.x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.xy.y</span><span class="PUNC">-</span><span class="NAME">e.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.map.baseLayer.getResolutionForZoom</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>414</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="NAME">a.xy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.setCenter</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">g.lon</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g.lat</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wheelUp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.wheelChange</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wheelDown</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.wheelChange</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">disableZoomBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomBoxEnabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.zoomBox.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enableZoomBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomBoxEnabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.active</span><span class="PUNC">&&</span><span class="NAME">this.zoomBox.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">disableZoomWheel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomWheelEnabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.handlers.wheel.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enableZoomWheel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoomWheelEnabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>415</span> </span><span class="NAME">this.active</span><span class="PUNC">&&</span><span class="NAME">this.handlers.wheel.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.Navigation"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.Feature</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">EVENTMAP</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">click</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">"in"</span><span class="PUNC">:</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="STRN">"clickout"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousemove</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">"in"</span><span class="PUNC">:</span><span class="STRN">"over"</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="STRN">"out"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dblclick</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">"in"</span><span class="PUNC">:</span><span class="STRN">"dblclick"</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">"in"</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">"in"</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchstart</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="STRN">"in"</span><span class="PUNC">:</span><span class="STRN">"click"</span><span class="PUNC">,</span><span class="NAME">out</span><span class="PUNC">:</span><span class="STRN">"clickout"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">lastFeature</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">down</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">up</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">touch</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">clickTolerance</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">geometryTypes</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">stopClick</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">stopDown</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">stopUp</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>416</span> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchstart</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.touch</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.touch</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.map.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="NAME">this.mousedown</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="NAME">this.mouseup</span><span class="PUNC">,</span><span class="NAME">mousemove</span><span class="PUNC">:</span><span class="NAME">this.mousemove</span><span class="PUNC">,</span><span class="NAME">click</span><span class="PUNC">:</span><span class="NAME">this.click</span><span class="PUNC">,</span><span class="NAME">dblclick</span><span class="PUNC">:</span><span class="NAME">this.dblclick</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.isMultiTouch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.mousedown</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">touchmove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousedown</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.isLeftClick</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">OpenLayers.Event.isSingleTouch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.down</span><span class="PUNC">=</span><span class="NAME">a.xy</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NAME">this.stopDown</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mouseup</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.up</span><span class="PUNC">=</span><span class="NAME">a.xy</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>417</span> </span><span class="PUNC">!</span><span class="NAME">this.stopUp</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">click</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.handle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NAME">this.stopClick</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mousemove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.callbacks.over</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.callbacks.out</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.handle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dblclick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">this.handle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">geometryTypeMatches</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.geometryTypes</span><span class="PUNC">||</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.geometryTypes</span><span class="PUNC">,</span><span class="NAME">a.geometry.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.feature</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.feature.layer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.feature</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.type</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">this.feature</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"click"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">"dblclick"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">"touchstart"</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>418</span> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.feature</span><span class="PUNC">=</span><span class="NAME">this.layer.getFeatureFromEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.feature.layer</span><span class="PUNC">)</span><span class="NAME">this.feature</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.lastFeature</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.lastFeature.layer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.lastFeature</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.feature</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="STRN">"touchstart"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.feature</span><span class="PUNC">!=</span><span class="NAME">this.lastFeature</span><span class="PUNC">,</span><span class="NAME">this.geometryTypeMatches</span><span class="PUNC">(</span><span class="NAME">this.feature</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.lastFeature</span><span class="PUNC">&&</span><span class="NAME">this.triggerCallback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"out"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.lastFeature</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.triggerCallback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"in"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.feature</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.triggerCallback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"in"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.feature</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.lastFeature</span><span class="PUNC">=</span><span class="NAME">this.feature</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.lastFeature</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>419</span> </span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.triggerCallback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"out"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.lastFeature</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.feature</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.lastFeature</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.triggerCallback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"out"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">this.lastFeature</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">triggerCallback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.EVENTMAP</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"click"</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.up</span><span class="PUNC">&&</span><span class="NAME">this.down</span><span class="PUNC">?</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.up.x</span><span class="PUNC">-</span><span class="NAME">this.down.x</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.up.y</span><span class="PUNC">-</span><span class="NAME">this.down.y</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">this.clickTolerance</span><span class="PUNC">&&</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.moveLayerToTop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>420</span> </span><span class="NAME">this.map.events.on</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">removelayer</span><span class="PUNC">:</span><span class="NAME">this.handleMapEvents</span><span class="PUNC">,</span><span class="NAME">changelayer</span><span class="PUNC">:</span><span class="NAME">this.handleMapEvents</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.moveLayerBack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.up</span><span class="PUNC">=</span><span class="NAME">this.down</span><span class="PUNC">=</span><span class="NAME">this.lastFeature</span><span class="PUNC">=</span><span class="NAME">this.feature</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.touch</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.map.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">removelayer</span><span class="PUNC">:</span><span class="NAME">this.handleMapEvents</span><span class="PUNC">,</span><span class="NAME">changelayer</span><span class="PUNC">:</span><span class="NAME">this.handleMapEvents</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleMapEvents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">(</span><span class="STRN">"removelayer"</span><span class="PUNC">==</span><span class="NAME">a.type</span><span class="PUNC">||</span><span class="STRN">"order"</span><span class="PUNC">==</span><span class="NAME">a.property</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.moveLayerToTop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>421</span> </span><span class="NAME">moveLayerToTop</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layer.setZIndex</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.map.Z_INDEX_BASE.Feature</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.layer.getZIndex</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveLayerBack</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.layer.getZIndex</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">this.map.Z_INDEX_BASE.Feature</span><span class="PUNC">?</span><span class="NAME">this.layer.setZIndex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.map.setLayerZIndex</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">,</span><span class="NAME">this.map.getLayerIndex</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.Feature"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Events.buttonclick</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">target</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">events</span><span class="PUNC">:</span><span class="STRN">"mousedown mouseup click dblclick touchstart touchmove touchend keydown"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">startRegEx</span><span class="PUNC">:</span><span class="REGX">/^mousedown|touchstart$/</span><span class="PUNC">,</span><span class="NAME">cancelRegEx</span><span class="PUNC">:</span><span class="REGX">/^touchmove$/</span><span class="PUNC">,</span><span class="NAME">completeRegEx</span><span class="PUNC">:</span><span class="REGX">/^mouseup|touchend$/</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.events.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.target.register</span><span class="PUNC">(</span><span class="NAME">this.events</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.buttonClick</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">extension</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.events.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.target.unregister</span><span class="PUNC">(</span><span class="NAME">this.events</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.buttonClick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>422</span> </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.target</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getPressedButton</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">do</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Element.hasClass</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"olButton"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.parentNode</span><span class="PUNC">}</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="PUNC">--</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">buttonClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Event.element</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Event.isLeftClick</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="PUNC">~</span><span class="NAME">a.type.indexOf</span><span class="PUNC">(</span><span class="STRN">"mouse"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getPressedButton</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"keydown"</span><span class="PUNC">===</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.keyCode</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.KEY_RETURN</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.KEY_SPACE</span><span class="PUNC">:</span><span class="NAME">this.target.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">buttonElement</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>423</span> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.startEvt</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.completeRegEx.test</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.pagePosition</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.target.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">buttonElement</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">buttonXY</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.startEvt.clientX</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.startEvt.clientY</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.cancelRegEx.test</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.startEvt</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.startRegEx.test</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.startEvt</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.startEvt</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.XYZ</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.Grid</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">sphericalMercator</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">zoomOffset</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">serverResolutions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.sphericalMercator</span><span class="PUNC">||</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">projection</span><span class="PUNC">:</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">,</span><span class="NAME">numZoomLevels</span><span class="PUNC">:</span><span class="NUMB">19</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Grid.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.XYZ</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Grid.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>424</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getURL</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getXYZ</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.url</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.selectUrl</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">+</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.String.format</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getXYZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getServerResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.left</span><span class="PUNC">-</span><span class="NAME">this.maxExtent.left</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.tileSize.w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">this.maxExtent.top</span><span class="PUNC">-</span><span class="NAME">a.top</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.tileSize.h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getServerZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.wrapDateLine</span><span class="PUNC">)</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">%</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.Grid.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>425</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileOrigin</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.tileOrigin</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">this.maxExtent.left</span><span class="PUNC">,</span><span class="NAME">this.maxExtent.bottom</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.XYZ"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Tile.UTFGrid</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Tile</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">utfgridResolution</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">json</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Tile.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Tile.prototype.draw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isLoading</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.abortLoading</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"reload"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loadstart"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">this.layer.getURL</span><span class="PUNC">(</span><span class="NAME">this.bounds</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layer.useJSONP</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Script</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>426</span> </span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loadend"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.json</span><span class="PUNC">=</span><span class="NAME">a.data</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.read</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.request</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.request</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request.GET</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"loadend"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.status</span><span class="PUNC">===</span><span class="NUMB">200</span><span class="PUNC">&&</span><span class="NAME">this.parseData</span><span class="PUNC">(</span><span class="NAME">a.responseText</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.unload</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">abortLoading</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.request</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.request.abort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.request</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.isLoading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureInfo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.json</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>427</span> </span><span class="NAME">this.getFeatureId</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="NAME">this.json.data</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureId</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.json</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.utfgridResolution</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.indexFromCharCode</span><span class="PUNC">(</span><span class="NAME">this.json.grid</span><span class="PUNC">[</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">charCodeAt</span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.json.keys</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">indexFromCharCode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">93</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NUMB">35</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">32</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseData</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.format</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.format</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.JSON</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.json</span><span class="PUNC">=</span><span class="NAME">this.format.read</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.json</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>428</span> </span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Tile.UTFGrid"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.UTFGrid</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.XYZ</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">projection</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">useJSONP</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">tileClass</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Tile.UTFGrid</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.Grid.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.name</span><span class="PUNC">,</span><span class="NAME">a.url</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileOptions</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">utfgridResolution</span><span class="PUNC">:</span><span class="NAME">this.utfgridResolution</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.tileOptions</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.UTFGrid</span><span class="PUNC">(</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Grid.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>429</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureInfo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getTileData</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.tile</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.tile.getFeatureInfo</span><span class="PUNC">(</span><span class="NAME">a.i</span><span class="PUNC">,</span><span class="NAME">a.j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureId</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getTileData</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.tile</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.tile.getFeatureId</span><span class="PUNC">(</span><span class="NAME">a.i</span><span class="PUNC">,</span><span class="NAME">a.j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.UTFGrid"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.WMS</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.Grid</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">DEFAULT_PARAMS</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">service</span><span class="PUNC">:</span><span class="STRN">"WMS"</span><span class="PUNC">,</span><span class="NAME">version</span><span class="PUNC">:</span><span class="STRN">"1.1.1"</span><span class="PUNC">,</span><span class="NAME">request</span><span class="PUNC">:</span><span class="STRN">"GetMap"</span><span class="PUNC">,</span><span class="NAME">styles</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="STRN">"image/jpeg"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">encodeBBOX</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">noMagic</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">yx</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1.3</span><span class="PUNC">&lt;=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">c.VERSION</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">c.EXCEPTIONS</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.EXCEPTIONS</span><span class="PUNC">=</span><span class="STRN">"INIMAGE"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Grid.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">this.params</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">(</span><span class="NAME">this.DEFAULT_PARAMS</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>430</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.noMagic</span><span class="PUNC">&&</span><span class="NAME">this.params.TRANSPARENT</span><span class="PUNC">&&</span><span class="STRN">"true"</span><span class="PUNC">==</span><span class="NAME">this.params.TRANSPARENT.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">d.isBaseLayer</span><span class="PUNC">)</span><span class="NAME">this.isBaseLayer</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="STRN">"image/jpeg"</span><span class="PUNC">==</span><span class="NAME">this.params.FORMAT</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.params.FORMAT</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.alphaHack</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"image/gif"</span><span class="PUNC">:</span><span class="STRN">"image/png"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.WMS</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">this.params</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Grid.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">reverseAxisOrder</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.projection.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1.3</span><span class="PUNC">&lt;=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">this.params.VERSION</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>431</span> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.yx</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Projection.defaults</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">yx</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getURL</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.adjustBounds</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getImageSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.reverseAxisOrder</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.BBOX</span><span class="PUNC">=</span><span class="NAME">this.encodeBBOX</span><span class="PUNC">?</span><span class="NAME">a.toBBOX</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.toArray</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.WIDTH</span><span class="PUNC">=</span><span class="NAME">b.w</span><span class="PUNC">;</span><span class="NAME">c.HEIGHT</span><span class="PUNC">=</span><span class="NAME">b.h</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getFullRequestString</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mergeNewParams</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Grid.prototype.mergeNewParams.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFullRequestString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getProjectionObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.projection</span><span class="PUNC">&&</span><span class="NAME">this.projection.equals</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>432</span> </span><span class="NAME">this.projection.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c.getCode</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NUMB">1.3</span><span class="PUNC">&lt;=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">this.params.VERSION</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.params.CRS</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">this.params.SRS</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="STRN">"boolean"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">this.params.TRANSPARENT</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.TRANSPARENT</span><span class="PUNC">=</span><span class="NAME">this.params.TRANSPARENT</span><span class="PUNC">?</span><span class="STRN">"TRUE"</span><span class="PUNC">:</span><span class="STRN">"FALSE"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Grid.prototype.getFullRequestString.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.WMS"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.StyleMap</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">styles</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">extendDefault</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.styles</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="STRN">"default"</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Feature.Vector.style</span><span class="PUNC">[</span><span class="STRN">"default"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">select</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Feature.Vector.style.select</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">temporary</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Feature.Vector.style.temporary</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="STRN">"delete"</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Feature.Vector.style</span><span class="PUNC">[</span><span class="STRN">"delete"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">)</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="STRN">"default"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.styles.select</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.styles.temporary</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="STRN">"delete"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>433</span> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">)</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="STRN">"default"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styles.select</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styles.temporary</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="STRN">"delete"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Style</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.styles</span><span class="PUNC">)</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styles</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createSymbolizer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>434</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"default"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.renderIntent</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.extendDefault</span><span class="PUNC">&&</span><span class="STRN">"default"</span><span class="PUNC">!=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="STRN">"default"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">createSymbolizer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">createSymbolizer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addUniqueValueRules</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Rule</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">symbolizer</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">context</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">filter</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Filter.Comparison</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Filter.Comparison.EQUAL_TO</span><span class="PUNC">,</span><span class="NAME">property</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styles</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addRules</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.StyleMap"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Vector</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">isFixed</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">features</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">filter</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">selectedFeatures</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">unrenderedFeatures</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">reportError</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">styleMap</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">strategies</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">protocol</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">renderers</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"SVG"</span><span class="PUNC">,</span><span class="STRN">"VML"</span><span class="PUNC">,</span><span class="STRN">"Canvas"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">renderer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">rendererOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">geometryType</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">drawn</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ratio</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.renderer</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">this.renderer.supported</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.assignRenderer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.renderer</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>435</span> </span><span class="PUNC">!</span><span class="NAME">this.renderer.supported</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">this.renderer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.displayError</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.styleMap</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.styleMap</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.StyleMap</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.selectedFeatures</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.strategies</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.strategies.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.strategies</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setLayer</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.strategies</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.strategies.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.strategies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.autoDestroy</span><span class="PUNC">&&</span><span class="NAME">a.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.strategies</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="NAME">this.protocol</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.protocol.autoDestroy</span><span class="PUNC">&&</span><span class="NAME">this.protocol.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>436</span> </span><span class="NAME">this.protocol</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.destroyFeatures</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">=</span><span class="NAME">this.selectedFeatures</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.renderer</span><span class="PUNC">&&</span><span class="NAME">this.renderer.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.drawn</span><span class="PUNC">=</span><span class="NAME">this.geometryType</span><span class="PUNC">=</span><span class="NAME">this.renderer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Vector</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.features</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">refresh</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.calculateInRange</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>437</span> </span><span class="NAME">this.visibility</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"refresh"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">assignRenderer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.renderers.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.renderers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"function"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Renderer</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.prototype.supported</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.renderer</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">,</span><span class="NAME">this.rendererOptions</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">displayError</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.reportError</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Console.userError</span><span class="PUNC">(</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"browserNotSupported"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">renderers</span><span class="PUNC">:</span><span class="NAME">this.renderers.join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>438</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.renderer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.renderer.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.w</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.ratio</span><span class="PUNC">;</span><span class="NAME">b.h</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.ratio</span><span class="PUNC">;</span><span class="NAME">this.renderer.setSize</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.map.removeLayer</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">afterAdd</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.strategies</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.strategies.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.strategies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.autoActivate</span><span class="PUNC">&&</span><span class="NAME">a.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.drawn</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.strategies</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.strategies.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.strategies</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.autoActivate</span><span class="PUNC">&&</span><span class="NAME">a.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onMapResize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.onMapResize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>439</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.w</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.ratio</span><span class="PUNC">;</span><span class="NAME">a.h</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.ratio</span><span class="PUNC">;</span><span class="NAME">this.renderer.setSize</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.moveTo.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.renderer.root.style.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.w</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">this.ratio</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.left</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">this.map.layerContainerDiv.style.top</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div.style.left</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">this.div.style.top</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>440</span> </span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.renderer.setExtent</span><span class="PUNC">(</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">scale</span><span class="PUNC">(</span><span class="NAME">this.ratio</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.renderer.root.style.visibility</span><span class="PUNC">=</span><span class="STRN">"visible"</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">OpenLayers.IS_GECKO</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.div.scrollLeft</span><span class="PUNC">=</span><span class="NAME">this.div.scrollLeft</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.drawFeature</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.drawn</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.drawn</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.features.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.renderer.locked</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.drawFeature</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.display.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>441</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.div.style.display</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">!=</span><span class="NAME">this.renderer.root.style.display</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.renderer.root.style.display</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">b.silent</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">features</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeaturesadded"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.features</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.renderer.locked</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.geometryType</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">g.geometry</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">this.geometryType</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">TypeError</span><span class="PUNC">(</span><span class="STRN">"addFeatures: component should be an "</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>442</span> </span><span class="NAME">this.geometryType.prototype.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.layer</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">g.style</span><span class="PUNC">&&</span><span class="NAME">this.style</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.style</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.style</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeatureadded"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">this.preFeatureInsert</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.features.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.drawFeature</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featureadded"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.onFeatureInsert</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featuresadded"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">features</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">this.features</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.removeAllFeatures</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>443</span> </span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">this.selectedFeatures</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">b.silent</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeaturesremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">features</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.renderer.locked</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">geometry</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">[</span><span class="NAME">e.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeatureremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.features</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.layer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">e.geometry</span><span class="PUNC">&&</span><span class="NAME">this.renderer.eraseFeatures</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.selectedFeatures</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>444</span> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.selectedFeatures</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featureremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featuresremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">features</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeAllFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">a.silent</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeaturesremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">features</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeatureremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.layer</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featureremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.renderer.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>445</span> </span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.selectedFeatures</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featuresremoved"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">features</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.removeFeatures</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.drawn</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.state</span><span class="PUNC">===</span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"delete"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">a.renderIntent</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.style</span><span class="PUNC">||</span><span class="NAME">this.style</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.styleMap.createSymbolizer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.renderer.drawFeature</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>446</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">||</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.unrenderedFeatures</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">eraseFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.renderer.eraseFeatures</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureFromEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.renderer</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.renderer.getFeatureIdFromEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"string"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.getFeatureById</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureBy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>447</span> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.features.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureById</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getFeatureBy</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureByFid</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getFeatureBy</span><span class="PUNC">(</span><span class="STRN">"fid"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeaturesByAttribute</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.features.length</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">d.attributes</span><span class="PUNC">&&</span><span class="NAME">d.attributes</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onFeatureInsert</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">preFeatureInsert</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getDataExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>448</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">geometry</span><span class="PUNC">)</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.extend</span><span class="PUNC">(</span><span class="NAME">c.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.Vector"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Geometry.MultiLineString</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">componentTypes</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">split</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.mutual</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">o</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.split</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="NAME">i.length</span><span class="PUNC">?</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">i.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addComponent</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">i.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiLineString</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.unshift</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>449</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Array.prototype.splice.apply</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">i.length</span><span class="PUNC">?</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">i.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addComponent</span><span class="PUNC">(</span><span class="NAME">f.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiLineString</span><span class="PUNC">(</span><span class="NAME">f.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">i.length</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">j.length</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">||</span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">splitWith</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.mutual</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">this.components.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">o</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.components</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">i.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.unshift</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>450</span> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Array.prototype.splice.apply</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">f.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">j.length</span><span class="PUNC">?</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">j.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addComponent</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiLineString</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">j.length</span><span class="PUNC">?</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">j.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addComponent</span><span class="PUNC">(</span><span class="NAME">f.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiLineString</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">f.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">i.length</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">j.length</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">||</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Geometry.MultiLineString"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.GeoJSON</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Format.JSON</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">ignoreExtraDims</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="STRN">"FeatureCollection"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Format.JSON.prototype.read.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"string"</span><span class="PUNC">!=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">e.type</span><span class="PUNC">)</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="STRN">"Bad GeoJSON - no type: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isValidType</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Geometry"</span><span class="PUNC">:</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.parseGeometry</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Feature"</span><span class="PUNC">:</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.parseFeature</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.type</span><span class="PUNC">=</span><span class="STRN">"Feature"</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>451</span> </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"FeatureCollection"</span><span class="PUNC">:</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Feature"</span><span class="PUNC">:</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">this.parseFeature</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"FeatureCollection"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.features.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">this.parseFeature</span><span class="PUNC">(</span><span class="NAME">e.features</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.parseGeometry</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="STRN">"Bad JSON: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isValidType</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>452</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Geometry"</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="STRN">"Point MultiPoint LineString MultiLineString Polygon MultiPolygon Box GeometryCollection"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="STRN">"Unsupported geometry type: "</span><span class="PUNC">+</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"FeatureCollection"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">a.type</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Console.error</span><span class="PUNC">(</span><span class="STRN">"Cannot convert types from "</span><span class="PUNC">+</span><span class="NAME">a.type</span><span class="PUNC">+</span><span class="STRN">" to "</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.properties</span><span class="PUNC">?</span><span class="NAME">a.properties</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">&&</span><span class="NAME">a.geometry.bbox</span><span class="PUNC">||</span><span class="NAME">a.bbox</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.parseGeometry</span><span class="PUNC">(</span><span class="NAME">a.geometry</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>453</span> </span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.bounds</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Bounds.fromArray</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.id</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.fid</span><span class="PUNC">=</span><span class="NAME">a.id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"GeometryCollection"</span><span class="PUNC">==</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a.geometries</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"GeometryCollection must have geometries array: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.geometries.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.parseGeometry.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.geometries</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Collection</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a.coordinates</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"Geometry must have coordinates array: "</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>454</span> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.parseCoords</span><span class="PUNC">[</span><span class="NAME">a.type.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"Unsupported geometry type: "</span><span class="PUNC">+</span><span class="NAME">a.type</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.parseCoords</span><span class="PUNC">[</span><span class="NAME">a.type.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.coordinates</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.internalProjection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.externalProjection</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.transform</span><span class="PUNC">(</span><span class="NAME">this.externalProjection</span><span class="PUNC">,</span><span class="NAME">this.internalProjection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseCoords</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">point</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">this.ignoreExtraDims</span><span class="PUNC">&&</span><span class="NUMB">2</span><span class="PUNC">!=</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"Only 2D points are supported: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multipoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>455</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.parseCoords.point.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">linestring</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.parseCoords.point.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multilinestring</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.parseCoords.linestring.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiLineString</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>456</span> </span><span class="NAME">polygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.parseCoords.linestring.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LinearRing</span><span class="PUNC">(</span><span class="NAME">d.components</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Polygon</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multipolygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.parseCoords.polygon.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.MultiPolygon</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">box</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">!=</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"GeoJSON box coordinates must have 2 elements"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>457</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Polygon</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LinearRing</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">write</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.type</span><span class="PUNC">=</span><span class="STRN">"FeatureCollection"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c.features</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"FeatureCollection only supports collections of features: "</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>458</span> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c.features</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.extract.feature.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.CLASS_NAME.indexOf</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry"</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.extract.geometry.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.extract.feature.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.layer</span><span class="PUNC">&&</span><span class="NAME">a.layer.projection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.crs</span><span class="PUNC">=</span><span class="NAME">this.createCRSObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.JSON.prototype.write.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createCRSObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.layer.projection.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.match</span><span class="PUNC">(</span><span class="REGX">/epsg:/i</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">":"</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">4326</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"name"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>459</span> </span><span class="NAME">properties</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">name</span><span class="PUNC">:</span><span class="STRN">"urn:ogc:def:crs:OGC:1.3:CRS84"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"name"</span><span class="PUNC">,</span><span class="NAME">properties</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">name</span><span class="PUNC">:</span><span class="STRN">"EPSG:"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extract</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.extract.geometry.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.geometry</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"Feature"</span><span class="PUNC">,</span><span class="NAME">properties</span><span class="PUNC">:</span><span class="NAME">a.attributes</span><span class="PUNC">,</span><span class="NAME">geometry</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a.fid</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.id</span><span class="PUNC">=</span><span class="NAME">a.fid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">geometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.internalProjection</span><span class="PUNC">&&</span><span class="NAME">this.externalProjection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.transform</span><span class="PUNC">(</span><span class="NAME">this.internalProjection</span><span class="PUNC">,</span><span class="NAME">this.externalProjection</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.CLASS_NAME.split</span><span class="PUNC">(</span><span class="STRN">"."</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.extract</span><span class="PUNC">[</span><span class="NAME">b.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>460</span> </span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="STRN">"Collection"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"GeometryCollection"</span><span class="PUNC">,</span><span class="NAME">geometries</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">coordinates</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">point</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multipoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.extract.point.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">linestring</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.extract.point.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multilinestring</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.extract.linestring.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>461</span> </span><span class="PUNC">[</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">polygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.extract.linestring.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multipolygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.extract.polygon.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">collection</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.components.length</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.extract.geometry.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Format.GeoJSON"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.Script</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Protocol</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">params</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">callbackTemplate</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Protocol.Script.registry.${id}"</span><span class="PUNC">,</span><span class="NAME">callbackKey</span><span class="PUNC">:</span><span class="STRN">"callback"</span><span class="PUNC">,</span><span class="NAME">callbackPrefix</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pendingRequests</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">srsInBBOX</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.params</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.pendingRequests</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.format</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.format</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.GeoJSON</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.filterToParams</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Format.QueryStringFilter</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>462</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.QueryStringFilter</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">srsInBBOX</span><span class="PUNC">:</span><span class="NAME">this.srsInBBOX</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.filterToParams</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.write</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Protocol.prototype.read.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.params</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a.params</span><span class="PUNC">,</span><span class="NAME">this.options.params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.filter</span><span class="PUNC">&&</span><span class="NAME">this.filterToParams</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.params</span><span class="PUNC">=</span><span class="NAME">this.filterToParams</span><span class="PUNC">(</span><span class="NAME">a.filter</span><span class="PUNC">,</span><span class="NAME">a.params</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">requestType</span><span class="PUNC">:</span><span class="STRN">"read"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.createRequest</span><span class="PUNC">(</span><span class="NAME">a.url</span><span class="PUNC">,</span><span class="NAME">a.params</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.data</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>463</span> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.handleRead</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.priv</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createRequest</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Protocol.Script.register</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.String.format</span><span class="PUNC">(</span><span class="NAME">this.callbackTemplate</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">this.callbackKey</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.callbackPrefix</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.urlAppend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.getParameterString</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"script"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.type</span><span class="PUNC">=</span><span class="STRN">"text/javascript"</span><span class="PUNC">;</span><span class="NAME">b.src</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b.id</span><span class="PUNC">=</span><span class="STRN">"OpenLayers_Protocol_Script_"</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.pendingRequests</span><span class="PUNC">[</span><span class="NAME">b.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">document.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"head"</span><span class="PUNC">)</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>464</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroyRequest</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Protocol.Script.unregister</span><span class="PUNC">(</span><span class="NAME">a.id.split</span><span class="PUNC">(</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.pendingRequests</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.parentNode</span><span class="PUNC">&&</span><span class="NAME">a.parentNode.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleRead</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleResponse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleResponse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.callback</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.data</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.features</span><span class="PUNC">=</span><span class="NAME">this.parseFeatures</span><span class="PUNC">(</span><span class="NAME">a.data</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.code</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Protocol.Response.SUCCESS</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.code</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Protocol.Response.FAILURE</span><span class="PUNC">,</span><span class="NAME">this.destroyRequest</span><span class="PUNC">(</span><span class="NAME">a.priv</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.callback.call</span><span class="PUNC">(</span><span class="NAME">b.scope</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.format.read</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>465</span> </span><span class="NAME">abort</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.destroyRequest</span><span class="PUNC">(</span><span class="NAME">a.priv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.pendingRequests</span><span class="PUNC">)</span><span class="NAME">this.destroyRequest</span><span class="PUNC">(</span><span class="NAME">this.pendingRequests</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.abort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.params</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.format</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Protocol.Script"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Protocol.Script</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a.registry</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.register</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">"c"</span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a.registry</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.unregister</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a.registry</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.OSM</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.XYZ</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">name</span><span class="PUNC">:</span><span class="STRN">"OpenStreetMap"</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"http://a.tile.openstreetmap.org/${z}/${x}/${y}.png"</span><span class="PUNC">,</span><span class="STRN">"http://b.tile.openstreetmap.org/${z}/${x}/${y}.png"</span><span class="PUNC">,</span><span class="STRN">"http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">attribution</span><span class="PUNC">:</span><span class="STRN">"Data CC-By-SA by &lt;a href='http://openstreetmap.org/'>OpenStreetMap&lt;/a>"</span><span class="PUNC">,</span><span class="NAME">sphericalMercator</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">wrapDateLine</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">tileOptions</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.XYZ.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.tileOptions</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">crossOriginKeyword</span><span class="PUNC">:</span><span class="STRN">"anonymous"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>466</span> </span><span class="NAME">this.options</span><span class="PUNC">&&</span><span class="NAME">this.options.tileOptions</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.OSM</span><span class="PUNC">(</span><span class="NAME">this.name</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="NAME">this.getOptions</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.XYZ.prototype.clone.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.OSM"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.SVG</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Renderer.Elements</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">xmlns</span><span class="PUNC">:</span><span class="STRN">"http://www.w3.org/2000/svg"</span><span class="PUNC">,</span><span class="NAME">xlinkns</span><span class="PUNC">:</span><span class="STRN">"http://www.w3.org/1999/xlink"</span><span class="PUNC">,</span><span class="NAME">MAX_PIXEL</span><span class="PUNC">:</span><span class="NUMB">15</span><span class="NAME">E3</span><span class="PUNC">,</span><span class="NAME">translationParameters</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">symbolMetrics</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.supported</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Renderer.Elements.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.translationParameters</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">this.symbolMetrics</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">supported</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">document.implementation</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">document.implementation.hasFeature</span><span class="PUNC">(</span><span class="STRN">"org.w3c.svg"</span><span class="PUNC">,</span><span class="STRN">"1.0"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">document.implementation.hasFeature</span><span class="PUNC">(</span><span class="STRN">"http://www.w3.org/TR/SVG11/feature#SVG"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>467</span> </span><span class="STRN">"1.1"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">document.implementation.hasFeature</span><span class="PUNC">(</span><span class="STRN">"http://www.w3.org/TR/SVG11/feature#BasicStructure"</span><span class="PUNC">,</span><span class="STRN">"1.1"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">inValidRange</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.translationParameters.x</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.translationParameters.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">>=</span><span class="PUNC">-</span><span class="NAME">this.MAX_PIXEL</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">this.MAX_PIXEL</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">>=</span><span class="PUNC">-</span><span class="NAME">this.MAX_PIXEL</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">this.MAX_PIXEL</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Elements.prototype.setExtent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a.left</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.top</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">this.rendererRoot.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>468</span> </span><span class="STRN">"viewBox"</span><span class="PUNC">,</span><span class="STRN">"0 0 "</span><span class="PUNC">+</span><span class="NAME">this.size.w</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">this.size.h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.translate</span><span class="PUNC">(</span><span class="NAME">this.xOffset</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.translate</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">this.left</span><span class="PUNC">+</span><span class="NAME">this.xOffset</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">this.top</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.setExtent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.inValidRange</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"translate("</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">;</span><span class="NAME">this.root.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"transform"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.translationParameters</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Renderer.prototype.setSize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rendererRoot.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">this.size.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>469</span> </span><span class="NAME">this.rendererRoot.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">this.size.h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNodeType</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.externalGraphic</span><span class="PUNC">?</span><span class="STRN">"image"</span><span class="PUNC">:</span><span class="NAME">this.isComplexSymbol</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="STRN">"svg"</span><span class="PUNC">:</span><span class="STRN">"circle"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Rectangle"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"rect"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"polyline"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"polygon"</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Curve"</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"path"</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>470</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">a._style</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">a._options</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.title</span><span class="PUNC">||</span><span class="NAME">b.graphicTitle</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"title"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"title"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">e.length</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">firstChild.textContent</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"title"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.textContent</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.getAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"r"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">==</span><span class="NAME">a._geometryClass</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.style.visibility</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b.graphic</span><span class="PUNC">)</span><span class="NAME">a.style.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.externalGraphic</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getPosition</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.graphicWidth</span><span class="PUNC">&&</span><span class="NAME">b.graphicHeight</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>471</span> </span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"preserveAspectRatio"</span><span class="PUNC">,</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.graphicWidth</span><span class="PUNC">||</span><span class="NAME">b.graphicHeight</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.graphicHeight</span><span class="PUNC">||</span><span class="NAME">b.graphicWidth</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b.graphicYOffset</span><span class="PUNC">?</span><span class="NAME">b.graphicYOffset</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b.graphicOpacity</span><span class="PUNC">||</span><span class="NAME">b.fillOpacity</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b.graphicXOffset</span><span class="PUNC">?</span><span class="NAME">b.graphicXOffset</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toFixed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">f.y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toFixed</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="NAME">this.xlinkns</span><span class="PUNC">,</span><span class="STRN">"href"</span><span class="PUNC">,</span><span class="NAME">b.externalGraphic</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>472</span> </span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"style"</span><span class="PUNC">,</span><span class="STRN">"opacity: "</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.onclick</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.SVG.preventDefault</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isComplexSymbol</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.importSymbol</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getPosition</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">this.symbolMetrics</span><span class="PUNC">[</span><span class="NAME">j.id</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.parentNode</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.nextSibling</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">h.removeChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.firstChild</span><span class="PUNC">&&</span><span class="NAME">a.removeChild</span><span class="PUNC">(</span><span class="NAME">a.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">j.firstChild.cloneNode</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"viewBox"</span><span class="PUNC">,</span><span class="NAME">j.getAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"viewBox"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>473</span> </span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">f.x</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">?</span><span class="NAME">h.insertBefore</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">h.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">b.pointRadius</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.rotation</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a._rotation</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">)</span><span class="NAME">a._rotation</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="STRN">"svg"</span><span class="PUNC">!==</span><span class="NAME">a.nodeName</span><span class="PUNC">?</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"transform"</span><span class="PUNC">,</span><span class="STRN">"rotate("</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">f.y</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.symbolMetrics</span><span class="PUNC">[</span><span class="NAME">j.id</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.firstChild.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"transform"</span><span class="PUNC">,</span><span class="STRN">"rotate("</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c.isFilled</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">b.fillColor</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>474</span> </span><span class="STRN">"fill-opacity"</span><span class="PUNC">,</span><span class="NAME">b.fillOpacity</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.isStroked</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">b.strokeColor</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke-opacity"</span><span class="PUNC">,</span><span class="NAME">b.strokeOpacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke-width"</span><span class="PUNC">,</span><span class="NAME">b.strokeWidth</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke-linecap"</span><span class="PUNC">,</span><span class="NAME">b.strokeLinecap</span><span class="PUNC">||</span><span class="STRN">"round"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke-linejoin"</span><span class="PUNC">,</span><span class="STRN">"round"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.strokeDashstyle</span><span class="PUNC">&&</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke-dasharray"</span><span class="PUNC">,</span><span class="NAME">this.dashStyle</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.pointerEvents</span><span class="PUNC">&&</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>475</span> </span><span class="STRN">"pointer-events"</span><span class="PUNC">,</span><span class="NAME">b.pointerEvents</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">b.cursor</span><span class="PUNC">&&</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"cursor"</span><span class="PUNC">,</span><span class="NAME">b.cursor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dashStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.strokeWidth</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.strokeDashstyle</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"solid"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dot"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dash"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"dashdot"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"longdash"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"longdashdot"</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.String.trim</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="REGX">/\s+/g</span><span class="PUNC">,</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createNode</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.createElementNS</span><span class="PUNC">(</span><span class="NAME">this.xmlns</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>476</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">c.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"id"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">nodeTypeCompare</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">==</span><span class="NAME">a.nodeName</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createRenderRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="STRN">"_svgRoot"</span><span class="PUNC">,</span><span class="STRN">"svg"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.display</span><span class="PUNC">=</span><span class="STRN">"block"</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createRoot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"g"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createDefs</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="STRN">"_defs"</span><span class="PUNC">,</span><span class="STRN">"defs"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rendererRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawCircle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawCircle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>477</span> </span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.inValidRange</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"cx"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"cy"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLineString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getComponentsString</span><span class="PUNC">(</span><span class="NAME">b.components</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c.path</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"points"</span><span class="PUNC">,</span><span class="NAME">c.path</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.complete</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLinearRing</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getComponentsString</span><span class="PUNC">(</span><span class="NAME">b.components</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c.path</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"points"</span><span class="PUNC">,</span><span class="NAME">c.path</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.complete</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>478</span> </span><span class="NAME">drawPolygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b.components.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">" M"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getComponentsString</span><span class="PUNC">(</span><span class="NAME">b.components</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">components</span><span class="PUNC">,</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.path</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f.complete</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"d"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">" z"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"fill-rule"</span><span class="PUNC">,</span><span class="STRN">"evenodd"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawRectangle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.inValidRange</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>479</span> </span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">b.width</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">b.height</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">b.labelOutlineWidth</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.fontColor</span><span class="PUNC">=</span><span class="NAME">e.labelOutlineColor</span><span class="PUNC">;</span><span class="NAME">e.fontStrokeColor</span><span class="PUNC">=</span><span class="NAME">e.labelOutlineColor</span><span class="PUNC">;</span><span class="NAME">e.fontStrokeWidth</span><span class="PUNC">=</span><span class="NAME">b.labelOutlineWidth</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">e.labelOutlineWidth</span><span class="PUNC">;</span><span class="NAME">this.drawText</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c.y</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">this.top</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">this.LABEL_OUTLINE_SUFFIX</span><span class="PUNC">:</span><span class="NAME">this.LABEL_ID_SUFFIX</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="STRN">"text"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>480</span> </span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontColor</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">b.fontColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontStrokeColor</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">b.fontStrokeColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontStrokeWidth</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"stroke-width"</span><span class="PUNC">,</span><span class="NAME">b.fontStrokeWidth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontOpacity</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"opacity"</span><span class="PUNC">,</span><span class="NAME">b.fontOpacity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontFamily</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"font-family"</span><span class="PUNC">,</span><span class="NAME">b.fontFamily</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontSize</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"font-size"</span><span class="PUNC">,</span><span class="NAME">b.fontSize</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontWeight</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"font-weight"</span><span class="PUNC">,</span><span class="NAME">b.fontWeight</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.fontStyle</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>481</span> </span><span class="STRN">"font-style"</span><span class="PUNC">,</span><span class="NAME">b.fontStyle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.labelSelect</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"pointer-events"</span><span class="PUNC">,</span><span class="STRN">"visible"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f._featureId</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"pointer-events"</span><span class="PUNC">,</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.labelAlign</span><span class="PUNC">||</span><span class="NAME">OpenLayers.Renderer.defaultSymbolizer.labelAlign</span><span class="PUNC">;</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"text-anchor"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_ALIGN</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="STRN">"middle"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">OpenLayers.IS_GECKO</span><span class="PUNC">&&</span><span class="NAME">f.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"dominant-baseline"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_ALIGN</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="STRN">"central"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b.label.split</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">f.childNodes.length</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">f.removeChild</span><span class="PUNC">(</span><span class="NAME">f.lastChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>482</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">"_tspan_"</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">,</span><span class="STRN">"tspan"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.labelSelect</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k._featureId</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k._geometry</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">k._geometryClass</span><span class="PUNC">=</span><span class="NAME">c.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">OpenLayers.IS_GECKO</span><span class="PUNC">&&</span><span class="NAME">k.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"baseline-shift"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_VSHIFT</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="STRN">"-35%"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.setAttribute</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_VFACTOR</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">o</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.setAttribute</span><span class="PUNC">(</span><span class="STRN">"dy"</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"em"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.setAttribute</span><span class="PUNC">(</span><span class="STRN">"dy"</span><span class="PUNC">,</span><span class="STRN">"1em"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.textContent</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">===</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="STRN">" "</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">k.parentNode</span><span class="PUNC">||</span><span class="NAME">f.appendChild</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f.parentNode</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>483</span> </span><span class="NAME">this.textRoot.appendChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getComponentsString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getShortString</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">this.getShortString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">this.clipLine</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">&&</span><span class="NAME">this.getShortString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">this.clipLine</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">path</span><span class="PUNC">:</span><span class="NAME">f.join</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">","</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">complete</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clipLine</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.equals</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.MAX_PIXEL</span><span class="PUNC">-</span><span class="NAME">this.translationParameters.x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.MAX_PIXEL</span><span class="PUNC">-</span><span class="NAME">this.translationParameters.y</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>484</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">h</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getShortString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.top</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.inValidRange</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getPosition</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.getAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"cx"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">parseFloat</span><span class="PUNC">(</span><span class="NAME">a.getAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"cy"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">importSymbol</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.defs</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>485</span> </span><span class="PUNC">(</span><span class="NAME">this.defs</span><span class="PUNC">=</span><span class="NAME">this.createDefs</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.container.id</span><span class="PUNC">+</span><span class="STRN">"-"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.symbol</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">" is not a valid symbol name"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"symbol"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.nodeFactory</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"polygon"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.left</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c.left</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.bottom</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c.bottom</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.right</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c.right</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.top</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c.top</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>486</span> </span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="STRN">","</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"points"</span><span class="PUNC">,</span><span class="NAME">f.join</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.setAttributeNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"viewBox"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c.left</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c.bottom</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.symbolMetrics</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lon</span><span class="PUNC">,</span><span class="NAME">c.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lat</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.defs.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureIdFromEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.target</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.parentNode</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">!=</span><span class="NAME">this.rendererRoot</span><span class="PUNC">?</span><span class="NAME">b.parentNode._featureId</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>487</span> </span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Renderer.SVG"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_ALIGN</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">:</span><span class="STRN">"start"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">:</span><span class="STRN">"end"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="STRN">"bottom"</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">:</span><span class="STRN">"hanging"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_VSHIFT</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">:</span><span class="STRN">"-70%"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="STRN">"0"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.SVG.LABEL_VFACTOR</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.SVG.preventDefault</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.preventDefault</span><span class="PUNC">&&</span><span class="NAME">a.preventDefault</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.OSM</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Format.XML</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">checkTags</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">interestingTagsExclude</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">areaTags</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">interestingTagsExclude</span><span class="PUNC">:</span><span class="STRN">"source source_ref source:ref history attribution created_by"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">areaTags</span><span class="PUNC">:</span><span class="STRN">"area building leisure tourism ruins historic landuse military natural sport"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b.interestingTagsExclude.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b.interestingTagsExclude</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.interestingTagsExclude</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b.areaTags.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b.areaTags</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>488</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.areaTags</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.externalProjection</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Projection</span><span class="PUNC">(</span><span class="STRN">"EPSG:4326"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Format.XML.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"string"</span><span class="PUNC">==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Format.XML.prototype.read.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getNodes</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getWays</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">c.length</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">nodes.length</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.isWayArea</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">nodes.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">nodes</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">h.lon</span><span class="PUNC">,</span><span class="NAME">h.lat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.osm_id</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">nodes</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>489</span> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">h.used</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Polygon</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LinearRing</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.LineString</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.internalProjection</span><span class="PUNC">&&</span><span class="NAME">this.externalProjection</span><span class="PUNC">&&</span><span class="NAME">h.transform</span><span class="PUNC">(</span><span class="NAME">this.externalProjection</span><span class="PUNC">,</span><span class="NAME">this.internalProjection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">tags</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.osm_id</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.fid</span><span class="PUNC">=</span><span class="STRN">"way."</span><span class="PUNC">+</span><span class="NAME">e.osm_id</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">h.used</span><span class="PUNC">||</span><span class="NAME">this.checkTags</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.checkTags</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getTags</span><span class="PUNC">(</span><span class="NAME">h.node</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h.used</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getTags</span><span class="PUNC">(</span><span class="NAME">h.node</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>490</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Geometry.Point</span><span class="PUNC">(</span><span class="NAME">h.lon</span><span class="PUNC">,</span><span class="NAME">h.lat</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.internalProjection</span><span class="PUNC">&&</span><span class="NAME">this.externalProjection</span><span class="PUNC">&&</span><span class="NAME">e.geometry.transform</span><span class="PUNC">(</span><span class="NAME">this.externalProjection</span><span class="PUNC">,</span><span class="NAME">this.internalProjection</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.osm_id</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.fid</span><span class="PUNC">=</span><span class="STRN">"node."</span><span class="PUNC">+</span><span class="NAME">e.osm_id</span><span class="PUNC">;</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">h.node</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNodes</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"node"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.getAttribute</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">lat</span><span class="PUNC">:</span><span class="NAME">d.getAttribute</span><span class="PUNC">(</span><span class="STRN">"lat"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lon</span><span class="PUNC">:</span><span class="NAME">d.getAttribute</span><span class="PUNC">(</span><span class="STRN">"lon"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">node</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getWays</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>491</span> </span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"way"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">d.getAttribute</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">e.tags</span><span class="PUNC">=</span><span class="NAME">this.getTags</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"nd"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.nodes</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">d.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e.nodes</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getAttribute</span><span class="PUNC">(</span><span class="STRN">"ref"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getTags</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.getElementsByTagName</span><span class="PUNC">(</span><span class="STRN">"tag"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getAttribute</span><span class="PUNC">(</span><span class="STRN">"k"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getAttribute</span><span class="PUNC">(</span><span class="STRN">"v"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.interestingTagsExclude</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isWayArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>492</span> </span><span class="NAME">a.nodes</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">a.nodes</span><span class="PUNC">[</span><span class="NAME">a.nodes.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.checkTags</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.tags</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.areaTags</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.checkTags</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">write</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.osm_id</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.created_nodes</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.createElementNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"osm"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setAttribute</span><span class="PUNC">(</span><span class="STRN">"version"</span><span class="PUNC">,</span><span class="STRN">"0.5"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setAttribute</span><span class="PUNC">(</span><span class="STRN">"generator"</span><span class="PUNC">,</span><span class="STRN">"OpenLayers "</span><span class="PUNC">+</span><span class="NAME">OpenLayers.VERSION_NUMBER</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.createFeatureNodes</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.appendChild</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.XML.prototype.write.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>493</span> </span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createFeatureNodes</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.geometry.CLASS_NAME</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.substring</span><span class="PUNC">(</span><span class="NAME">c.lastIndexOf</span><span class="PUNC">(</span><span class="STRN">"."</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.createXML</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createXML</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">point</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">?</span><span class="NAME">a.geometry</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.internalProjection</span><span class="PUNC">&&</span><span class="NAME">this.externalProjection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.transform</span><span class="PUNC">(</span><span class="NAME">this.internalProjection</span><span class="PUNC">,</span><span class="NAME">this.externalProjection</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a.osm_id</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.osm_id</span><span class="PUNC">,</span><span class="NAME">this.created_nodes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.osm_id</span><span class="PUNC">,</span><span class="NAME">this.osm_id</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">this.created_nodes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">this.createElementNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>494</span> </span><span class="STRN">"node"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.created_nodes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e.setAttribute</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.setAttribute</span><span class="PUNC">(</span><span class="STRN">"lon"</span><span class="PUNC">,</span><span class="NAME">c.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.setAttribute</span><span class="PUNC">(</span><span class="STRN">"lat"</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.attributes</span><span class="PUNC">&&</span><span class="NAME">this.serializeTags</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setState</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">linestring</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">;</span><span class="NAME">a.osm_id</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.osm_id</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.osm_id</span><span class="PUNC">,</span><span class="NAME">this.osm_id</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.createElementNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"way"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.setAttribute</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">d.components.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.createXML.point.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">d.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.getAttribute</span><span class="PUNC">(</span><span class="STRN">"id"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.components</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">osm_id</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>495</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.created_nodes</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.setState</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.createElementNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"nd"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.setAttribute</span><span class="PUNC">(</span><span class="STRN">"ref"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.appendChild</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.serializeTags</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">polygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">area</span><span class="PUNC">:</span><span class="STRN">"yes"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a.attributes</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Feature.Vector</span><span class="PUNC">(</span><span class="NAME">a.geometry.components</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.osm_id</span><span class="PUNC">=</span><span class="NAME">a.osm_id</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.createXML.linestring.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">serializeTags</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.createElementNS</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="STRN">"tag"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.setAttribute</span><span class="PUNC">(</span><span class="STRN">"k"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.setAttribute</span><span class="PUNC">(</span><span class="STRN">"v"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>496</span> </span><span class="NAME">a.attributes</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.appendChild</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setState</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.state</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.state</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.UPDATE</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"delete"</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">b.setAttribute</span><span class="PUNC">(</span><span class="STRN">"action"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Format.OSM"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Icon</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">offset</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">calculateOffset</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">imageDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">px</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="NAME">w</span><span class="PUNC">:</span><span class="NUMB">20</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NUMB">20</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.offset</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.size.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.size.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.calculateOffset</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createUniqueID</span><span class="PUNC">(</span><span class="STRN">"OL_Icon_"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.imageDiv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createAlphaImageDiv</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.erase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Event.stopObservingElement</span><span class="PUNC">(</span><span class="NAME">this.imageDiv.firstChild</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.imageDiv.innerHTML</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.imageDiv</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Icon</span><span class="PUNC">(</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>497</span> </span><span class="NAME">this.size</span><span class="PUNC">,</span><span class="NAME">this.offset</span><span class="PUNC">,</span><span class="NAME">this.calculateOffset</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setUrl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.url</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.modifyAlphaImageDiv</span><span class="PUNC">(</span><span class="NAME">this.imageDiv</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.size</span><span class="PUNC">,</span><span class="NAME">this.url</span><span class="PUNC">,</span><span class="STRN">"absolute"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.imageDiv</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">erase</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.imageDiv</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.imageDiv.parentNode</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Element.remove</span><span class="PUNC">(</span><span class="NAME">this.imageDiv</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setOpacity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.modifyAlphaImageDiv</span><span class="PUNC">(</span><span class="NAME">this.imageDiv</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>498</span> </span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.px</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.imageDiv</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.px</span><span class="PUNC">?</span><span class="NAME">this.display</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.calculateOffset</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.offset</span><span class="PUNC">=</span><span class="NAME">this.calculateOffset</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.modifyAlphaImageDiv</span><span class="PUNC">(</span><span class="NAME">this.imageDiv</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">this.px.x</span><span class="PUNC">+</span><span class="NAME">this.offset.x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">this.px.y</span><span class="PUNC">+</span><span class="NAME">this.offset.y</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.imageDiv.style.display</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isDrawn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.imageDiv</span><span class="PUNC">&&</span><span class="NAME">this.imageDiv.parentNode</span><span class="PUNC">&&</span><span class="NUMB">11</span><span class="PUNC">!=</span><span class="NAME">this.imageDiv.parentNode.nodeType</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Icon"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Marker</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">icon</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">lonlat</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">events</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.lonlat</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Marker.defaultIcon</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">this.icon</span><span class="PUNC">?</span><span class="NAME">this.icon</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.icon.url</span><span class="PUNC">=</span><span class="NAME">c.url</span><span class="PUNC">,</span><span class="NAME">this.icon.size</span><span class="PUNC">=</span><span class="NAME">c.size</span><span class="PUNC">,</span><span class="NAME">this.icon.offset</span><span class="PUNC">=</span><span class="NAME">c.offset</span><span class="PUNC">,</span><span class="NAME">this.icon.calculateOffset</span><span class="PUNC">=</span><span class="NAME">c.calculateOffset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.icon.imageDiv</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.erase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.events.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.icon</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.icon.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.icon</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>499</span> </span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.icon.draw</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">erase</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.icon</span><span class="PUNC">&&</span><span class="NAME">this.icon.erase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.icon</span><span class="PUNC">&&</span><span class="NAME">this.icon.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lonlat</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromLayerPx</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isDrawn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.icon</span><span class="PUNC">&&</span><span class="NAME">this.icon.isDrawn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onScreen</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">containsLonLat</span><span class="PUNC">(</span><span class="NAME">this.lonlat</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">inflate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.icon</span><span class="PUNC">&&</span><span class="NAME">this.icon.setSize</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">w</span><span class="PUNC">:</span><span class="NAME">this.icon.size.w</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">this.icon.size.h</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setOpacity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.icon.setOpacity</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>500</span> </span><span class="NAME">setUrl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.icon.setUrl</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.icon.display</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Marker"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Marker.defaultIcon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Icon</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.getImageLocation</span><span class="PUNC">(</span><span class="STRN">"marker.png"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">w</span><span class="PUNC">:</span><span class="NUMB">21</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NUMB">25</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">10.5</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">25</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.ProxyHost</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>501</span> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">DEFAULT_CONFIG</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">window.location.href</span><span class="PUNC">,</span><span class="NAME">async</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">user</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">password</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">params</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">proxy</span><span class="PUNC">:</span><span class="NAME">OpenLayers.ProxyHost</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">success</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">failure</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">URL_SPLIT_REGEX</span><span class="PUNC">:</span><span class="REGX">/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/</span><span class="PUNC">,</span><span class="NAME">events</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Events</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">makeSameOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="STRN">"http"</span><span class="PUNC">)</span><span class="PUNC">!==</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">a.match</span><span class="PUNC">(</span><span class="NAME">this.URL_SPLIT_REGEX</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">window.location</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">e.protocol</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>502</span> </span><span class="NAME">e.hostname</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.port</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">!=</span><span class="NUMB">80</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">!=</span><span class="STRN">""</span><span class="PUNC">||</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="STRN">"80"</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">!=</span><span class="STRN">""</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">encodeURIComponent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Console.warn</span><span class="PUNC">(</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"proxyNeeded"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">issue</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">this.DEFAULT_CONFIG</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">proxy</span><span class="PUNC">:</span><span class="NAME">OpenLayers.ProxyHost</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">false</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.headers</span><span class="PUNC">)</span><span class="NAME">a.headers.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="STRN">"x-requested-with"</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">===</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.headers</span><span class="PUNC">[</span><span class="STRN">"X-Requested-With"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"XMLHttpRequest"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>503</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.XMLHttpRequest</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.urlAppend</span><span class="PUNC">(</span><span class="NAME">a.url</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.getParameterString</span><span class="PUNC">(</span><span class="NAME">a.params</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request.makeSameOrigin</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">a.proxy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.open</span><span class="PUNC">(</span><span class="NAME">a.method</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">a.async</span><span class="PUNC">,</span><span class="NAME">a.user</span><span class="PUNC">,</span><span class="NAME">a.password</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.headers</span><span class="PUNC">)</span><span class="NAME">d.setRequestHeader</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a.headers</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.events</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">d.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.readyState</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Request.XMLHttpRequest.DONE</span><span class="PUNC">&&</span><span class="NAME">g.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"complete"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">request</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">config</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">requestUrl</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">!==</span><span class="KEYW">false</span><span class="PUNC">&&</span><span class="NAME">h.runCallbacks</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">request</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">config</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">requestUrl</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>504</span> </span><span class="NAME">a.async</span><span class="PUNC">===</span><span class="KEYW">false</span><span class="PUNC">?</span><span class="NAME">d.send</span><span class="PUNC">(</span><span class="NAME">a.data</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.readyState</span><span class="PUNC">!==</span><span class="NUMB">0</span><span class="PUNC">&&</span><span class="NAME">d.send</span><span class="PUNC">(</span><span class="NAME">a.data</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">runCallbacks</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.request</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.config</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.scope</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">c.callback</span><span class="PUNC">,</span><span class="NAME">c.scope</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c.callback</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c.success</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.scope</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">c.success</span><span class="PUNC">,</span><span class="NAME">c.scope</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c.success</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c.failure</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.scope</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">c.failure</span><span class="PUNC">,</span><span class="NAME">c.scope</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c.failure</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.createUrlObject</span><span class="PUNC">(</span><span class="NAME">c.url</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">protocol</span><span class="PUNC">==</span><span class="STRN">"file:"</span><span class="PUNC">&&</span><span class="NAME">b.responseText</span><span class="PUNC">)</span><span class="NAME">b.status</span><span class="PUNC">=</span><span class="NUMB">200</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b.status</span><span class="PUNC">||</span><span class="NAME">b.status</span><span class="PUNC">>=</span><span class="WHIT">
<span class='line'>505</span> </span><span class="NUMB">200</span><span class="PUNC">&&</span><span class="NAME">b.status</span><span class="PUNC">&lt;</span><span class="NUMB">300</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"success"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.status</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.status</span><span class="PUNC">&lt;</span><span class="NUMB">200</span><span class="PUNC">||</span><span class="NAME">b.status</span><span class="PUNC">>=</span><span class="NUMB">300</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"failure"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">GET</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"GET"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.issue</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">POST</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"POST"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.headers</span><span class="PUNC">=</span><span class="NAME">a.headers</span><span class="PUNC">?</span><span class="NAME">a.headers</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="STRN">"CONTENT-TYPE"</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">(</span><span class="NAME">a.headers</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.headers</span><span class="PUNC">[</span><span class="STRN">"Content-Type"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"application/xml"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.issue</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">PUT</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>506</span> </span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"PUT"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.headers</span><span class="PUNC">=</span><span class="NAME">a.headers</span><span class="PUNC">?</span><span class="NAME">a.headers</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="STRN">"CONTENT-TYPE"</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Util.upperCaseObject</span><span class="PUNC">(</span><span class="NAME">a.headers</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.headers</span><span class="PUNC">[</span><span class="STRN">"Content-Type"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"application/xml"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.issue</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">DELETE</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"DELETE"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.issue</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">HEAD</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"HEAD"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.issue</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">OPTIONS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">method</span><span class="PUNC">:</span><span class="STRN">"OPTIONS"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Request.issue</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._object</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">i</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">window.ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"Microsoft.XMLHTTP"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._listeners</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.onreadystatechange</span><span class="PUNC">&&</span><span class="NAME">b.onreadystatechange.apply</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"readystatechange"</span><span class="PUNC">,</span><span class="NAME">bubbles</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">cancelable</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">timeStamp</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">+</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">a.responseText</span><span class="PUNC">=</span><span class="NAME">a._object.responseText</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a._object</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.responseXML</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.responseText</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">e.documentElement</span><span class="PUNC">&&</span><span class="NAME">d.getResponseHeader</span><span class="PUNC">(</span><span class="STRN">"Content-Type"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">match</span><span class="PUNC">(</span><span class="REGX">/[^\/]+\/[^\+]+\+xml/</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>507</span> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">window.ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"Microsoft.XMLDOM"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.async</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e.validateOnParse</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e.loadXML</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">e.parseError</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">e.documentElement</span><span class="PUNC">||</span><span class="NAME">e.documentElement</span><span class="PUNC">&&</span><span class="STRN">"parsererror"</span><span class="PUNC">==</span><span class="NAME">e.documentElement.tagName</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">a.responseXML</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">a.status</span><span class="PUNC">=</span><span class="NAME">a._object.status</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">a.statusText</span><span class="PUNC">=</span><span class="NAME">a._object.statusText</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a._object.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">window.Function</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">window.XMLHttpRequest</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">window.controllers</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">window.document.all</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">window.opera</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">window.navigator.userAgent.match</span><span class="PUNC">(</span><span class="REGX">/MSIE 7.0/</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>508</span> </span><span class="NAME">b.prototype</span><span class="PUNC">=</span><span class="NAME">a.prototype</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">f.wrapped</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.wrapped</span><span class="PUNC">=</span><span class="NAME">f.wrapped</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.UNSENT</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.OPENED</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b.HEADERS_RECEIVED</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">b.LOADING</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">b.DONE</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">b.prototype.readyState</span><span class="PUNC">=</span><span class="NAME">b.UNSENT</span><span class="PUNC">;</span><span class="NAME">b.prototype.responseText</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">b.prototype.responseXML</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.prototype.status</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.prototype.statusText</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">b.prototype.priority</span><span class="PUNC">=</span><span class="STRN">"NORMAL"</span><span class="PUNC">;</span><span class="NAME">b.prototype.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.onopen</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.onsend</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.onabort</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">b.prototype.open</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._headers</span><span class="PUNC">;</span><span class="NAME">arguments.length</span><span class="PUNC">&lt;</span><span class="NUMB">3</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._async</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>509</span> </span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.readyState</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">!=</span><span class="NAME">b.DONE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.abort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">window.attachEvent</span><span class="PUNC">(</span><span class="STRN">"onunload"</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b.onopen</span><span class="PUNC">&&</span><span class="NAME">b.onopen.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">arguments.length</span><span class="PUNC">></span><span class="NUMB">4</span><span class="PUNC">?</span><span class="NAME">this._object.open</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">arguments.length</span><span class="PUNC">></span><span class="NUMB">3</span><span class="PUNC">?</span><span class="NAME">this._object.open</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this._object.open</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.readyState</span><span class="PUNC">=</span><span class="NAME">b.OPENED</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._object.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">g</span><span class="PUNC">||</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n.readyState</span><span class="PUNC">=</span><span class="NAME">n._object.readyState</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n._aborted</span><span class="PUNC">)</span><span class="NAME">n.readyState</span><span class="PUNC">=</span><span class="NAME">b.UNSENT</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n.readyState</span><span class="PUNC">==</span><span class="NAME">b.DONE</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">n._data</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">window.detachEvent</span><span class="PUNC">(</span><span class="STRN">"onunload"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>510</span> </span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">q</span><span class="PUNC">!=</span><span class="NAME">n.readyState</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n.readyState</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.send</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.onsend</span><span class="PUNC">&&</span><span class="NAME">b.onsend.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">arguments.length</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.nodeType</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">window.XMLSerializer</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">window.XMLSerializer</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">serializeToString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.xml</span><span class="PUNC">;</span><span class="NAME">this._headers</span><span class="PUNC">[</span><span class="STRN">"Content-Type"</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">this._object.setRequestHeader</span><span class="PUNC">(</span><span class="STRN">"Content-Type"</span><span class="PUNC">,</span><span class="STRN">"application/xml"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this._data</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">this._object.send</span><span class="PUNC">(</span><span class="NAME">this._data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this._async</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.readyState</span><span class="PUNC">=</span><span class="NAME">b.OPENED</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.readyState</span><span class="PUNC">&lt;</span><span class="NAME">b.DONE</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.readyState</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this._aborted</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>511</span> </span><span class="NAME">b.prototype.abort</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.onabort</span><span class="PUNC">&&</span><span class="NAME">b.onabort.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.readyState</span><span class="PUNC">></span><span class="NAME">b.UNSENT</span><span class="PUNC">)</span><span class="NAME">this._aborted</span><span class="PUNC">=</span><span class="KEYW">true</span><span class="PUNC">;</span><span class="NAME">this._object.abort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.readyState</span><span class="PUNC">=</span><span class="NAME">b.UNSENT</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this._data</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.getAllResponseHeaders</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._object.getAllResponseHeaders</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.getResponseHeader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._object.getResponseHeader</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.setRequestHeader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._headers</span><span class="PUNC">)</span><span class="NAME">this._headers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this._headers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._object.setRequestHeader</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>512</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.addEventListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="NAME">this._listeners.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.removeEventListener</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">this._listeners.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.dispatchEvent</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NAME">a.type</span><span class="PUNC">,</span><span class="NAME">target</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">currentTarget</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">eventPhase</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">bubbles</span><span class="PUNC">:</span><span class="NAME">a.bubbles</span><span class="PUNC">,</span><span class="NAME">cancelable</span><span class="PUNC">:</span><span class="NAME">a.cancelable</span><span class="PUNC">,</span><span class="NAME">timeStamp</span><span class="PUNC">:</span><span class="NAME">a.timeStamp</span><span class="PUNC">,</span><span class="NAME">stopPropagation</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">preventDefault</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>513</span> </span><span class="NAME">initEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.type</span><span class="PUNC">==</span><span class="STRN">"readystatechange"</span><span class="PUNC">&&</span><span class="NAME">this.onreadystatechange</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.onreadystatechange.handleEvent</span><span class="PUNC">||</span><span class="NAME">this.onreadystatechange</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">a.type</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">handleEvent</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.prototype.toString</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"[object XMLHttpRequest]"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b.toString</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"[XMLHttpRequest]"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">window.Function.prototype.apply</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">window.Function.prototype.apply</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__func</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">a.__func</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>514</span> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a.__func</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Request.XMLHttpRequest</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.HTTP</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Protocol</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">params</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">readWithPOST</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">updateWithPOST</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">deleteWithPOST</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">wildcarded</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">srsInBBOX</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.params</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.headers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.filterToParams</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Format.QueryStringFilter</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Format.QueryStringFilter</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">wildcarded</span><span class="PUNC">:</span><span class="NAME">this.wildcarded</span><span class="PUNC">,</span><span class="NAME">srsInBBOX</span><span class="PUNC">:</span><span class="NAME">this.srsInBBOX</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.filterToParams</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>515</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.write</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.headers</span><span class="PUNC">=</span><span class="NAME">this.params</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Protocol.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">read</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Protocol.prototype.read.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.params</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a.params</span><span class="PUNC">,</span><span class="NAME">this.options.params</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.filter</span><span class="PUNC">&&</span><span class="NAME">this.filterToParams</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.params</span><span class="PUNC">=</span><span class="NAME">this.filterToParams</span><span class="PUNC">(</span><span class="NAME">a.filter</span><span class="PUNC">,</span><span class="NAME">a.params</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.readWithPOST</span><span class="PUNC">?</span><span class="NAME">a.readWithPOST</span><span class="PUNC">:</span><span class="NAME">this.readWithPOST</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">requestType</span><span class="PUNC">:</span><span class="STRN">"read"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>516</span> </span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.headers</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="STRN">"Content-Type"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"application/x-www-form-urlencoded"</span><span class="PUNC">,</span><span class="NAME">c.priv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request.POST</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">a.url</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">this.createCallback</span><span class="PUNC">(</span><span class="NAME">this.handleRead</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Util.getParameterString</span><span class="PUNC">(</span><span class="NAME">a.params</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c.priv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request.GET</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">a.url</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">this.createCallback</span><span class="PUNC">(</span><span class="NAME">this.handleRead</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">params</span><span class="PUNC">:</span><span class="NAME">a.params</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="NAME">a.headers</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleRead</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleResponse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">create</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">reqFeatures</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>517</span> </span><span class="NAME">requestType</span><span class="PUNC">:</span><span class="STRN">"create"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.priv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request.POST</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">b.url</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">this.createCallback</span><span class="PUNC">(</span><span class="NAME">this.handleCreate</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="NAME">b.headers</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="NAME">this.format.write</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleCreate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleResponse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">update</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.url</span><span class="PUNC">||</span><span class="NAME">a.url</span><span class="PUNC">||</span><span class="NAME">this.options.url</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">+</span><span class="NAME">a.fid</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">reqFeatures</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">requestType</span><span class="PUNC">:</span><span class="STRN">"update"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.priv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">[</span><span class="NAME">this.updateWithPOST</span><span class="PUNC">?</span><span class="STRN">"POST"</span><span class="PUNC">:</span><span class="STRN">"PUT"</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">this.createCallback</span><span class="PUNC">(</span><span class="NAME">this.handleUpdate</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>518</span> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="NAME">b.headers</span><span class="PUNC">,</span><span class="NAME">data</span><span class="PUNC">:</span><span class="NAME">this.format.write</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleUpdate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleResponse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="STRN">"delete"</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.url</span><span class="PUNC">||</span><span class="NAME">a.url</span><span class="PUNC">||</span><span class="NAME">this.options.url</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">+</span><span class="NAME">a.fid</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">reqFeatures</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">requestType</span><span class="PUNC">:</span><span class="STRN">"delete"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.deleteWithPOST</span><span class="PUNC">?</span><span class="STRN">"POST"</span><span class="PUNC">:</span><span class="STRN">"DELETE"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">this.createCallback</span><span class="PUNC">(</span><span class="NAME">this.handleDelete</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">headers</span><span class="PUNC">:</span><span class="NAME">b.headers</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.deleteWithPOST</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.data</span><span class="PUNC">=</span><span class="NAME">this.format.write</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.priv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Request</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>519</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleDelete</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handleResponse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleResponse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.priv</span><span class="PUNC">;</span><span class="NAME">b.callback</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">200</span><span class="PUNC">&lt;=</span><span class="NAME">c.status</span><span class="PUNC">&&</span><span class="NUMB">300</span><span class="PUNC">></span><span class="NAME">c.status</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="STRN">"delete"</span><span class="PUNC">!=</span><span class="NAME">a.requestType</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.features</span><span class="PUNC">=</span><span class="NAME">this.parseFeatures</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.code</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Protocol.Response.SUCCESS</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.code</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Protocol.Response.FAILURE</span><span class="PUNC">,</span><span class="NAME">b.callback.call</span><span class="PUNC">(</span><span class="NAME">b.scope</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.responseXML</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">b.documentElement</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.responseText</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">b.length</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">this.format.read</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">commit</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>520</span> </span><span class="NAME">a.features</span><span class="PUNC">?</span><span class="NAME">a.features.length</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.features</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">fid</span><span class="PUNC">;</span><span class="NAME">n.insertIds</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">d.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.callUserCallback</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="NAME">a.success</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">>=</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="NAME">b.callback</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">n.code</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">?</span><span class="NAME">OpenLayers.Protocol.Response.SUCCESS</span><span class="PUNC">:</span><span class="NAME">OpenLayers.Protocol.Response.FAILURE</span><span class="PUNC">,</span><span class="NAME">b.callback.apply</span><span class="PUNC">(</span><span class="NAME">b.scope</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.options</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.INSERT</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.UPDATE</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">o</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">o</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">k</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>521</span> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">h.state</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">i.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.INSERT</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.UPDATE</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Protocol.Response</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">reqFeatures</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.INSERT</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">&&</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">this.create</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b.create</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.UPDATE</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">k</span><span class="PUNC">)</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b.update</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">OpenLayers.State.DELETE</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>522</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">k</span><span class="PUNC">)</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="STRN">"delete"</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">callback</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="STRN">"delete"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">abort</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.priv.abort</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">callUserCallback</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a.requestType</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.callback</span><span class="PUNC">&&</span><span class="NAME">c.callback.call</span><span class="PUNC">(</span><span class="NAME">c.scope</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Protocol.HTTP"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Vector.RootContainer</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer.Vector</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">displayInLayerSwitcher</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">display</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureFromEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getFeatureFromEvent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.Vector.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.collectRoots</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.events.register</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.handleChangeLayer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.events.unregister</span><span class="PUNC">(</span><span class="STRN">"changelayer"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.handleChangeLayer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>523</span> </span><span class="NAME">this.resetRoots</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Vector.prototype.removeMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">collectRoots</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.map.layers.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.layers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.renderer.moveRoot</span><span class="PUNC">(</span><span class="NAME">this.renderer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">resetRoots</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.layers.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.renderer</span><span class="PUNC">&&</span><span class="NAME">a.renderer.getRenderLayerId</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="NAME">this.id</span><span class="PUNC">&&</span><span class="NAME">this.renderer.moveRoot</span><span class="PUNC">(</span><span class="NAME">a.renderer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleChangeLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.layer</span><span class="PUNC">;</span><span class="STRN">"order"</span><span class="PUNC">==</span><span class="NAME">a.property</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!=</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>524</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.resetRoots</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.collectRoots</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.Vector.RootContainer"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.SelectFeature</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">multipleKey</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">toggleKey</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">multiple</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">clickout</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">toggle</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">hover</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">highlightOnly</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">box</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">onBeforeSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onUnselect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">geometryTypes</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">callbacks</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">selectStyle</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">renderIntent</span><span class="PUNC">:</span><span class="STRN">"select"</span><span class="PUNC">,</span><span class="NAME">handlers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Control.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.scope</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.scope</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.initLayer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>525</span> </span><span class="PUNC">{</span><span class="NAME">click</span><span class="PUNC">:</span><span class="NAME">this.clickFeature</span><span class="PUNC">,</span><span class="NAME">clickout</span><span class="PUNC">:</span><span class="NAME">this.clickoutFeature</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.hover</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.over</span><span class="PUNC">=</span><span class="NAME">this.overFeature</span><span class="PUNC">,</span><span class="NAME">c.out</span><span class="PUNC">=</span><span class="NAME">this.outFeature</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.callbacks</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.extend</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.callbacks</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Feature</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.layer</span><span class="PUNC">,</span><span class="NAME">this.callbacks</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">geometryTypes</span><span class="PUNC">:</span><span class="NAME">this.geometryTypes</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.box</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.handlers.box</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Box</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">done</span><span class="PUNC">:</span><span class="NAME">this.selectBox</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">boxDivClassName</span><span class="PUNC">:</span><span class="STRN">"olHandlerBoxSelectFeature"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>526</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Vector.RootContainer</span><span class="PUNC">(</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_container"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.layer</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.active</span><span class="PUNC">&&</span><span class="NAME">this.layers</span><span class="PUNC">&&</span><span class="NAME">this.map.removeLayer</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layers</span><span class="PUNC">&&</span><span class="NAME">this.layer.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.active</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.layers</span><span class="PUNC">&&</span><span class="NAME">this.map.addLayer</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handlers.feature.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.box</span><span class="PUNC">&&</span><span class="NAME">this.handlers.box</span><span class="PUNC">&&</span><span class="NAME">this.handlers.box.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.active</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>527</span> </span><span class="PUNC">(</span><span class="NAME">this.handlers.feature.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handlers.box</span><span class="PUNC">&&</span><span class="NAME">this.handlers.box.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layers</span><span class="PUNC">&&</span><span class="NAME">this.map.removeLayer</span><span class="PUNC">(</span><span class="NAME">this.layer</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Control.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unselectAll</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">||</span><span class="PUNC">[</span><span class="NAME">this.layer</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c.selectedFeatures.length</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.selectedFeatures</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">a.except</span><span class="PUNC">!=</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">this.unselect</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clickFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.hover</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">a.layer.selectedFeatures</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.toggleSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>528</span> </span><span class="NAME">this.unselect</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.multipleSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.unselectAll</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">except</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.multipleSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.unselectAll</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">except</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.select</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multipleSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.multiple</span><span class="PUNC">||</span><span class="NAME">this.handlers.feature.evt</span><span class="PUNC">&&</span><span class="NAME">this.handlers.feature.evt</span><span class="PUNC">[</span><span class="NAME">this.multipleKey</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toggleSelect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.toggle</span><span class="PUNC">||</span><span class="NAME">this.handlers.feature.evt</span><span class="PUNC">&&</span><span class="NAME">this.handlers.feature.evt</span><span class="PUNC">[</span><span class="NAME">this.toggleKey</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clickoutFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NAME">this.hover</span><span class="PUNC">&&</span><span class="NAME">this.clickout</span><span class="PUNC">&&</span><span class="NAME">this.unselectAll</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">overFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.layer</span><span class="PUNC">;</span><span class="NAME">this.hover</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.highlightOnly</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>529</span> </span><span class="NAME">this.highlight</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">b.selectedFeatures</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.select</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">outFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hover</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.highlightOnly</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a._lastHighlighter</span><span class="PUNC">==</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">&&</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">!=</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a._lastHighlighter</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getControl</span><span class="PUNC">(</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b.highlight</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.unhighlight</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.unselect</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">highlight</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.layer</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeaturehighlighted"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">=</span><span class="NAME">a._lastHighlighter</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>530</span> </span><span class="NAME">a._lastHighlighter</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">,</span><span class="NAME">b.drawFeature</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.selectStyle</span><span class="PUNC">||</span><span class="NAME">this.renderIntent</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featurehighlighted"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unhighlight</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.layer</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">?</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a._lastHighlighter</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">!=</span><span class="NAME">this.id</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a._lastHighlighter</span><span class="PUNC">=</span><span class="NAME">a._prevHighlighter</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a._prevHighlighter</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.drawFeature</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">a.style</span><span class="PUNC">||</span><span class="NAME">a.layer.style</span><span class="PUNC">||</span><span class="STRN">"default"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featureunhighlighted"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">select</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.onBeforeSelect.call</span><span class="PUNC">(</span><span class="NAME">this.scope</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>531</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.layer</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"beforefeatureselected"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.selectedFeatures.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.highlight</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.handlers.feature.lastFeature</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.handlers.feature.lastFeature</span><span class="PUNC">=</span><span class="NAME">c.selectedFeatures</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featureselected"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.onSelect.call</span><span class="PUNC">(</span><span class="NAME">this.scope</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">unselect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.layer</span><span class="PUNC">;</span><span class="NAME">this.unhighlight</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">b.selectedFeatures</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"featureunselected"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">feature</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.onUnselect.call</span><span class="PUNC">(</span><span class="NAME">this.scope</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>532</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">selectBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.left</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.bottom</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.map.getLonLatFromPixel</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a.right</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a.top</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">(</span><span class="NAME">b.lon</span><span class="PUNC">,</span><span class="NAME">b.lat</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.multipleSelect</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.unselectAll</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.multiple</span><span class="PUNC">;</span><span class="NAME">this.multiple</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layers</span><span class="PUNC">||</span><span class="PUNC">[</span><span class="NAME">this.layer</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"boxselectionstart"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.features.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.features</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h.getVisibility</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>533</span> </span><span class="NAME">this.geometryTypes</span><span class="PUNC">||</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">this.geometryTypes</span><span class="PUNC">,</span><span class="NAME">h.geometry.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.toGeometry</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">intersects</span><span class="PUNC">(</span><span class="NAME">h.geometry</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">OpenLayers.Util.indexOf</span><span class="PUNC">(</span><span class="NAME">d.selectedFeatures</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.select</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.multiple</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.events.triggerEvent</span><span class="PUNC">(</span><span class="STRN">"boxselectionend"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">layers</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handlers.feature.setMap</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.box</span><span class="PUNC">&&</span><span class="NAME">this.handlers.box.setMap</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setLayer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.active</span><span class="PUNC">;</span><span class="NAME">this.unselectAll</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layers</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>534</span> </span><span class="PUNC">(</span><span class="NAME">this.layer.destroy</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layers</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.initLayer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.handlers.feature.layer</span><span class="PUNC">=</span><span class="NAME">this.layer</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.activate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.SelectFeature"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.Zoom</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">zoomInText</span><span class="PUNC">:</span><span class="STRN">"+"</span><span class="PUNC">,</span><span class="NAME">zoomInId</span><span class="PUNC">:</span><span class="STRN">"olZoomInLink"</span><span class="PUNC">,</span><span class="NAME">zoomOutText</span><span class="PUNC">:</span><span class="STRN">"-"</span><span class="PUNC">,</span><span class="NAME">zoomOutId</span><span class="PUNC">:</span><span class="STRN">"olZoomOutLink"</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Control.prototype.draw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getOrCreateLinks</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.zoomIn</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.zoomOut</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.events</span><span class="PUNC">;</span><span class="NAME">b.parentNode</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.events</span><span class="PUNC">,</span><span class="NAME">d.attachToElement</span><span class="PUNC">(</span><span class="NAME">b.parentNode</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.register</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.onZoomClick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoomInLink</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.zoomOutLink</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getOrCreateLinks</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this.zoomInId</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>535</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">this.zoomOutId</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.href</span><span class="PUNC">=</span><span class="STRN">"#zoomIn"</span><span class="PUNC">,</span><span class="NAME">b.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">this.zoomInText</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.className</span><span class="PUNC">=</span><span class="STRN">"olControlZoomIn"</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"olButton"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.href</span><span class="PUNC">=</span><span class="STRN">"#zoomOut"</span><span class="PUNC">,</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">document.createTextNode</span><span class="PUNC">(</span><span class="NAME">this.zoomOutText</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.className</span><span class="PUNC">=</span><span class="STRN">"olControlZoomOut"</span><span class="PUNC">,</span><span class="NAME">a.appendChild</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"olButton"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">zoomIn</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">zoomOut</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onZoomClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.buttonElement</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>536</span> </span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">this.zoomInLink</span><span class="PUNC">?</span><span class="NAME">this.map.zoomIn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">this.zoomOutLink</span><span class="PUNC">&&</span><span class="NAME">this.map.zoomOut</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.events.unregister</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.onZoomClick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.zoomInLink</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.zoomOutLink</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.Zoom"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Google.v3</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">DEFAULTS</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">sphericalMercator</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">projection</span><span class="PUNC">:</span><span class="STRN">"EPSG:900913"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">animationEnabled</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">loadMapObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.type</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="NAME">google.maps.MapTypeId.ROADMAP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b.mapObject</span><span class="PUNC">,</span><span class="PUNC">++</span><span class="NAME">b.count</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.id</span><span class="PUNC">=</span><span class="NAME">this.map.id</span><span class="PUNC">+</span><span class="STRN">"_GMapContainer"</span><span class="PUNC">,</span><span class="NAME">a.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">,</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">a.style.height</span><span class="PUNC">=</span><span class="STRN">"100%"</span><span class="PUNC">,</span><span class="NAME">b.appendChild</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.Map</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">center</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLng</span><span class="PUNC">(</span><span class="NAME">b.lat</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>537</span> </span><span class="NAME">b.lon</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLng</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="NAME">this.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">mapTypeId</span><span class="PUNC">:</span><span class="NAME">this.type</span><span class="PUNC">,</span><span class="NAME">disableDefaultUI</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">keyboardShortcuts</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">draggable</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">disableDoubleClickZoom</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">scrollwheel</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">streetViewControl</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">mapObject</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">count</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.repositionListener</span><span class="PUNC">=</span><span class="NAME">google.maps.event.addListenerOnce</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"center_changed"</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.repositionMapElements</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.mapObject</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.setGMapVisibility</span><span class="PUNC">(</span><span class="NAME">this.visibility</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">repositionMapElements</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">google.maps.event.trigger</span><span class="PUNC">(</span><span class="NAME">this.mapObject</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>538</span> </span><span class="STRN">"resize"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.mapObject.getDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">firstChild</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">a.childNodes.length</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.repositionTimer</span><span class="PUNC">=</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="NAME">this.repositionMapElements</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">250</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.viewPortDiv</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.children.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1000001</span><span class="PUNC">==</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.zIndex</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.style.zIndex</span><span class="PUNC">=</span><span class="STRN">"1100"</span><span class="PUNC">;</span><span class="NAME">e.style.bottom</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">e.className</span><span class="PUNC">=</span><span class="STRN">"olLayerGoogleCopyright olLayerGoogleV3"</span><span class="PUNC">;</span><span class="NAME">e.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">b.termsOfUse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>539</span> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="NUMB">1</span><span class="NAME">E6</span><span class="PUNC">==</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.zIndex</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.style.zIndex</span><span class="PUNC">=</span><span class="STRN">"1100"</span><span class="PUNC">,</span><span class="NAME">e.style.bottom</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">e.className</span><span class="PUNC">=</span><span class="STRN">"olLayerGooglePoweredBy olLayerGoogleV3 gmnoprint"</span><span class="PUNC">,</span><span class="NAME">e.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.poweredBy</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">10000002</span><span class="PUNC">==</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">style.zIndex</span><span class="PUNC">&&</span><span class="NAME">c.appendChild</span><span class="PUNC">(</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.setGMapVisibility</span><span class="PUNC">(</span><span class="NAME">this.visibility</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onMapResize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.visibility</span><span class="PUNC">)</span><span class="NAME">google.maps.event.trigger</span><span class="PUNC">(</span><span class="NAME">this.mapObject</span><span class="PUNC">,</span><span class="STRN">"resize"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">a.resized</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">google.maps.event.addListenerOnce</span><span class="PUNC">(</span><span class="NAME">this.mapObject</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>540</span> </span><span class="STRN">"tilesloaded"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">google.maps.event.trigger</span><span class="PUNC">(</span><span class="NAME">b.mapObject</span><span class="PUNC">,</span><span class="STRN">"resize"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.moveTo</span><span class="PUNC">(</span><span class="NAME">b.map.getCenter</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.map.getZoom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a.resized</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.resized</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setGMapVisibility</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Layer.Google.cache</span><span class="PUNC">[</span><span class="NAME">this.map.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.type</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.layers</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="PUNC">--</span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Layer.Google</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e.visibility</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e.inRange</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.type</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.mapObject.getDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.mapObject.setMapTypeId</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.style.left</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.termsOfUse</span><span class="PUNC">&&</span><span class="NAME">b.termsOfUse.style</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>541</span> </span><span class="PUNC">(</span><span class="NAME">b.termsOfUse.style.left</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.termsOfUse.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b.poweredBy.style.display</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.displayed</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">b.displayed</span><span class="PUNC">,</span><span class="NAME">d.style.left</span><span class="PUNC">=</span><span class="STRN">"-9999px"</span><span class="PUNC">,</span><span class="NAME">b.termsOfUse</span><span class="PUNC">&&</span><span class="NAME">b.termsOfUse.style</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.termsOfUse.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">,</span><span class="NAME">b.termsOfUse.style.left</span><span class="PUNC">=</span><span class="STRN">"-9999px"</span><span class="PUNC">,</span><span class="NAME">b.poweredBy.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapContainer</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.getDiv</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectBoundsFromOLBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.inverseMercator</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="NAME">a.left</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a.bottom</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>542</span> </span><span class="NAME">a.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="NAME">this.inverseMercator</span><span class="PUNC">(</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">a.right</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">a.top</span><span class="PUNC">,</span><span class="NAME">a.right</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLngBounds</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLng</span><span class="PUNC">(</span><span class="NAME">b.lat</span><span class="PUNC">,</span><span class="NAME">b.lon</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLng</span><span class="PUNC">(</span><span class="NAME">a.lat</span><span class="PUNC">,</span><span class="NAME">a.lon</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectLonLatFromMapObjectPixel</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getLongitudeFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">this.mapObject.center</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getLatitudeFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">this.mapObject.center</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">b.w</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">b.h</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>543</span> </span><span class="NAME">this.wrapDateLine</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.wrapDateLine</span><span class="PUNC">(</span><span class="NAME">this.maxExtent</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getMapObjectLonLatFromLonLat</span><span class="PUNC">(</span><span class="NAME">a.lon</span><span class="PUNC">,</span><span class="NAME">a.lat</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectPixelFromMapObjectLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getLongitudeFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getLatitudeFromMapObjectLonLat</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getMapObjectPixelFromXY</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">d.left</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d.top</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMapObjectCenter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.animationEnabled</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">!=</span><span class="NAME">this.mapObject.zoom</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getMapContainer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">google.maps.event.addListenerOnce</span><span class="PUNC">(</span><span class="NAME">this.mapObject</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>544</span> </span><span class="STRN">"idle"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.style.visibility</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.style.visibility</span><span class="PUNC">=</span><span class="STRN">"hidden"</span><span class="PUNC">}</span><span class="NAME">this.mapObject.setOptions</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">center</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">zoom</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectZoomFromMapObjectBounds</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.mapObject.getBoundsZoomLevel</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectLonLatFromLonLat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.sphericalMercator</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.inverseMercator</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLng</span><span class="PUNC">(</span><span class="NAME">c.lat</span><span class="PUNC">,</span><span class="NAME">c.lon</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.LatLng</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMapObjectPixelFromXY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">google.maps.Point</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.repositionListener</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>545</span> </span><span class="NAME">google.maps.event.removeListener</span><span class="PUNC">(</span><span class="NAME">this.repositionListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.repositionTimer</span><span class="PUNC">&&</span><span class="NAME">window.clearTimeout</span><span class="PUNC">(</span><span class="NAME">this.repositionTimer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Google.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.Markers</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Layer</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">isBaseLayer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">markers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">drawn</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.markers</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clearMarkers</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.markers</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Layer.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setOpacity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">!=</span><span class="NAME">this.opacity</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.opacity</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.markers.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.markers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setOpacity</span><span class="PUNC">(</span><span class="NAME">this.opacity</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">moveTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Layer.prototype.moveTo.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>546</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">this.drawn</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.markers.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.drawMarker</span><span class="PUNC">(</span><span class="NAME">this.markers</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.drawn</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.markers.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">this.opacity</span><span class="PUNC">&&</span><span class="NAME">a.setOpacity</span><span class="PUNC">(</span><span class="NAME">this.opacity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map</span><span class="PUNC">&&</span><span class="NAME">this.map.getExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">,</span><span class="NAME">this.drawMarker</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.markers</span><span class="PUNC">&&</span><span class="NAME">this.markers.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Util.removeItem</span><span class="PUNC">(</span><span class="NAME">this.markers</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.erase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearMarkers</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">this.markers</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.markers.length</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">this.removeMarker</span><span class="PUNC">(</span><span class="NAME">this.markers</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>547</span> </span><span class="NAME">drawMarker</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getLayerPxFromLonLat</span><span class="PUNC">(</span><span class="NAME">a.lonlat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">a.display</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.isDrawn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">a.icon</span><span class="PUNC">&&</span><span class="NAME">a.icon.moveTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">a.draw</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getDataExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.markers</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.markers.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.markers.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.extend</span><span class="PUNC">(</span><span class="NAME">this.markers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">lonlat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Layer.Markers"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.Canvas</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Renderer</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">hitDetection</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">hitOverflow</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">canvas</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">features</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pendingRedraw</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">cachedSymbolBounds</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Renderer.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.root</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.container.appendChild</span><span class="PUNC">(</span><span class="NAME">this.root</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas</span><span class="PUNC">=</span><span class="NAME">this.root.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.hitCanvas</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext</span><span class="PUNC">=</span><span class="NAME">this.hitCanvas.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>548</span> </span><span class="NAME">setExtent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Renderer.prototype.setExtent.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">eraseGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.eraseFeatures</span><span class="PUNC">(</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">supported</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">OpenLayers.CANVAS_SUPPORTED</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.root</span><span class="PUNC">;</span><span class="NAME">b.style.width</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">b.style.height</span><span class="PUNC">=</span><span class="NAME">a.h</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">;</span><span class="NAME">b.width</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">;</span><span class="NAME">b.height</span><span class="PUNC">=</span><span class="NAME">a.h</span><span class="PUNC">;</span><span class="NAME">this.resolution</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.hitCanvas</span><span class="PUNC">,</span><span class="NAME">b.style.width</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">b.style.height</span><span class="PUNC">=</span><span class="NAME">a.h</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">b.width</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">b.height</span><span class="PUNC">=</span><span class="NAME">a.h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawFeature</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>549</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.geometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.applyDefaultSymbolizer</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">a.style</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.geometry.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.intersectsBounds</span><span class="PUNC">(</span><span class="NAME">this.extent</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">worldBounds</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">!==</span><span class="NAME">b.display</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">a.id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.pendingRedraw</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">this.pendingRedraw</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.locked</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.pendingRedraw</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"OpenLayers.Geometry.Collection"</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>550</span> </span><span class="NAME">d</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiPoint"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiLineString"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">||</span><span class="STRN">"OpenLayers.Geometry.MultiPolygon"</span><span class="PUNC">==</span><span class="NAME">d</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.components.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.drawGeometry</span><span class="PUNC">(</span><span class="NAME">a.components</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.CLASS_NAME</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Point"</span><span class="PUNC">:</span><span class="NAME">this.drawPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LineString"</span><span class="PUNC">:</span><span class="NAME">this.drawLineString</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.LinearRing"</span><span class="PUNC">:</span><span class="NAME">this.drawLinearRing</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OpenLayers.Geometry.Polygon"</span><span class="PUNC">:</span><span class="NAME">this.drawPolygon</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawExternalGraphic</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>551</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Image</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.title</span><span class="PUNC">||</span><span class="NAME">b.graphicTitle</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.title</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.graphicWidth</span><span class="PUNC">||</span><span class="NAME">b.graphicHeight</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.graphicHeight</span><span class="PUNC">||</span><span class="NAME">b.graphicWidth</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b.graphicXOffset</span><span class="PUNC">?</span><span class="NAME">b.graphicXOffset</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">b.graphicYOffset</span><span class="PUNC">?</span><span class="NAME">b.graphicYOffset</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b.graphicOpacity</span><span class="PUNC">||</span><span class="NAME">b.fillOpacity</span><span class="PUNC">;</span><span class="NAME">d.onload</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bind</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getLocalXY</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.canvas</span><span class="PUNC">;</span><span class="NAME">m.globalAlpha</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>552</span> </span><span class="NAME">OpenLayers.Renderer.Canvas.drawImageScaleFactor</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Renderer.Canvas.drawImageScaleFactor</span><span class="PUNC">=</span><span class="REGX">/android 2.1/</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">navigator.userAgent.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NUMB">320</span><span class="PUNC">/</span><span class="NAME">window.screen.width</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.drawImage</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hitDetection</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.fillRect</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.src</span><span class="PUNC">=</span><span class="NAME">b.externalGraphic</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawNamedSymbol</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.symbol</span><span class="PUNC">[</span><span class="NAME">b.graphicName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">h</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">+</span><span class="STRN">" is not a valid symbol name"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>553</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h.length</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">></span><span class="NAME">h.length</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getLocalXY</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.canvas.lineCap</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">this.canvas.lineJoin</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.hitContext.lineCap</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">,</span><span class="NAME">this.hitContext.lineJoin</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.cachedSymbolBounds</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.cachedSymbolBounds</span><span class="PUNC">[</span><span class="NAME">b.graphicName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Bounds</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">d.extend</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.LonLat</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cachedSymbolBounds</span><span class="PUNC">[</span><span class="NAME">b.graphicName</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="NAME">this.canvas.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>554</span> </span><span class="NAME">this.canvas.translate</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.translate</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">b.rotation</span><span class="PUNC">;</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.canvas.rotate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.rotate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b.pointRadius</span><span class="PUNC">/</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">d.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.scale</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.scale</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lon</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.getCenterLonLat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lat</span><span class="PUNC">;</span><span class="NAME">this.canvas.translate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.translate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.strokeWidth</span><span class="PUNC">;</span><span class="NAME">b.strokeWidth</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.fill</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>555</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.canvas.moveTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.lineTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hitDetection</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.canvas.moveTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.lineTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.stroke</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>556</span> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.canvas.moveTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.lineTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hitDetection</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.moveTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.lineTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitContext.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">b.strokeWidth</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this.canvas.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"reset"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCanvasStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"fill"</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>557</span> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.canvas.globalAlpha</span><span class="PUNC">=</span><span class="NAME">b.fillOpacity</span><span class="PUNC">,</span><span class="NAME">this.canvas.fillStyle</span><span class="PUNC">=</span><span class="NAME">b.fillColor</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"stroke"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.canvas.globalAlpha</span><span class="PUNC">=</span><span class="NAME">b.strokeOpacity</span><span class="PUNC">,</span><span class="NAME">this.canvas.strokeStyle</span><span class="PUNC">=</span><span class="NAME">b.strokeColor</span><span class="PUNC">,</span><span class="NAME">this.canvas.lineWidth</span><span class="PUNC">=</span><span class="NAME">b.strokeWidth</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.canvas.globalAlpha</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.canvas.lineWidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">featureIdToHex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">"_"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">16777216</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.hitOverflow</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">16777215</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">%</span><span class="NUMB">16777216</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"000000"</span><span class="PUNC">+</span><span class="NAME">a.toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"#"</span><span class="PUNC">+</span><span class="NAME">a.substring</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setHitContextStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.featureIdToHex</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>558</span> </span><span class="STRN">"fill"</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.hitContext.globalAlpha</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.hitContext.fillStyle</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"stroke"</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.hitContext.globalAlpha</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.hitContext.strokeStyle</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"undefined"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">this.hitContext.lineWidth</span><span class="PUNC">=</span><span class="NAME">c.strokeWidth</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.hitContext.lineWidth</span><span class="PUNC">=</span><span class="NAME">c.strokeWidth</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.hitContext.globalAlpha</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.hitContext.lineWidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.graphic</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.externalGraphic</span><span class="PUNC">)</span><span class="NAME">this.drawExternalGraphic</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b.graphicName</span><span class="PUNC">&&</span><span class="STRN">"circle"</span><span class="PUNC">!=</span><span class="NAME">b.graphicName</span><span class="PUNC">)</span><span class="NAME">this.drawNamedSymbol</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>559</span> </span><span class="NAME">this.getLocalXY</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.pointRadius</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.fill</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.arc</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.arc</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.stroke</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.arc</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>560</span> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.arc</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitContext.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"reset"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLineString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fill</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.drawLinearRing</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawLinearRing</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.fill</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.renderPath</span><span class="PUNC">(</span><span class="NAME">this.canvas</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"fill"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.renderPath</span><span class="PUNC">(</span><span class="NAME">this.hitContext</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"fill"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b.stroke</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.renderPath</span><span class="PUNC">(</span><span class="NAME">this.canvas</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>561</span> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"stroke"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.setHitContextStyle</span><span class="PUNC">(</span><span class="STRN">"stroke"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.renderPath</span><span class="PUNC">(</span><span class="NAME">this.hitContext</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"stroke"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"reset"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">renderPath</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.components</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">a.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getLocalXY</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.moveTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.getLocalXY</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.lineTo</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"fill"</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">a.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawPolygon</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.components</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">this.drawLinearRing</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>562</span> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">this.canvas.globalCompositeOperation</span><span class="PUNC">=</span><span class="STRN">"destination-out"</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.hitContext.globalCompositeOperation</span><span class="PUNC">=</span><span class="STRN">"destination-out"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.drawLinearRing</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">stroke</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">fillOpacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.globalCompositeOperation</span><span class="PUNC">=</span><span class="STRN">"source-over"</span><span class="PUNC">,</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.hitContext.globalCompositeOperation</span><span class="PUNC">=</span><span class="STRN">"source-over"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.drawLinearRing</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Util.applyDefaults</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fill</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getLocalXY</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"reset"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span> </span><span class="NAME">this.canvas.fillStyle</span><span class="PUNC">=</span><span class="NAME">b.fontColor</span><span class="PUNC">;</span><span class="NAME">this.canvas.globalAlpha</span><span class="PUNC">=</span><span class="NAME">b.fontOpacity</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">b.fontStyle</span><span class="PUNC">?</span><span class="NAME">b.fontStyle</span><span class="PUNC">:</span><span class="STRN">"normal"</span><span class="PUNC">,</span><span class="STRN">"normal"</span><span class="PUNC">,</span><span class="NAME">b.fontWeight</span><span class="PUNC">?</span><span class="NAME">b.fontWeight</span><span class="PUNC">:</span><span class="STRN">"normal"</span><span class="PUNC">,</span><span class="NAME">b.fontSize</span><span class="PUNC">?</span><span class="NAME">b.fontSize</span><span class="PUNC">:</span><span class="STRN">"1em"</span><span class="PUNC">,</span><span class="NAME">b.fontFamily</span><span class="PUNC">?</span><span class="NAME">b.fontFamily</span><span class="PUNC">:</span><span class="STRN">"sans-serif"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.label.split</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.canvas.fillText</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.canvas.font</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.canvas.textAlign</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_ALIGN</span><span class="PUNC">[</span><span class="NAME">b.labelAlign</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="STRN">"center"</span><span class="PUNC">;</span><span class="NAME">this.canvas.textBaseline</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_ALIGN</span><span class="PUNC">[</span><span class="NAME">b.labelAlign</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="STRN">"middle"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_FACTOR</span><span class="PUNC">[</span><span class="NAME">b.labelAlign</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>564</span> </span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.canvas.measureText</span><span class="PUNC">(</span><span class="STRN">"Mg"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">||</span><span class="NAME">this.canvas.measureText</span><span class="PUNC">(</span><span class="STRN">"xx"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.labelOutlineWidth</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.canvas.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.strokeStyle</span><span class="PUNC">=</span><span class="NAME">b.labelOutlineColor</span><span class="PUNC">,</span><span class="NAME">this.canvas.lineWidth</span><span class="PUNC">=</span><span class="NAME">b.labelOutlineWidth</span><span class="PUNC">,</span><span class="NAME">this.canvas.strokeText</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.canvas.fillText</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.canvas.mozDrawText</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.canvas.mozTextStyle</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_FACTOR</span><span class="PUNC">[</span><span class="NAME">b.labelAlign</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>565</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_FACTOR</span><span class="PUNC">[</span><span class="NAME">b.labelAlign</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.canvas.mozMeasureText</span><span class="PUNC">(</span><span class="STRN">"xx"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">this.canvas.mozMeasureText</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.canvas.translate</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.mozDrawText</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.canvas.translate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.setCanvasStyle</span><span class="PUNC">(</span><span class="STRN">"reset"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getLocalXY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getResolution</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.extent</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.featureDx</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">-</span><span class="NAME">c.left</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c.top</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.root.height</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.root.width</span><span class="PUNC">;</span><span class="NAME">this.canvas.clearRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>566</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.features</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.clearRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getFeatureIdFromEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="STRN">"none"</span><span class="PUNC">!==</span><span class="NAME">this.root.style.display</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.map.dragging</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.xy</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.hitContext.getImageData</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NUMB">256</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NUMB">256</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"OpenLayers_Feature_Vector_"</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">this.hitOverflow</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">eraseFeatures</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Util.isArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>567</span> </span><span class="NAME">this.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">redraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.locked</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.root.height</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.root.width</span><span class="PUNC">;</span><span class="NAME">this.canvas.clearRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hitDetection</span><span class="PUNC">&&</span><span class="NAME">this.hitContext.clearRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">&&</span><span class="NAME">this.map.baseLayer.wrapDateLine</span><span class="PUNC">&&</span><span class="NAME">this.map.getMaxExtent</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.features</span><span class="PUNC">)</span><span class="NAME">this.features.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.geometry</span><span class="PUNC">,</span><span class="NAME">this.calculateFeatureDx</span><span class="PUNC">(</span><span class="NAME">c.getBounds</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.features</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.drawGeometry</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b.id</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.label</span><span class="PUNC">&&</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>568</span> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.drawText</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">geometry.getCentroid</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Renderer.Canvas"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_ALIGN</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">:</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">:</span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">:</span><span class="STRN">"top"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="STRN">"bottom"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.Canvas.LABEL_FACTOR</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Renderer.Canvas.drawImageScaleFactor</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.Keyboard</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">KEY_EVENTS</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"keydown"</span><span class="PUNC">,</span><span class="STRN">"keyup"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">eventListener</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">observeElement</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Handler.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.eventListener</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Function.bindAsEventListener</span><span class="PUNC">(</span><span class="NAME">this.handleKeyEvent</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.deactivate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.eventListener</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Handler.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">activate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler.prototype.activate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>569</span> </span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.observeElement</span><span class="PUNC">=</span><span class="NAME">this.observeElement</span><span class="PUNC">||</span><span class="NAME">document</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.KEY_EVENTS.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">OpenLayers.Event.observe</span><span class="PUNC">(</span><span class="NAME">this.observeElement</span><span class="PUNC">,</span><span class="NAME">this.KEY_EVENTS</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.eventListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">deactivate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Handler.prototype.deactivate.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.KEY_EVENTS.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">OpenLayers.Event.stopObserving</span><span class="PUNC">(</span><span class="NAME">this.observeElement</span><span class="PUNC">,</span><span class="NAME">this.KEY_EVENTS</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.eventListener</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">handleKeyEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.checkModifiers</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>570</span> </span><span class="NAME">this.callback</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Handler.Keyboard"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.KeyboardDefaults</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">autoActivate</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">slideFactor</span><span class="PUNC">:</span><span class="NUMB">75</span><span class="PUNC">,</span><span class="NAME">observeElement</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.handler</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Handler.Keyboard</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">keydown</span><span class="PUNC">:</span><span class="NAME">this.defaultKeyPress</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">observeElement</span><span class="PUNC">:</span><span class="NAME">this.observeElement</span><span class="PUNC">||</span><span class="NAME">document</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">defaultKeyPress</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.keyCode</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.KEY_LEFT</span><span class="PUNC">:</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.slideFactor</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.KEY_RIGHT</span><span class="PUNC">:</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NAME">this.slideFactor</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.KEY_UP</span><span class="PUNC">:</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>571</span> </span><span class="PUNC">-</span><span class="NAME">this.slideFactor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">OpenLayers.Event.KEY_DOWN</span><span class="PUNC">:</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.slideFactor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">33</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">0.75</span><span class="PUNC">*</span><span class="NAME">b.h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">34</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.75</span><span class="PUNC">*</span><span class="NAME">b.h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">35</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="NUMB">0.75</span><span class="PUNC">*</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">36</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.map.getSize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.pan</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">0.75</span><span class="PUNC">*</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">43</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">61</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">187</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">107</span><span class="PUNC">:</span><span class="NAME">this.map.zoomIn</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">45</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">109</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">189</span><span class="PUNC">:</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">95</span><span class="PUNC">:</span><span class="NAME">this.map.zoomOut</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.KeyboardDefaults"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.LayerSwitcher</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Class</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Control</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">roundedCorner</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">roundedCornerColor</span><span class="PUNC">:</span><span class="STRN">"darkblue"</span><span class="PUNC">,</span><span class="NAME">layerStates</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">layersDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">baseLayersDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">baseLayers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">dataLbl</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">dataLayersDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">dataLayers</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">minimizeDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">maximizeDiv</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ascending</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">initialize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Control.prototype.initialize.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layerStates</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.roundedCorner</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Console.warn</span><span class="PUNC">(</span><span class="STRN">"roundedCorner option is deprecated"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">destroy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.clearLayersArray</span><span class="PUNC">(</span><span class="STRN">"base"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>572</span> </span><span class="NAME">this.clearLayersArray</span><span class="PUNC">(</span><span class="STRN">"data"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.events.un</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">buttonclick</span><span class="PUNC">:</span><span class="NAME">this.onButtonClick</span><span class="PUNC">,</span><span class="NAME">addlayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">changelayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">removelayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">changebaselayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.events.unregister</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.onButtonClick</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Control.prototype.destroy.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Control.prototype.setMap.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map.events.on</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">addlayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">changelayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">removelayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="NAME">changebaselayer</span><span class="PUNC">:</span><span class="NAME">this.redraw</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>573</span> </span><span class="NAME">scope</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.outsideViewport</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.events.attachToElement</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.events.register</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.onButtonClick</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.map.events.register</span><span class="PUNC">(</span><span class="STRN">"buttonclick"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">this.onButtonClick</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">draw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">OpenLayers.Control.prototype.draw.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.loadContents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.outsideViewport</span><span class="PUNC">||</span><span class="NAME">this.minimizeControl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.redraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.div</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">onButtonClick</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.buttonElement</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">this.minimizeDiv</span><span class="PUNC">?</span><span class="NAME">this.minimizeControl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">this.maximizeDiv</span><span class="PUNC">?</span><span class="NAME">this.maximizeControl</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a._layerSwitcher</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>574</span> </span><span class="NAME">this.id</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="STRN">"for"</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="STRN">"for"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.disabled</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="STRN">"radio"</span><span class="PUNC">==</span><span class="NAME">a.type</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.checked</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.map.setBaseLayer</span><span class="PUNC">(</span><span class="NAME">this.map.getLayer</span><span class="PUNC">(</span><span class="NAME">a._layer</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a.checked</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">a.checked</span><span class="PUNC">,</span><span class="NAME">this.updateMap</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clearLayersArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"LayersDiv"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">innerHTML</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"Layers"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">checkRedraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.layerStates.length</span><span class="PUNC">||</span><span class="NAME">this.map.layers.length</span><span class="PUNC">!=</span><span class="NAME">this.layerStates.length</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.layerStates.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.layerStates</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.layers</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.name</span><span class="PUNC">!=</span><span class="WHIT">
<span class='line'>575</span> </span><span class="NAME">e.name</span><span class="PUNC">||</span><span class="NAME">d.inRange</span><span class="PUNC">!=</span><span class="NAME">e.inRange</span><span class="PUNC">||</span><span class="NAME">d.id</span><span class="PUNC">!=</span><span class="NAME">e.id</span><span class="PUNC">||</span><span class="NAME">d.visibility</span><span class="PUNC">!=</span><span class="NAME">e.visibility</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">redraw</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.checkRedraw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.div</span><span class="PUNC">;</span><span class="NAME">this.clearLayersArray</span><span class="PUNC">(</span><span class="STRN">"base"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clearLayersArray</span><span class="PUNC">(</span><span class="STRN">"data"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.map.layers.length</span><span class="PUNC">;</span><span class="NAME">this.layerStates</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.map.layers</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.layerStates</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">name</span><span class="PUNC">:</span><span class="NAME">e.name</span><span class="PUNC">,</span><span class="NAME">visibility</span><span class="PUNC">:</span><span class="NAME">e.visibility</span><span class="PUNC">,</span><span class="NAME">inRange</span><span class="PUNC">:</span><span class="NAME">e.inRange</span><span class="PUNC">,</span><span class="NAME">id</span><span class="PUNC">:</span><span class="NAME">e.id</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.map.layers.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ascending</span><span class="PUNC">||</span><span class="NAME">f.reverse</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">f.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>576</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.isBaseLayer</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.displayInLayerSwitcher</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">==</span><span class="NAME">this.map.baseLayer</span><span class="PUNC">:</span><span class="NAME">e.getVisibility</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"input"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.id</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_input_"</span><span class="PUNC">+</span><span class="NAME">e.name</span><span class="PUNC">;</span><span class="NAME">i.name</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_baseLayers"</span><span class="PUNC">:</span><span class="NAME">e.name</span><span class="PUNC">;</span><span class="NAME">i.type</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="STRN">"radio"</span><span class="PUNC">:</span><span class="STRN">"checkbox"</span><span class="PUNC">;</span><span class="NAME">i.value</span><span class="PUNC">=</span><span class="NAME">e.name</span><span class="PUNC">;</span><span class="NAME">i.checked</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">i.defaultChecked</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">i.className</span><span class="PUNC">=</span><span class="STRN">"olButton"</span><span class="PUNC">;</span><span class="NAME">i._layer</span><span class="PUNC">=</span><span class="NAME">e.id</span><span class="PUNC">;</span><span class="NAME">i._layerSwitcher</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">e.inRange</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.disabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"label"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="STRN">"for"</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i.id</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="STRN">"labelSpan olButton"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h._layer</span><span class="PUNC">=</span><span class="NAME">e.id</span><span class="PUNC">;</span><span class="NAME">h._layerSwitcher</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>577</span> </span><span class="NAME">this.id</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">e.inRange</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h.style.color</span><span class="PUNC">=</span><span class="STRN">"gray"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.innerHTML</span><span class="PUNC">=</span><span class="NAME">e.name</span><span class="PUNC">;</span><span class="NAME">h.style.verticalAlign</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="STRN">"bottom"</span><span class="PUNC">:</span><span class="STRN">"baseline"</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"br"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">this.baseLayers</span><span class="PUNC">:</span><span class="NAME">this.dataLayers</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">layer</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">inputElem</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">labelSpan</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">this.baseLayersDiv</span><span class="PUNC">:</span><span class="NAME">this.dataLayersDiv</span><span class="PUNC">;</span><span class="NAME">e.appendChild</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.appendChild</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.appendChild</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.dataLbl.style.display</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">this.baseLbl.style.display</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.div</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.baseLayers.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.baseLayers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>578</span> </span><span class="NAME">c.inputElem.checked</span><span class="PUNC">&&</span><span class="NAME">this.map.setBaseLayer</span><span class="PUNC">(</span><span class="NAME">c.layer</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.dataLayers.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.dataLayers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.layer.setVisibility</span><span class="PUNC">(</span><span class="NAME">c.inputElem.checked</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">maximizeControl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.div.style.width</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.div.style.height</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.showControls</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">minimizeControl</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.div.style.width</span><span class="PUNC">=</span><span class="STRN">"0px"</span><span class="PUNC">;</span><span class="NAME">this.div.style.height</span><span class="PUNC">=</span><span class="STRN">"0px"</span><span class="PUNC">;</span><span class="NAME">this.showControls</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">OpenLayers.Event.stop</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">showControls</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.maximizeDiv.style.display</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">""</span><span class="PUNC">:</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>579</span> </span><span class="NAME">this.minimizeDiv.style.display</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">"none"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.layersDiv.style.display</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="STRN">"none"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadContents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.layersDiv</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.layersDiv.id</span><span class="PUNC">=</span><span class="NAME">this.id</span><span class="PUNC">+</span><span class="STRN">"_layersDiv"</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.layersDiv</span><span class="PUNC">,</span><span class="STRN">"layersDiv"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.baseLbl</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.baseLbl.innerHTML</span><span class="PUNC">=</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"Base Layer"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.baseLbl</span><span class="PUNC">,</span><span class="STRN">"baseLbl"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.baseLayersDiv</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.baseLayersDiv</span><span class="PUNC">,</span><span class="STRN">"baseLayersDiv"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>580</span> </span><span class="NAME">this.dataLbl</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dataLbl.innerHTML</span><span class="PUNC">=</span><span class="NAME">OpenLayers.i18n</span><span class="PUNC">(</span><span class="STRN">"Overlays"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.dataLbl</span><span class="PUNC">,</span><span class="STRN">"dataLbl"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.dataLayersDiv</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.dataLayersDiv</span><span class="PUNC">,</span><span class="STRN">"dataLayersDiv"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ascending</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.baseLbl</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.baseLayersDiv</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.dataLbl</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.dataLayersDiv</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.dataLbl</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.dataLayersDiv</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>581</span> </span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.baseLbl</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.layersDiv.appendChild</span><span class="PUNC">(</span><span class="NAME">this.baseLayersDiv</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">this.layersDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.roundedCorner</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">OpenLayers.Rico.Corner.round</span><span class="PUNC">(</span><span class="NAME">this.div</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">corners</span><span class="PUNC">:</span><span class="STRN">"tl bl"</span><span class="PUNC">,</span><span class="NAME">bgColor</span><span class="PUNC">:</span><span class="STRN">"transparent"</span><span class="PUNC">,</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">this.roundedCornerColor</span><span class="PUNC">,</span><span class="NAME">blend</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">OpenLayers.Rico.Corner.changeOpacity</span><span class="PUNC">(</span><span class="NAME">this.layersDiv</span><span class="PUNC">,</span><span class="NUMB">0.75</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getImageLocation</span><span class="PUNC">(</span><span class="STRN">"layer-switcher-maximize.png"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.maximizeDiv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createAlphaImageDiv</span><span class="PUNC">(</span><span class="STRN">"OpenLayers_Control_MaximizeDiv"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"absolute"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>582</span> </span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.maximizeDiv</span><span class="PUNC">,</span><span class="STRN">"maximizeDiv olButton"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.maximizeDiv.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">this.maximizeDiv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.getImageLocation</span><span class="PUNC">(</span><span class="STRN">"layer-switcher-minimize.png"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.minimizeDiv</span><span class="PUNC">=</span><span class="NAME">OpenLayers.Util.createAlphaImageDiv</span><span class="PUNC">(</span><span class="STRN">"OpenLayers_Control_MinimizeDiv"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"absolute"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">OpenLayers.Element.addClass</span><span class="PUNC">(</span><span class="NAME">this.minimizeDiv</span><span class="PUNC">,</span><span class="STRN">"minimizeDiv olButton"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.minimizeDiv.style.display</span><span class="PUNC">=</span><span class="STRN">"none"</span><span class="PUNC">;</span><span class="NAME">this.div.appendChild</span><span class="PUNC">(</span><span class="NAME">this.minimizeDiv</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">CLASS_NAME</span><span class="PUNC">:</span><span class="STRN">"OpenLayers.Control.LayerSwitcher"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>583</span> </span></pre></body></html>